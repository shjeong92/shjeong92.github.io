<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="ko"><generator uri="https://jekyllrb.com/" version="4.2.0">Jekyll</generator><link href="https://shjeong92.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://shjeong92.github.io/" rel="alternate" type="text/html" hreflang="ko" /><updated>2021-06-11T14:33:29+09:00</updated><id>https://shjeong92.github.io/feed.xml</id><title type="html">Hyukβ€™s devlog</title><subtitle>Your Site Description
</subtitle><author><name>Sanghyuk Jeong</name><email>shjeong920522@gmail.com</email></author><entry><title type="html">[ #12 ] ν΄λ¬μ¤ν„° λ³΄μ• - 3</title><link href="https://shjeong92.github.io/2021/06/10/Learning-Kubernetes-12.html" rel="alternate" type="text/html" title="[ #12 ] ν΄λ¬μ¤ν„° λ³΄μ• - 3" /><published>2021-06-10T00:00:00+09:00</published><updated>2021-06-10T00:00:00+09:00</updated><id>https://shjeong92.github.io/2021/06/10/Learning-Kubernetes-12</id><content type="html" xml:base="https://shjeong92.github.io/2021/06/10/Learning-Kubernetes-12.html">&lt;h2 id=&quot;1-tlsκ°€-μ κ³µν•λ”-μ΄μ λ“¤&quot;&gt;1. TLSκ°€ μ κ³µν•λ” μ΄μ λ“¤&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;κΈ°λ°€μ„±-μ•”νΈν™”&quot;&gt;κΈ°λ°€μ„± (μ•”νΈν™”)&lt;/h3&gt;
    &lt;p&gt;μ΄μ „ ν¬μ¤ν…μ—μ„ κ³µλ¶€ν–λ μ•”νΈν™”μ— ν•΄λ‹Ήν•λ” ν•­λ©μ…λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ„λ²„μ™€ μ£Όκ³  λ°›λ” λ°μ΄ν„°κ°€ μ¤λ‹ν•‘π‘€ λλ” κ²ƒμ„ λ°©μ§€ν•©λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;ν¨ν‚·μ΄ μ¤κ°€λ” κ²ƒμ„ ν›”μ³ λ³Ό μ μμ–΄λ„ μ•μ „ν•κ² μ•”νΈν™” λ ν¨ν‚·μ΄λΌ λ³µνΈν™” ν•  μ μ—†κΈ° λ–„λ¬Έμ—&lt;/p&gt;

    &lt;p&gt;λ°μ΄ν„°λ” ν›”μ³λ³Ό μ μ—†μµλ‹λ‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;λ°μ΄ν„°-λ¬΄κ²°μ„±&quot;&gt;λ°μ΄ν„° λ¬΄κ²°μ„±&lt;/h3&gt;
    &lt;p&gt;ν†µμ‹  λ„μ¤‘ λ°μ΄ν„°κ°€ μ  3μμ— μν•΄ μ•…μλ΅ λ³€κ²½λ  μΌμ΄ μ—†μµλ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;1λ² κΈ°λ°€μ„±κ³Ό κ°™μ€ μ„ μƒμ—μ„ λ³΄μ‹λ©΄ λ©λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ„λ΅μ λ€μΉ­ν‚¤λ¥Ό RSA μ•κ³ λ¦¬μ¦μ„ ν†µν•΄ μ•μ „ν•κ² κ³µμ ν• ν›„μ— μ•”νΈν™”ν•μ—¬ ν†µμ‹ ν•κΈ° λ•λ¬Έμ—&lt;/p&gt;

    &lt;p&gt;μ  3μκ°€ λ€μΉ­ν‚¤λ¥Ό μ•μ•„λ‚΄μ§€ μ•λ” ν• μ¤‘κ°„μ—μ„ μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό μ„μλ΅ μμ •ν•μ§€ λ»ν•κ² μ£ .&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;μ„λ²„-μΈμ¦&quot;&gt;μ„λ²„ μΈμ¦&lt;/h3&gt;
    &lt;p&gt;1, 2λ²μ€ μ§€λ‚ ν¬μ¤ν…μ— κ³µλ¶€ν–λ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ ν†µν•΄ κ°€λ¥ν•λ‹¤κ³  λ³΄μ—¬μ Έμ”.&lt;/p&gt;

    &lt;p&gt;κ·Όλ°  λ§μ•½ μ„μ μ•”νΈν™” λ°©μ‹μΌλ΅λ§ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ ν†µμ‹ μ„ ν•λ‹¤κ³  κ°€μ •ν•΄ λ΄…μ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ„λ²„μ™€ λ‚λ” μ•”νΈν™”λ¥Ό ν†µν•΄ ν†µμ‹ ν•κΈ° λ•λ¬Έμ— μ•„λ¬΄λ„ λ°μ΄ν„°λ¥Ό ν›”μ³λ³Ό μλ„ κ±΄λ“¤ μλ„ μ—†κ² μ§€!&lt;/p&gt;

    &lt;p&gt;μ—¬κΈ°κΉμ§€λ„ μΆ‹μµλ‹λ‹¤ κ·Όλ° λ§μ•½ μ„λ²„κ°€ μ‹ λΆ°ν•  μ μ—†λ” μ„λ²„λΌλ©΄ μ–κΈ°κ°€ λ‹¬λΌμ§€κ² μ§€μ”?&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

    &lt;p&gt;μ”μ¦ μ›Ή λΈλΌμ°μ €μ— μ„±κ°€μ‹  νμ—…μ΄ ν‘μ‹λλ” κ²½μ°&lt;/p&gt;

    &lt;p&gt;μ›Ήμ„ νƒμƒ‰ν•λ” λ„μ¤‘μ— λ¬΄λ£ κ²½ν’μ„ μ κ³µν•λ‹¤κ±°λ‚ κΈ°κΈ°μ— λ¬Έμ κ°€ μλ‹¤κ³  κ²½κ³ ν•λ” νμ—…μ΄λ‚ μ•λ¦Όμ΄ ν‘μ‹λλ” κ²½ν—μ€ ν•λ²μ”© ν•΄ λ³΄μ…¨μ„κ±°λΌκ³  μƒκ°ν•©λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ΄λ¬ν• μ ν•μ νμ—…μ€ λ€κ° μ‚¬κΈ°μ„± κ΄‘κ³ μ΄λ©°, μ‚¬μ©μλ¥Ό μ†μ—¬ μ‚¬κΈ°κΎΌμ—κ² κ°μΈ μ •λ³΄λ‚ λμ„ μ κ³µν•λ„λ΅ ν•κΈ° μ„ν•΄ λ§λ“¤μ–΄μ΅μµλ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ΄λ° μ„λ²„μ— μ•„λ¬΄λ¦¬ μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό λ³΄λ‚Έλ‹¤ ν•λ“¤ μ„λ²„κ°€ μ‚¬κΈ°κΎΌλ†μ μ„λ²„λΌλ©΄ μ •λ§ ν° λ¬Έμ μ§€μ”.&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

    &lt;p&gt;μ΄μ²λΌ, μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κ°„ ν†µμ‹ μ„ ν•  λ•λ”&lt;/p&gt;

    &lt;p&gt;μ„λ²„κ°€ μ‹ λΆ°ν•  μ μλ” μ„λ²„λΌλ” κ²ƒμ„ ν™•μΈν•λ” μ‘μ—…μ΄ ν•„μ”ν•©λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ΄λ΄ λ• μ‚¬μ©ν•λ” κ²ƒμ΄ λ°”λ΅ &lt;strong&gt;β€μΈμ¦μ„β€™&lt;/strong&gt; μ…λ‹λ‹¤!!!&lt;/p&gt;

    &lt;p&gt;μ΄λ²μ— κ³µλ¶€ν•  ν¬μ¤ν…μ—μ„ μ™ μΈμ¦μ„λΌλ” κ²ƒμ— λ€ν•΄ κ³µλ¶€ν•λ”μ§€ μ΄μ  μ•„μ‹κ² μ£ ?&lt;/p&gt;

    &lt;p&gt;μ κ·ΈλΌ μ΄μ  μ‹μ‘ν•΄ λ΄…μ‹λ‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;2-μΈμ¦μ„λ€-&quot;&gt;2. μΈμ¦μ„λ€ ?&lt;/h2&gt;

&lt;p&gt;μΈμ¦μ„λΌλ” κ²ƒμ΄ λ¬΄μ—‡μΌκΉμ”? μ΄λ¦„λ¶€ν„° μ΄λ―Έ κ°μ΄ μ¤μ§€ μ•λ‚μ”?&lt;/p&gt;

&lt;p&gt;λ°”λ΅ μ„μ—μ„ μ„λ²„κ°€ &lt;strong&gt;μ‹ λΆ°ν•  μ μλ” μ§„μ§ μ„λ²„ μ„μ„ ν™•μΈν•κΈ° μ„ν•΄ ν•„μ”ν• κ²ƒ&lt;/strong&gt;μ΄ λ°”λ΅  &lt;strong&gt;μΈμ¦μ„&lt;/strong&gt; μ…λ‹λ‹¤!&lt;/p&gt;

&lt;p&gt;μΈμ¦μ„μ—λ” λ‹¤μκ³Ό κ°™μ€ μ •λ³΄λ“¤μ„ ν¬ν•¨ν•κ³  μμµλ‹λ‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;μ„λΉ„μ¤ μ •λ³΄(μΈμ¦μ„λ¥Ό λ°κΈ‰ν• CA, μ„λΉ„μ¤μ λ„λ©”μΈ λ“±)&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;μ„λ²„ μΈ΅ κ³µκ°ν‚¤(κ³µκ°ν‚¤, κ³µκ°ν‚¤ μ•”νΈν™” λ°©λ²•)&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;μ§€λ¬Έ, λ””μ§€ν„Έ μ„λ… λ“±&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;μ—¬λ¬λ¶„μ΄ μ§€κΈ λ³΄κ³ κ³„μ‹  μ΄ λΈ”λ΅κ·Έλ„ μΈμ¦μ„λ¥Ό κ°€μ§€κ³  μλ‹µλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ£Όμ†μ°½μ κ°€μ¥ μ™Όμ½μ— π”’ λ³΄μ΄μ‹λ‚μ”?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
  &lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121352044-651ac600-c967-11eb-8060-8ae61c7b66db.png&quot; /&gt;
  &lt;br /&gt;&lt;/p&gt;

&lt;p&gt;μλ¬Όμ‡ κ°€ μ κ²¨μλ‹¤λ” κ±΄ μ΄μ „ ν¬μ¤ν…μ—μ„ κ³µλ¶€ν–λ HTTPS ν†µμ‹ μ΄λΌλ” λ»μ…λ‹λ‹¤ λ³΄μ•λμ–΄ μλ‹¤λ” λ§μ΄μ§€μ”&lt;/p&gt;

&lt;p&gt;μ  λΈ”λ΅κ·Έλ” GitHub Pagesλ¥Ό ν†µν•΄ λ§λ“¤μ–΄μ΅λ”λ°μ” κ°μΈ λ„λ©”μΈλ„ λ¬΄λ£λ΅ HTTPSλ¥Ό μ§€μ›ν•μ§€μ”.&lt;/p&gt;

&lt;p&gt;κ·ΈλΌ κΉƒν—™μ μΈμ¦μ„λ¥Ό ν•λ² λ“¤μ—¬λ‹¤ λ΄…μ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121352050-677d2000-c967-11eb-9a37-7c9525bdc5fe.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121352053-6815b680-c967-11eb-9393-6580c47f3634.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121352060-68ae4d00-c967-11eb-9fb3-fe167317905d.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;μ•μ„ λ§ν–λ“― μ„λ²„μ κ³µκ°ν‚¤, μ„λ…, μ§€λ¬Έ, λ°κΈ‰μ μ •λ³΄ λ“±μ΄ ν¬ν•¨λμ–΄ μλ”κ²ƒμ„ ν™•μΈν• μ μμµλ‹λ‹¤!&lt;/p&gt;

&lt;p&gt;μ΄κ²ƒλ“¤μ΄ μΈμ¦μ„μ—μ„ μ–΄λ–¤ μ—­ν• μ„ ν•λ”μ§€λ” μ°¨μ°¨ μ•μ•„λ΄…μ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ·Έλ¬κΈ° μ „μ— λ¨Όμ €,&lt;/p&gt;

&lt;p&gt;μ΄ μΈμ¦μ„λ” μ–΄λ””μ„ μ–΄λ–»κ² μƒμ„±ν• κΉμ”?&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;3-ca-certificate-authority&quot;&gt;3. CA (Certificate Authority)&lt;/h2&gt;

&lt;p&gt;CAλ” μΈμ¦μ„λ¥Ό λ°κΈ‰ν•΄μ£Όλ” κΈ°κ΄€μΌλ΅, Root CertificateλΌκ³  λ¶€λ¥΄κΈ°λ„ ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;CAλ” μ•„λ¬΄ κΈ°μ—…μ΄λ‚ ν•  μ μλ” κ² μ•„λ‹λΌ μ‹ λΆ°μ„±μ΄ μ—„κ²©ν•κ² κ³µμΈλ κΈ°μ—…λ“¤λ§ ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;TLS ν†µμ‹ μ„ ν•λ ¤λ©΄ μ΄ CAλ¥Ό ν†µν•΄μ„ μΈμ¦μ„λ¥Ό λ°κΈ‰λ°›μ•„μ•Ό ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ¨Όμ €, λ―Έλ¦¬ μ•μ•„λ‘ κ²ƒμ€ &lt;strong&gt;CAλ” μμ²΄μ μΌλ΅ κ³µκ°ν‚¤μ™€ λΉ„λ°€ν‚¤λ¥Ό κ°€μ§€κ³  μμµλ‹λ‹¤&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;CAμ λΉ„λ°€ν‚¤λ” μ λ€ λ„μ„¤ λμ–΄μ„  μ• λλ©°, μ΄κ²ƒμ΄ λ…Έμ¶λλ” λ°”λμ— &lt;strong&gt;&lt;em&gt;λ””μ§€λ…Ένƒ€&lt;/em&gt;&lt;/strong&gt; λΌλ” νμ‚¬κ°€ νμ‚°λ μ‚¬λ΅€λ„ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;hr /&gt;
&lt;h2 id=&quot;4-caμ—μ„-μΈμ¦μ„-λ°κΈ‰λ°›κΈ°&quot;&gt;4. CAμ—μ„ μΈμ¦μ„ λ°κΈ‰λ°›κΈ°&lt;/h2&gt;

&lt;p&gt;μ μ΄μ  CAλ΅λ¶€ν„° μΈμ¦μ„λ¥Ό λ°κΈ‰λ°›λ” λ°©λ²•μ„ μ•μ•„ λ΄…μ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ¨Όμ € κ·Έλ¦ΌμΌλ΅ μ „μ²΄μ μΈ λ©”μ»¤λ‹μ¦μ„ λ³΄κ³  λ„μ–΄ κ°‘μ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121363254-bdef5c00-c971-11eb-8c83-08197bec1eca.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;μ μ‹¤μ  μΈμ¦μ„λ¥Ό ν†µν•΄ ν™•μΈν•΄ λ΄…μ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ¨Όμ €, λ°κΈ‰ λ°›κ³ μ ν•λ” κΈ°κ΄€μ€ μμ‹ μ μ‚¬μ΄νΈ μ •λ³΄(λ„λ©”μΈ λ“±)κ³Ό κ³µκ°ν‚¤λ¥Ό CAμ—κ² μ μ¶ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ·Έλ¬λ©΄ CAλ” κ²€μ¦μ„ κ±ΈμΉ ν›„ λ°κΈ‰ λ°›κ³ μ ν•λ” μ„λ²„μ κ³µκ° ν‚¤λ¥Ό ν•΄μ‹(SHA-256 λ“±) ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ΄λ ‡κ² ν•΄μ‹ν• κ°’μ„  &lt;strong&gt;Finger Print(μ§€λ¬Έ)&lt;/strong&gt; μ΄λΌκ³  ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ΄μ  μ΄ μ§€λ¬Έμ„ CAμ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” ν•κ³ ,&lt;/p&gt;

&lt;p&gt;μΈμ¦μ„μ λ°κΈ‰μ μ„λ…μΌλ΅ λ“±λ΅ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121364644-efb4f280-c972-11eb-8025-142d5566ecdc.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;μ΄λ ‡κ² μ„λ…λ κ²ƒμ„ &lt;strong&gt;λ””μ§€ν„Έ μ„λ… (Digital Signing)&lt;/strong&gt; μ΄λΌκ³  ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ΄μ  CAλ” μ„λ²„μ—κ² μ΄ λ””μ§€ν„Έ μ„λ…, λ°κΈ‰μ μ •λ³΄ λ“±λ“±μ΄ λ“±λ΅λμ–΄ μλ” μΈμ¦μ„λ¥Ό λ°κΈ‰ν•΄ μ¤λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ΄λ¬ν• λ°©μ‹μ²λΌ,&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;μƒμ„ μΈμ¦ κΈ°κ΄€μ΄ ν•μ„ μΈμ¦μ„κ°€ ν¬ν•¨ν•κ³  μλ” κ³µκ°ν‚¤ (μΈμ¦μ„)λ¥Ό μƒμ„ κΈ°κ΄€μ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™”&lt;/strong&gt; ν•μ—¬&lt;/p&gt;

&lt;p&gt;μƒνΈ λ³΄μ¦ν•κ² λλ” κ²ƒμ„ &lt;strong&gt;μΈμ¦μ„ μ²΄μΈ(Certificate Chain)&lt;/strong&gt; μ΄λΌκ³  ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ‚΄κ°€ λ°κΈ‰λ°›λ” CA κΈ°κ΄€μ΄ Root CAκ°€ μ•„λ‹λΌλ©΄, μ΄ CA κΈ°κ΄€λ§μ € λ μƒμ„ CAμ—κ² μΈμ¦μ„λ¥Ό λ°κΈ‰λ°›μ€ κ²ƒμ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ³΄ν†µ 3λ‹¨κ³„μ— κ±Έμ³μ„ μΈμ¦μ„ μ²΄μΈμ΄ μΌμ–΄λ‚λ”λ°,&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121366057-20495c00-c974-11eb-9bc2-29d1cbb745d8.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121368826-4ff96380-c976-11eb-9d30-d1b7192b8c85.png&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Github.comμ μΈμ¦μ„λ” κ·Έ μƒμ„ μΈμ¦μ„μΈ
 Digicert SHA2 CA(Intermediate CA)μ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” λ κ²ƒμ΄λ©°,&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Digicert SHA2 CAμΈμ¦μ„λ” κ·Έ μƒμ„ μΈμ¦μ„μΈ
  Digicert High Assurance EV Root CA μ μΈμ¦κΈ°κ΄€μ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” λ κ²ƒμ…λ‹λ‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Digicert High Assurance EV Rootλ” μƒμ„ μΈμ¦κΈ°κ΄€μ΄ μ—†λ” Root CAμ΄κΈ° λ•λ¬Έμ— Self-Signed    λμ–΄ μμµλ‹λ‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Self-SIgned (μ¤μ¤λ΅ λ³΄μ¦)  μ΄λ€,&lt;/p&gt;

&lt;p&gt;μμ‹ μ μΈμ¦μ„λ¥Ό ν•΄μ‹ν• ν›„, CAκ°€ μ•„λ‹ μμ‹ μ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” ν•μ—¬ μ„λ…μΌλ΅ λ“±λ΅&lt;/p&gt;

&lt;p&gt;ν•λ” κ²ƒμ„ λ§ν•©λ‹λ‹¤&lt;/p&gt;

&lt;p&gt;μ΄κ² λ°”λ΅ μΈμ¦μ„ μ²΄μΈμ…λ‹λ‹¤.&lt;/p&gt;

&lt;h2 id=&quot;5-ssltls-μΈμ¦μ„μ-μ‘λ™μ›λ¦¬&quot;&gt;5. SSL(TLS) μΈμ¦μ„μ μ‘λ™μ›λ¦¬&lt;/h2&gt;

&lt;p&gt;CAμ—μ„ λ°κΈ‰λ°›μ€ μΈμ¦μ„λ¥Ό ν†µν•΄ μ„λ²„μ μ‹ λΆ°μ„±μ„ μΈμ¦ν•λ‹¤κ³  ν–μ—μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ·Όλ° ν΄λΌμ΄μ–ΈνΈλ” μ΄ μΈμ¦μ„κ°€ CAμ—μ„ λ°κΈ‰λ°›μ€ κ²ƒμΈμ§€, μ¤‘κ°„μ— λ„κ°€ μ΅°μ‘ν• κ²ƒμΈμ§€λ¥Ό μ–΄λ–»κ² ν™•μΈν• κΉμ”?&lt;/p&gt;

&lt;p&gt;λ¨Όμ € μ•μ•„ λ‘μ–΄μ•Όν•  κ²ƒμ€, &lt;strong&gt;ν΄λΌμ΄μ–ΈνΈλ“¤μ€ CA λ¦¬μ¤νΈλ“¤μ„ μ΄λ―Έ κ°€μ§€κ³  μμµλ‹λ‹¤.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;OSλ¥Ό μ„¤μΉν•  λ• PCμ— ν¬ν•¨λμ–΄μκ³  λΈλΌμ°μ €κ°€ μ΄λ¥Ό μ½μ–΄μµλ‹λ‹¤&lt;/p&gt;

&lt;p&gt;ν¬λ΅¬μκ²½μ° Setting -&amp;gt; Privacy and security -&amp;gt; Manage certificates λ¥Ό ν΄λ¦­ν•λ©΄&lt;/p&gt;

&lt;p&gt;μ„¤μΉλμ–΄μλ” CA λ¦¬μ¤νΈλ¥΄ λ³΄μ—¬μ¤λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ§μ ‘ ν™•μΈν•΄ λ΄…μ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;λ¨Όμ € μ°μΈ΅μƒλ‹¨μ λ•΅λ•΅μ΄ ν΄λ¦­ν›„ Settingsν΄λ¦­!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121470999-f3d82300-c9f9-11eb-8d8f-02d21716a4ae.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Privacy and security ν΄λ¦­ν›„ securitν΄λ¦­!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121471000-f3d82300-c9f9-11eb-8819-8ae4315e6a60.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Manage certificatesν΄λ¦­!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121471003-f470b980-c9f9-11eb-9e2d-575dd6190569.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;μ—„μ²­ λ§μ€ μΈμ¦μ„κ°€ λ³΄μ΄μ‹μ§€μ” γ…γ… κ·Έμ¤‘μ—λ” κΉƒν—™μΈμ¦μ„μ μƒμ„ μΈμ¦κΈ°κ΄€μΈ Digicertμ μΈμ¦μ„λ„ λ³΄μ΄λ”κµ°μ”&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121470986-efac0580-c9f9-11eb-8570-c56e67f76953.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;λ§¥μκ²½μ° Keychain Accessμ•±μ„ ν΄λ¦­ν•λ©΄ λ‘κ°™μ€ μ„μΉλ΅ μ΄λ™ν•  μ μμµλ‹λ‹¤.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--md&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121470998-f33f8c80-c9f9-11eb-976a-7cc0985209a8.png&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;μ μ΄μ  μ •λ§ μ–΄λ–»κ² μΈμ¦ν•λ”μ§€ μ•μ•„λ³΄μκµ¬μ”.&lt;/p&gt;

&lt;h3 id=&quot;a-μΈμ¦μ„-μ‹ μ²­ν•κΈ°&quot;&gt;a. μΈμ¦μ„ μ‹ μ²­ν•κΈ°&lt;/h3&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121473525-c7260a80-c9fd-11eb-91ab-f94d0fd781eb.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;μ„λ²„Aλ” μμ‹ μ΄ λ―Ώμ„ μ μλ” μ„λ²„μ„μ„ μΈμ¦ν•κΈ° μ„ν•΄ CAμ—μ„ μΈμ¦μ„λ¥Ό λ°κΈ‰λ°›μΌλ ¤ ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ·Έλ¬κΈ° μ„ν•΄μ„  μμ‹ μ μ‚¬μ΄νΈ μ •λ³΄μ™€ μ‚¬μ΄νΈμ κ³µκ°ν‚¤λ¥Ό CAμ— μ μ¶ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ·Έλ¬λ©΄ CAλ” κ²€μ¦μ„ κ±ΈμΉ ν›„ λ‹¤μκ³Ό κ°™μ€ κ³Όμ •μ„ κ±°μΉ©λ‹λ‹¤&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;μ μ¶λ°›μ€ μ„λ²„μ κ³µκ°ν‚¤λ¥Ό ν•΄μ‹ν•μ—¬ Finger Printλ¥Ό μƒμ„±ν•κ³ &lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Finger Printλ¥Ό CAμ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™”(Digital signing)&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;κ·Έλ¦¬κ³  μ„λ²„μ—κ² μ΄λ° μ •λ³΄λ“¤μ΄ λ“¤μ–΄ μλ” &lt;strong&gt;μΈμ¦μ„λ¥Ό λ°κΈ‰&lt;/strong&gt;ν•΄ μ¤λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ„λ²„λ” μ΄μ  μμ‹ μ΄ μ§„μ§ μ„λ²„μ„μ„ μΈμ¦ν•΄μ¤„ μΈμ¦μ„λ¥Ό κ°–κ³  μλ” κ²ƒμ…λ‹λ‹¤.&lt;/p&gt;

&lt;h3 id=&quot;b-ν΄λΌμ΄μ–ΈνΈμ-μΈμ¦λ-μ„λ²„-ν™•μΈλ°©λ²•&quot;&gt;b. ν΄λΌμ΄μ–ΈνΈμ μΈμ¦λ μ„λ²„ ν™•μΈλ°©λ²•&lt;/h3&gt;

&lt;p&gt;μ•„λ¬΄κ°μ”¨κ°€ μ„λ²„μ— μ ‘μ† ν•λ ¤κ³  ν•©λ‹λ‹¤. κ·Όλ° μ‹ λΆ°ν•  μ μλ” μ„λ²„μ— μ ‘μ†μ„ ν•΄μ•Όκ² μ§€μ”&lt;/p&gt;

&lt;p&gt;μ΄μ „ ν¬μ¤νΈμ—μ„ λ°°μ΄ TLS ν†µμ‹ μ„ ν†µν•΄ μ„λ²„λ” &lt;strong&gt;CAμ—μ„ λ°κΈ‰λ°›μ€ μΈμ¦μ„λ¥Ό μ•„λ¬΄κ°μ”¨μ—κ² λ„κΉλ‹λ‹¤&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;κ·Όλ° κ·Έ κ³Όμ •μ—μ„ &lt;em&gt;ν•΄μ»¤&lt;/em&gt; κ°€ μΈμ¦μ„λ¥Ό μμ‹ μ μΈμ¦μ„λ¥Ό λ°”κΏ”μΉκ±°λ‚ μΈμ¦μ„μ κ³µκ°ν‚¤λ¥Ό μμ‹ μ κ³µκ°ν‚¤λ΅ λ°”κΏ¨λ‹¤λ©΄&lt;/p&gt;

&lt;p&gt;μ΄ μΈμ¦μ„κ°€ λ¬΄κ²°μ„±μ€ μ–΄λ–»κ² ν™•μΈν• κΉμ”?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;μ•μ „μ— λ§ν–μ—μ§€μ”, &lt;strong&gt;ν΄λΌμ΄μ–ΈνΈλ” μ΄λ―Έ λ¨λ“  CAλ¦¬μ¤νΈμ κ³µκ°ν‚¤λ¥Ό κ°€μ§€κ³  μλ‹¤λ” κ²ƒμ„μ”&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;μ°μ„  μ•„λ¬΄κ°μ”¨ OSκ°€ κ°–κ³ μλ” CAλ¦¬μ¤νΈ(μΈμ¦λ°›μ€ Root CAλ“¤)μ— μλ” λ†μΈμ§€ ν™•μΈν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;image image--hf&quot; src=&quot;https://user-images.githubusercontent.com/75003424/121476495-b5defd00-ca01-11eb-8678-fd65dd5b395c.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;λ§μ•½μ— μ΄ λ¦¬μ¤νΈμ— μ—†λ‹¤λ©΄ λ°”λ΅ μ‹ λΆ°ν•  μ μ—†λ” μ‚¬μ΄νΈκ°€ λκ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ§μ•½ λ¦¬μ¤νΈμ— μλ”κ²½μ°μ—λ” ν•΄λ‹Ή &lt;strong&gt;CA κΈ°κ΄€μ κ³µκ°ν‚¤λ΅ μ„λ²„ μΈμ¦μ„μ μ„λ…(Digital Signing)μ„ λ³µνΈν™”&lt;/strong&gt; ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;(CAλ” μμ‹ μ λΉ„λ°€ν‚¤λ΅ μΈμ¦μ„λ¥Ό μ•”νΈν™”λ¥Ό ν•μ€μΌλ‹, κ³µκ°ν‚¤λ΅ λ³µνΈν™”κ°€ κ°€λ¥ν•©λ‹λ‹¤.)
λ””μ§€ν„Έ μ„λ…μ„ λ³µνΈν™” ν•λ©΄, μΈμ¦μ„ λ‚΄μ©μ„ ν•΄μ‹ν• κ°’μ΄ λ‚μ¤κ² μ£ ?&lt;/p&gt;

&lt;p&gt;λ§μ΄ ν–‡κ°λ¦΄ μ μμ§€λ§ CAμ κ²€μ¦ κ³Όμ •μ„ λμ§μ–΄ λ³΄λ©΄ μ΄ν•΄ν•κΈ° ν•κ²° μ‰¬μ°μ‹¤ κ²λ‹λ‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;CAμ κ²€μ¦κ³Όμ •μ—μ„ μ„λ²„μ κ³µκ°ν‚¤λ¥Ό ν•΄μ‰¬κ°’μΌλ΅ λ§λ“  FingerPrintκ°’μ΄ μμ—κµ¬μ”.&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;CAμ λΉ„κ³µκ°ν‚¤λ΅ κ·Έ FingerPrintκ°’μ„ μ•”νΈν™” ν•μ—¬μ„ Digital Signingμ„ λ§λ“¤μ—μµλ‹λ‹¤&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;-&amp;gt; κ·Έλ§μ€ μ¦‰μ¨ &lt;strong&gt;CAμ κ³µκ°ν‚¤λ΅ λ³µνΈν™”ν• Digital Signingκ°’μ€ FingerPrintμ΄λ©°!&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;-&amp;gt; &lt;strong&gt;ν•΄λ‹Ή μ„λ²„μ κ³µκ°ν‚¤λ¥Ό ν•΄μ‰¬ν™” ν• κ°’&lt;/strong&gt;κ³Ό μΌμΉν•΄μ•Ό ν•΄μ•Όλ§ ν•λ‹¤λ” λ§μ΄μ§€μ”!&lt;/p&gt;

    &lt;p&gt;μΌμΉν•μ§€ μ•λ”λ‹¤λ©΄ μΈμ¦μ„κ°€ μ„μ΅°λμ—λ‹¤λ” λ§κ³Όλ„ κ°™μµλ‹λ‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;c-μ•”νΈν™”-ν†µμ‹ ν•κΈ°&quot;&gt;c. μ•”νΈν™” ν†µμ‹ ν•κΈ°&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;μ„λ²„μ μΈμ¦μ„μ κ³µκ°ν‚¤λ¥Ό ν•΄μ‰¬ν• κ°’κ³Ό&lt;/strong&gt;,&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;OSμ— μ΅΄μ¬ν•λ” μΈμ¦μ„μ κ³µκ°ν‚¤λ΅ ν•΄λ‹Ή μ„λ²„ μΈμ¦μ„μDigital signing&lt;/strong&gt;μ„ λ³µνΈν™”ν• κ°’μ΄ μΌμΉ ν–λ‹¤λ©΄ λ―Ώμ„λ§ν• μ„λ²„μ΄κΈ°μ— ν†µμ‹ μ„ ν•λ©΄λκ² μ£ ?&lt;/p&gt;

&lt;p&gt;μ°λ¦¬λ” μ΄λ―Έ μ„λ²„μ κ³µκ°ν‚¤λ¥Ό μ•κ³ μμ§€μ”?&lt;/p&gt;

&lt;p&gt;ν†µμ‹ μ— μ‚¬μ©ν•  λ€μΉ­ν‚¤λ¥Ό μ„λ²„μ κ³µκ°ν‚¤λ΅ μ•”νΈν™”ν•μ—¬ μ„λ²„μ— λ³΄λƒ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ„λ²„λ” μμ‹ μ λΉ„κ³µκ°ν‚¤λ΅ μ΄λ¥Ό λ³µνΈν™”ν•μ—¬ μ΄μ  λ”μ± μ €λ ΄ν•λΉ„μ©μ λ€μΉ­ν‚¤ λ°©μ‹μΌλ΅ ν΄λΌμ΄μ–ΈνΈμ™€ ν†µμ‹ μ„ ν•  μκ°€ μκ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;hr /&gt;</content><author><name>Sanghyuk Jeong</name><email>shjeong920522@gmail.com</email></author><category term="RootCA" /><category term="HTTPS" /><category term="static" /><category term="SSL" /><category term="TLS" /><category term="μΏ λ²„λ„¤ν‹°μ¤" /><category term="λ³΄μ•" /><category term="Security" /><category term="λ€μΉ­ν‚¤" /><category term="λΉ„λ€μΉ­ν‚¤" /><category term="certificate" /><category term="μΈμ¦μ„" /><summary type="html">1. TLSκ°€ μ κ³µν•λ” μ΄μ λ“¤ κΈ°λ°€μ„± (μ•”νΈν™”) μ΄μ „ ν¬μ¤ν…μ—μ„ κ³µλ¶€ν–λ μ•”νΈν™”μ— ν•΄λ‹Ήν•λ” ν•­λ©μ…λ‹λ‹¤. μ„λ²„μ™€ μ£Όκ³  λ°›λ” λ°μ΄ν„°κ°€ μ¤λ‹ν•‘π‘€ λλ” κ²ƒμ„ λ°©μ§€ν•©λ‹λ‹¤. ν¨ν‚·μ΄ μ¤κ°€λ” κ²ƒμ„ ν›”μ³ λ³Ό μ μμ–΄λ„ μ•μ „ν•κ² μ•”νΈν™” λ ν¨ν‚·μ΄λΌ λ³µνΈν™” ν•  μ μ—†κΈ° λ–„λ¬Έμ— λ°μ΄ν„°λ” ν›”μ³λ³Ό μ μ—†μµλ‹λ‹¤. λ°μ΄ν„° λ¬΄κ²°μ„± ν†µμ‹  λ„μ¤‘ λ°μ΄ν„°κ°€ μ  3μμ— μν•΄ μ•…μλ΅ λ³€κ²½λ  μΌμ΄ μ—†μµλ‹λ‹¤. 1λ² κΈ°λ°€μ„±κ³Ό κ°™μ€ μ„ μƒμ—μ„ λ³΄μ‹λ©΄ λ©λ‹λ‹¤. μ„λ΅μ λ€μΉ­ν‚¤λ¥Ό RSA μ•κ³ λ¦¬μ¦μ„ ν†µν•΄ μ•μ „ν•κ² κ³µμ ν• ν›„μ— μ•”νΈν™”ν•μ—¬ ν†µμ‹ ν•κΈ° λ•λ¬Έμ— μ  3μκ°€ λ€μΉ­ν‚¤λ¥Ό μ•μ•„λ‚΄μ§€ μ•λ” ν• μ¤‘κ°„μ—μ„ μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό μ„μλ΅ μμ •ν•μ§€ λ»ν•κ² μ£ . μ„λ²„ μΈμ¦ 1, 2λ²μ€ μ§€λ‚ ν¬μ¤ν…μ— κ³µλ¶€ν–λ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ ν†µν•΄ κ°€λ¥ν•λ‹¤κ³  λ³΄μ—¬μ Έμ”. κ·Όλ° λ§μ•½ μ„μ μ•”νΈν™” λ°©μ‹μΌλ΅λ§ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ ν†µμ‹ μ„ ν•λ‹¤κ³  κ°€μ •ν•΄ λ΄…μ‹λ‹¤. μ„λ²„μ™€ λ‚λ” μ•”νΈν™”λ¥Ό ν†µν•΄ ν†µμ‹ ν•κΈ° λ•λ¬Έμ— μ•„λ¬΄λ„ λ°μ΄ν„°λ¥Ό ν›”μ³λ³Ό μλ„ κ±΄λ“¤ μλ„ μ—†κ² μ§€! μ—¬κΈ°κΉμ§€λ„ μΆ‹μµλ‹λ‹¤ κ·Όλ° λ§μ•½ μ„λ²„κ°€ μ‹ λΆ°ν•  μ μ—†λ” μ„λ²„λΌλ©΄ μ–κΈ°κ°€ λ‹¬λΌμ§€κ² μ§€μ”? μ”μ¦ μ›Ή λΈλΌμ°μ €μ— μ„±κ°€μ‹  νμ—…μ΄ ν‘μ‹λλ” κ²½μ° μ›Ήμ„ νƒμƒ‰ν•λ” λ„μ¤‘μ— λ¬΄λ£ κ²½ν’μ„ μ κ³µν•λ‹¤κ±°λ‚ κΈ°κΈ°μ— λ¬Έμ κ°€ μλ‹¤κ³  κ²½κ³ ν•λ” νμ—…μ΄λ‚ μ•λ¦Όμ΄ ν‘μ‹λλ” κ²½ν—μ€ ν•λ²μ”© ν•΄ λ³΄μ…¨μ„κ±°λΌκ³  μƒκ°ν•©λ‹λ‹¤. μ΄λ¬ν• μ ν•μ νμ—…μ€ λ€κ° μ‚¬κΈ°μ„± κ΄‘κ³ μ΄λ©°, μ‚¬μ©μλ¥Ό μ†μ—¬ μ‚¬κΈ°κΎΌμ—κ² κ°μΈ μ •λ³΄λ‚ λμ„ μ κ³µν•λ„λ΅ ν•κΈ° μ„ν•΄ λ§λ“¤μ–΄μ΅μµλ‹λ‹¤. μ΄λ° μ„λ²„μ— μ•„λ¬΄λ¦¬ μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό λ³΄λ‚Έλ‹¤ ν•λ“¤ μ„λ²„κ°€ μ‚¬κΈ°κΎΌλ†μ μ„λ²„λΌλ©΄ μ •λ§ ν° λ¬Έμ μ§€μ”. μ΄μ²λΌ, μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κ°„ ν†µμ‹ μ„ ν•  λ•λ” μ„λ²„κ°€ μ‹ λΆ°ν•  μ μλ” μ„λ²„λΌλ” κ²ƒμ„ ν™•μΈν•λ” μ‘μ—…μ΄ ν•„μ”ν•©λ‹λ‹¤. μ΄λ΄ λ• μ‚¬μ©ν•λ” κ²ƒμ΄ λ°”λ΅ β€μΈμ¦μ„β€™ μ…λ‹λ‹¤!!! μ΄λ²μ— κ³µλ¶€ν•  ν¬μ¤ν…μ—μ„ μ™ μΈμ¦μ„λΌλ” κ²ƒμ— λ€ν•΄ κ³µλ¶€ν•λ”μ§€ μ΄μ  μ•„μ‹κ² μ£ ? μ κ·ΈλΌ μ΄μ  μ‹μ‘ν•΄ λ΄…μ‹λ‹¤. 2. μΈμ¦μ„λ€ ? μΈμ¦μ„λΌλ” κ²ƒμ΄ λ¬΄μ—‡μΌκΉμ”? μ΄λ¦„λ¶€ν„° μ΄λ―Έ κ°μ΄ μ¤μ§€ μ•λ‚μ”? λ°”λ΅ μ„μ—μ„ μ„λ²„κ°€ μ‹ λΆ°ν•  μ μλ” μ§„μ§ μ„λ²„ μ„μ„ ν™•μΈν•κΈ° μ„ν•΄ ν•„μ”ν• κ²ƒμ΄ λ°”λ΅ μΈμ¦μ„ μ…λ‹λ‹¤! μΈμ¦μ„μ—λ” λ‹¤μκ³Ό κ°™μ€ μ •λ³΄λ“¤μ„ ν¬ν•¨ν•κ³  μμµλ‹λ‹¤. μ„λΉ„μ¤ μ •λ³΄(μΈμ¦μ„λ¥Ό λ°κΈ‰ν• CA, μ„λΉ„μ¤μ λ„λ©”μΈ λ“±) μ„λ²„ μΈ΅ κ³µκ°ν‚¤(κ³µκ°ν‚¤, κ³µκ°ν‚¤ μ•”νΈν™” λ°©λ²•) μ§€λ¬Έ, λ””μ§€ν„Έ μ„λ… λ“± μ—¬λ¬λ¶„μ΄ μ§€κΈ λ³΄κ³ κ³„μ‹  μ΄ λΈ”λ΅κ·Έλ„ μΈμ¦μ„λ¥Ό κ°€μ§€κ³  μλ‹µλ‹λ‹¤. μ£Όμ†μ°½μ κ°€μ¥ μ™Όμ½μ— π”’ λ³΄μ΄μ‹λ‚μ”? μλ¬Όμ‡ κ°€ μ κ²¨μλ‹¤λ” κ±΄ μ΄μ „ ν¬μ¤ν…μ—μ„ κ³µλ¶€ν–λ HTTPS ν†µμ‹ μ΄λΌλ” λ»μ…λ‹λ‹¤ λ³΄μ•λμ–΄ μλ‹¤λ” λ§μ΄μ§€μ” μ  λΈ”λ΅κ·Έλ” GitHub Pagesλ¥Ό ν†µν•΄ λ§λ“¤μ–΄μ΅λ”λ°μ” κ°μΈ λ„λ©”μΈλ„ λ¬΄λ£λ΅ HTTPSλ¥Ό μ§€μ›ν•μ§€μ”. κ·ΈλΌ κΉƒν—™μ μΈμ¦μ„λ¥Ό ν•λ² λ“¤μ—¬λ‹¤ λ΄…μ‹λ‹¤. μ•μ„ λ§ν–λ“― μ„λ²„μ κ³µκ°ν‚¤, μ„λ…, μ§€λ¬Έ, λ°κΈ‰μ μ •λ³΄ λ“±μ΄ ν¬ν•¨λμ–΄ μλ”κ²ƒμ„ ν™•μΈν• μ μμµλ‹λ‹¤! μ΄κ²ƒλ“¤μ΄ μΈμ¦μ„μ—μ„ μ–΄λ–¤ μ—­ν• μ„ ν•λ”μ§€λ” μ°¨μ°¨ μ•μ•„λ΄…μ‹λ‹¤. κ·Έλ¬κΈ° μ „μ— λ¨Όμ €, μ΄ μΈμ¦μ„λ” μ–΄λ””μ„ μ–΄λ–»κ² μƒμ„±ν• κΉμ”? 3. CA (Certificate Authority) CAλ” μΈμ¦μ„λ¥Ό λ°κΈ‰ν•΄μ£Όλ” κΈ°κ΄€μΌλ΅, Root CertificateλΌκ³  λ¶€λ¥΄κΈ°λ„ ν•©λ‹λ‹¤. CAλ” μ•„λ¬΄ κΈ°μ—…μ΄λ‚ ν•  μ μλ” κ² μ•„λ‹λΌ μ‹ λΆ°μ„±μ΄ μ—„κ²©ν•κ² κ³µμΈλ κΈ°μ—…λ“¤λ§ ν•  μ μμµλ‹λ‹¤. TLS ν†µμ‹ μ„ ν•λ ¤λ©΄ μ΄ CAλ¥Ό ν†µν•΄μ„ μΈμ¦μ„λ¥Ό λ°κΈ‰λ°›μ•„μ•Ό ν•©λ‹λ‹¤. λ¨Όμ €, λ―Έλ¦¬ μ•μ•„λ‘ κ²ƒμ€ CAλ” μμ²΄μ μΌλ΅ κ³µκ°ν‚¤μ™€ λΉ„λ°€ν‚¤λ¥Ό κ°€μ§€κ³  μμµλ‹λ‹¤. CAμ λΉ„λ°€ν‚¤λ” μ λ€ λ„μ„¤ λμ–΄μ„  μ• λλ©°, μ΄κ²ƒμ΄ λ…Έμ¶λλ” λ°”λμ— λ””μ§€λ…Ένƒ€ λΌλ” νμ‚¬κ°€ νμ‚°λ μ‚¬λ΅€λ„ μμµλ‹λ‹¤. 4. CAμ—μ„ μΈμ¦μ„ λ°κΈ‰λ°›κΈ° μ μ΄μ  CAλ΅λ¶€ν„° μΈμ¦μ„λ¥Ό λ°κΈ‰λ°›λ” λ°©λ²•μ„ μ•μ•„ λ΄…μ‹λ‹¤. λ¨Όμ € κ·Έλ¦ΌμΌλ΅ μ „μ²΄μ μΈ λ©”μ»¤λ‹μ¦μ„ λ³΄κ³  λ„μ–΄ κ°‘μ‹λ‹¤. μ μ‹¤μ  μΈμ¦μ„λ¥Ό ν†µν•΄ ν™•μΈν•΄ λ΄…μ‹λ‹¤. λ¨Όμ €, λ°κΈ‰ λ°›κ³ μ ν•λ” κΈ°κ΄€μ€ μμ‹ μ μ‚¬μ΄νΈ μ •λ³΄(λ„λ©”μΈ λ“±)κ³Ό κ³µκ°ν‚¤λ¥Ό CAμ—κ² μ μ¶ν•©λ‹λ‹¤. κ·Έλ¬λ©΄ CAλ” κ²€μ¦μ„ κ±ΈμΉ ν›„ λ°κΈ‰ λ°›κ³ μ ν•λ” μ„λ²„μ κ³µκ° ν‚¤λ¥Ό ν•΄μ‹(SHA-256 λ“±) ν•©λ‹λ‹¤. μ΄λ ‡κ² ν•΄μ‹ν• κ°’μ„ Finger Print(μ§€λ¬Έ) μ΄λΌκ³  ν•©λ‹λ‹¤. μ΄μ  μ΄ μ§€λ¬Έμ„ CAμ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” ν•κ³ , μΈμ¦μ„μ λ°κΈ‰μ μ„λ…μΌλ΅ λ“±λ΅ν•©λ‹λ‹¤. μ΄λ ‡κ² μ„λ…λ κ²ƒμ„ λ””μ§€ν„Έ μ„λ… (Digital Signing) μ΄λΌκ³  ν•©λ‹λ‹¤. μ΄μ  CAλ” μ„λ²„μ—κ² μ΄ λ””μ§€ν„Έ μ„λ…, λ°κΈ‰μ μ •λ³΄ λ“±λ“±μ΄ λ“±λ΅λμ–΄ μλ” μΈμ¦μ„λ¥Ό λ°κΈ‰ν•΄ μ¤λ‹λ‹¤. μ΄λ¬ν• λ°©μ‹μ²λΌ, μƒμ„ μΈμ¦ κΈ°κ΄€μ΄ ν•μ„ μΈμ¦μ„κ°€ ν¬ν•¨ν•κ³  μλ” κ³µκ°ν‚¤ (μΈμ¦μ„)λ¥Ό μƒμ„ κΈ°κ΄€μ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” ν•μ—¬ μƒνΈ λ³΄μ¦ν•κ² λλ” κ²ƒμ„ μΈμ¦μ„ μ²΄μΈ(Certificate Chain) μ΄λΌκ³  ν•©λ‹λ‹¤. λ‚΄κ°€ λ°κΈ‰λ°›λ” CA κΈ°κ΄€μ΄ Root CAκ°€ μ•„λ‹λΌλ©΄, μ΄ CA κΈ°κ΄€λ§μ € λ μƒμ„ CAμ—κ² μΈμ¦μ„λ¥Ό λ°κΈ‰λ°›μ€ κ²ƒμ…λ‹λ‹¤. λ³΄ν†µ 3λ‹¨κ³„μ— κ±Έμ³μ„ μΈμ¦μ„ μ²΄μΈμ΄ μΌμ–΄λ‚λ”λ°, Github.comμ μΈμ¦μ„λ” κ·Έ μƒμ„ μΈμ¦μ„μΈ Digicert SHA2 CA(Intermediate CA)μ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” λ κ²ƒμ΄λ©°, Digicert SHA2 CAμΈμ¦μ„λ” κ·Έ μƒμ„ μΈμ¦μ„μΈ Digicert High Assurance EV Root CA μ μΈμ¦κΈ°κ΄€μ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” λ κ²ƒμ…λ‹λ‹¤. Digicert High Assurance EV Rootλ” μƒμ„ μΈμ¦κΈ°κ΄€μ΄ μ—†λ” Root CAμ΄κΈ° λ•λ¬Έμ— Self-Signed λμ–΄ μμµλ‹λ‹¤. Self-SIgned (μ¤μ¤λ΅ λ³΄μ¦) μ΄λ€, μμ‹ μ μΈμ¦μ„λ¥Ό ν•΄μ‹ν• ν›„, CAκ°€ μ•„λ‹ μμ‹ μ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” ν•μ—¬ μ„λ…μΌλ΅ λ“±λ΅ ν•λ” κ²ƒμ„ λ§ν•©λ‹λ‹¤ μ΄κ² λ°”λ΅ μΈμ¦μ„ μ²΄μΈμ…λ‹λ‹¤. 5. SSL(TLS) μΈμ¦μ„μ μ‘λ™μ›λ¦¬ CAμ—μ„ λ°κΈ‰λ°›μ€ μΈμ¦μ„λ¥Ό ν†µν•΄ μ„λ²„μ μ‹ λΆ°μ„±μ„ μΈμ¦ν•λ‹¤κ³  ν–μ—μµλ‹λ‹¤. κ·Όλ° ν΄λΌμ΄μ–ΈνΈλ” μ΄ μΈμ¦μ„κ°€ CAμ—μ„ λ°κΈ‰λ°›μ€ κ²ƒμΈμ§€, μ¤‘κ°„μ— λ„κ°€ μ΅°μ‘ν• κ²ƒμΈμ§€λ¥Ό μ–΄λ–»κ² ν™•μΈν• κΉμ”? λ¨Όμ € μ•μ•„ λ‘μ–΄μ•Όν•  κ²ƒμ€, ν΄λΌμ΄μ–ΈνΈλ“¤μ€ CA λ¦¬μ¤νΈλ“¤μ„ μ΄λ―Έ κ°€μ§€κ³  μμµλ‹λ‹¤. OSλ¥Ό μ„¤μΉν•  λ• PCμ— ν¬ν•¨λμ–΄μκ³  λΈλΌμ°μ €κ°€ μ΄λ¥Ό μ½μ–΄μµλ‹λ‹¤ ν¬λ΅¬μκ²½μ° Setting -&amp;gt; Privacy and security -&amp;gt; Manage certificates λ¥Ό ν΄λ¦­ν•λ©΄ μ„¤μΉλμ–΄μλ” CA λ¦¬μ¤νΈλ¥΄ λ³΄μ—¬μ¤λ‹λ‹¤. μ§μ ‘ ν™•μΈν•΄ λ΄…μ‹λ‹¤. λ¨Όμ € μ°μΈ΅μƒλ‹¨μ λ•΅λ•΅μ΄ ν΄λ¦­ν›„ Settingsν΄λ¦­! Privacy and security ν΄λ¦­ν›„ securitν΄λ¦­! Manage certificatesν΄λ¦­! μ—„μ²­ λ§μ€ μΈμ¦μ„κ°€ λ³΄μ΄μ‹μ§€μ” γ…γ… κ·Έμ¤‘μ—λ” κΉƒν—™μΈμ¦μ„μ μƒμ„ μΈμ¦κΈ°κ΄€μΈ Digicertμ μΈμ¦μ„λ„ λ³΄μ΄λ”κµ°μ” λ§¥μκ²½μ° Keychain Accessμ•±μ„ ν΄λ¦­ν•λ©΄ λ‘κ°™μ€ μ„μΉλ΅ μ΄λ™ν•  μ μμµλ‹λ‹¤. μ μ΄μ  μ •λ§ μ–΄λ–»κ² μΈμ¦ν•λ”μ§€ μ•μ•„λ³΄μκµ¬μ”. a. μΈμ¦μ„ μ‹ μ²­ν•κΈ° μ„λ²„Aλ” μμ‹ μ΄ λ―Ώμ„ μ μλ” μ„λ²„μ„μ„ μΈμ¦ν•κΈ° μ„ν•΄ CAμ—μ„ μΈμ¦μ„λ¥Ό λ°κΈ‰λ°›μΌλ ¤ ν•©λ‹λ‹¤. κ·Έλ¬κΈ° μ„ν•΄μ„  μμ‹ μ μ‚¬μ΄νΈ μ •λ³΄μ™€ μ‚¬μ΄νΈμ κ³µκ°ν‚¤λ¥Ό CAμ— μ μ¶ν•©λ‹λ‹¤. κ·Έλ¬λ©΄ CAλ” κ²€μ¦μ„ κ±ΈμΉ ν›„ λ‹¤μκ³Ό κ°™μ€ κ³Όμ •μ„ κ±°μΉ©λ‹λ‹¤ μ μ¶λ°›μ€ μ„λ²„μ κ³µκ°ν‚¤λ¥Ό ν•΄μ‹ν•μ—¬ Finger Printλ¥Ό μƒμ„±ν•κ³  Finger Printλ¥Ό CAμ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™”(Digital signing) κ·Έλ¦¬κ³  μ„λ²„μ—κ² μ΄λ° μ •λ³΄λ“¤μ΄ λ“¤μ–΄ μλ” μΈμ¦μ„λ¥Ό λ°κΈ‰ν•΄ μ¤λ‹λ‹¤. μ„λ²„λ” μ΄μ  μμ‹ μ΄ μ§„μ§ μ„λ²„μ„μ„ μΈμ¦ν•΄μ¤„ μΈμ¦μ„λ¥Ό κ°–κ³  μλ” κ²ƒμ…λ‹λ‹¤. b. ν΄λΌμ΄μ–ΈνΈμ μΈμ¦λ μ„λ²„ ν™•μΈλ°©λ²• μ•„λ¬΄κ°μ”¨κ°€ μ„λ²„μ— μ ‘μ† ν•λ ¤κ³  ν•©λ‹λ‹¤. κ·Όλ° μ‹ λΆ°ν•  μ μλ” μ„λ²„μ— μ ‘μ†μ„ ν•΄μ•Όκ² μ§€μ” μ΄μ „ ν¬μ¤νΈμ—μ„ λ°°μ΄ TLS ν†µμ‹ μ„ ν†µν•΄ μ„λ²„λ” CAμ—μ„ λ°κΈ‰λ°›μ€ μΈμ¦μ„λ¥Ό μ•„λ¬΄κ°μ”¨μ—κ² λ„κΉλ‹λ‹¤ κ·Όλ° κ·Έ κ³Όμ •μ—μ„ ν•΄μ»¤ κ°€ μΈμ¦μ„λ¥Ό μμ‹ μ μΈμ¦μ„λ¥Ό λ°”κΏ”μΉκ±°λ‚ μΈμ¦μ„μ κ³µκ°ν‚¤λ¥Ό μμ‹ μ κ³µκ°ν‚¤λ΅ λ°”κΏ¨λ‹¤λ©΄ μ΄ μΈμ¦μ„κ°€ λ¬΄κ²°μ„±μ€ μ–΄λ–»κ² ν™•μΈν• κΉμ”? μ•μ „μ— λ§ν–μ—μ§€μ”, ν΄λΌμ΄μ–ΈνΈλ” μ΄λ―Έ λ¨λ“  CAλ¦¬μ¤νΈμ κ³µκ°ν‚¤λ¥Ό κ°€μ§€κ³  μλ‹¤λ” κ²ƒμ„μ” μ°μ„  μ•„λ¬΄κ°μ”¨ OSκ°€ κ°–κ³ μλ” CAλ¦¬μ¤νΈ(μΈμ¦λ°›μ€ Root CAλ“¤)μ— μλ” λ†μΈμ§€ ν™•μΈν•©λ‹λ‹¤. λ§μ•½μ— μ΄ λ¦¬μ¤νΈμ— μ—†λ‹¤λ©΄ λ°”λ΅ μ‹ λΆ°ν•  μ μ—†λ” μ‚¬μ΄νΈκ°€ λκ² μµλ‹λ‹¤. λ§μ•½ λ¦¬μ¤νΈμ— μλ”κ²½μ°μ—λ” ν•΄λ‹Ή CA κΈ°κ΄€μ κ³µκ°ν‚¤λ΅ μ„λ²„ μΈμ¦μ„μ μ„λ…(Digital Signing)μ„ λ³µνΈν™” ν•©λ‹λ‹¤. (CAλ” μμ‹ μ λΉ„λ°€ν‚¤λ΅ μΈμ¦μ„λ¥Ό μ•”νΈν™”λ¥Ό ν•μ€μΌλ‹, κ³µκ°ν‚¤λ΅ λ³µνΈν™”κ°€ κ°€λ¥ν•©λ‹λ‹¤.) λ””μ§€ν„Έ μ„λ…μ„ λ³µνΈν™” ν•λ©΄, μΈμ¦μ„ λ‚΄μ©μ„ ν•΄μ‹ν• κ°’μ΄ λ‚μ¤κ² μ£ ? λ§μ΄ ν–‡κ°λ¦΄ μ μμ§€λ§ CAμ κ²€μ¦ κ³Όμ •μ„ λμ§μ–΄ λ³΄λ©΄ μ΄ν•΄ν•κΈ° ν•κ²° μ‰¬μ°μ‹¤ κ²λ‹λ‹¤. CAμ κ²€μ¦κ³Όμ •μ—μ„ μ„λ²„μ κ³µκ°ν‚¤λ¥Ό ν•΄μ‰¬κ°’μΌλ΅ λ§λ“  FingerPrintκ°’μ΄ μμ—κµ¬μ”. CAμ λΉ„κ³µκ°ν‚¤λ΅ κ·Έ FingerPrintκ°’μ„ μ•”νΈν™” ν•μ—¬μ„ Digital Signingμ„ λ§λ“¤μ—μµλ‹λ‹¤ -&amp;gt; κ·Έλ§μ€ μ¦‰μ¨ CAμ κ³µκ°ν‚¤λ΅ λ³µνΈν™”ν• Digital Signingκ°’μ€ FingerPrintμ΄λ©°! -&amp;gt; ν•΄λ‹Ή μ„λ²„μ κ³µκ°ν‚¤λ¥Ό ν•΄μ‰¬ν™” ν• κ°’κ³Ό μΌμΉν•΄μ•Ό ν•΄μ•Όλ§ ν•λ‹¤λ” λ§μ΄μ§€μ”! μΌμΉν•μ§€ μ•λ”λ‹¤λ©΄ μΈμ¦μ„κ°€ μ„μ΅°λμ—λ‹¤λ” λ§κ³Όλ„ κ°™μµλ‹λ‹¤. c. μ•”νΈν™” ν†µμ‹ ν•κΈ° μ„λ²„μ μΈμ¦μ„μ κ³µκ°ν‚¤λ¥Ό ν•΄μ‰¬ν• κ°’κ³Ό, OSμ— μ΅΄μ¬ν•λ” μΈμ¦μ„μ κ³µκ°ν‚¤λ΅ ν•΄λ‹Ή μ„λ²„ μΈμ¦μ„μDigital signingμ„ λ³µνΈν™”ν• κ°’μ΄ μΌμΉ ν–λ‹¤λ©΄ λ―Ώμ„λ§ν• μ„λ²„μ΄κΈ°μ— ν†µμ‹ μ„ ν•λ©΄λκ² μ£ ? μ°λ¦¬λ” μ΄λ―Έ μ„λ²„μ κ³µκ°ν‚¤λ¥Ό μ•κ³ μμ§€μ”? ν†µμ‹ μ— μ‚¬μ©ν•  λ€μΉ­ν‚¤λ¥Ό μ„λ²„μ κ³µκ°ν‚¤λ΅ μ•”νΈν™”ν•μ—¬ μ„λ²„μ— λ³΄λƒ…λ‹λ‹¤. μ„λ²„λ” μμ‹ μ λΉ„κ³µκ°ν‚¤λ΅ μ΄λ¥Ό λ³µνΈν™”ν•μ—¬ μ΄μ  λ”μ± μ €λ ΄ν•λΉ„μ©μ λ€μΉ­ν‚¤ λ°©μ‹μΌλ΅ ν΄λΌμ΄μ–ΈνΈμ™€ ν†µμ‹ μ„ ν•  μκ°€ μκ² μµλ‹λ‹¤.</summary></entry><entry><title type="html">[ #11 ] ν΄λ¬μ¤ν„° λ³΄μ• - 2</title><link href="https://shjeong92.github.io/2021/06/09/Learning-Kubernetes-11.html" rel="alternate" type="text/html" title="[ #11 ] ν΄λ¬μ¤ν„° λ³΄μ• - 2" /><published>2021-06-09T00:00:00+09:00</published><updated>2021-06-09T00:00:00+09:00</updated><id>https://shjeong92.github.io/2021/06/09/Learning-Kubernetes-11</id><content type="html" xml:base="https://shjeong92.github.io/2021/06/09/Learning-Kubernetes-11.html">&lt;h2 id=&quot;1-tls--ssl--https-λ€&quot;&gt;1. TLS / SSL / HTTPS λ€?&lt;/h2&gt;

&lt;h3 id=&quot;sslsecure-socket-layer&quot;&gt;&lt;strong&gt;SSL(Secure Socket Layer)&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;SSLμ€ μ›Ήμ‚¬μ΄νΈμ™€ λΈλΌμ°μ €(νΉμ€, λ‘ μ„λ²„) μ‚¬μ΄μ— μ „μ†΅λ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•μ—¬ μΈν„°λ„· μ—°κ²° λ³΄μ•μ„ μ μ§€ν•λ” ν‘μ¤€ κΈ°μ μ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ΄λ” ν•΄μ»¤κ°€ κ°μΈ μ •λ³΄ λ° κΈμµ μ •λ³΄λ¥Ό ν¬ν•¨ν• μ „μ†΅λλ” λ¨λ“  μ •λ³΄λ¥Ό μ—΄λν•κ±°λ‚ ν›”μΉλ” κ²ƒμ„ λ°©μ§€ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ‰½κ² λ§ν•μλ©΄, &lt;strong&gt;λ„¤νΈμ›ν¬ ν†µμ‹ μ„ ν•  λ• λ³΄μ•μ„ μ κ³µν•κΈ° μ„ν•΄ μ„¤κ³„λ μ•”νΈ κ·μ•½&lt;/strong&gt;μ΄λ©°, TCP/IP λ„¤νΈμ›ν¬λ¥Ό μ‚¬μ©ν•λ” ν†µμ‹ μ— μ μ©λ©λ‹λ‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;SSLμ κµ¬μ΅°&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/75003424/121298850-7ea01b80-c92f-11eb-8f4c-2f01adc53c1f.jpeg&quot; alt=&quot;ssl-arch&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;tlstransport-layer-socket&quot;&gt;TLS(Transport Layer Socket)&lt;/h3&gt;

&lt;p&gt;μ΄λ¦„μ€ SSL κ³Ό λ‹¤λ¥΄μ§€λ§ μ‚¬μ‹¤ λ‘μ€ κ°™λ‹¤κ³  ν•©λ‹λ‹¤. TLS1.0μ€ SSL 3.0μ„ κ·Έλ€λ΅ κ³„μΉν• κ²ƒμ΄λΌκ³  ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;h3 id=&quot;http--https&quot;&gt;HTTP / HTTPS&lt;/h3&gt;

&lt;h4 id=&quot;--http&quot;&gt;- HTTP&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;HTTP λ” λ‹¤μκ³Ό κ°™μ΄ μ•”νΈν™” λμ§€ μ•μ€ ν‰λ¬ΈμΌλ΅ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•©λ‹λ‹¤&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/75003424/121309439-24a65280-c93d-11eb-8bb3-c1d429e260e2.png&quot; alt=&quot;http&quot; /&gt;&lt;/p&gt;

&lt;p&gt;λ”°λΌμ„ λ„κµ°κ°€ ν¨ν‚·μ„ ν›”μ³λ³΄λ” μ¤λ‹ν•‘(Sniffing) κ³µκ²©μ— μ·¨μ•½ν•μ§€μ”.&lt;/p&gt;

&lt;p&gt;HTTP ν†µμ‹ μ—μ„  ν•΄μ»¤κ°€ Wire Sharkλ¥Ό ν†µν•΄ ν¨ν‚·μ„ ν™•μΈν•λ©΄ λ‚΄ λΉ„λ°€λ²νΈκ°€ κ·Έλ€λ΅ μ„λ²„λ΅ μ „μ†΅λλ” κ²ƒμ„ λ³Ό μ μλ”κ²ƒμ΄μ£ &lt;/p&gt;

&lt;h4 id=&quot;--https&quot;&gt;- HTTPS&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;HTTPS λ” λ‹¤μκ³Ό κ°™μ΄ μ•”νΈν™” λ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•©λ‹λ‹¤&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/75003424/121309445-27a14300-c93d-11eb-8c69-f6f5cc6a9e6f.png&quot; alt=&quot;https&quot; /&gt;&lt;/p&gt;

&lt;p&gt;μ΄λ• μ‚¬μ©ν•λ” λ³΄μ• μΈμ¦(μ•”νΈν™” + μ„λ²„μΈμ¦ λ“±)μ΄ TLS(SSL)μ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ¦‰, HTTPSλ” TLS ν”„λ΅ν† μ½ μ„μ—μ„ λμ•„κ°€λ” HTTP ν”„λ΅ν† μ½μ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ°„λ‹¨ν•κ² λ§ν•΄μ„ ν†µμ‹ ν•  λ–„μ— λ°μ΄ν„°λ¥Ό β€μ•”νΈν™”β€™ ν•λ” λ³΄μ•μ΄ ν•„μ”ν•λ‹¤,&lt;/p&gt;

&lt;p&gt;HTTP ν†µμ‹ μ—μ„ λ³΄μ•μ„ μ¶”κ°€ν• κ²ƒμ΄ HTTPSμ΄λ©°&lt;/p&gt;

&lt;p&gt;μ΄λ• λ³΄μ•μ€ TLSλ¥Ό ν†µν•΄ ν•λ‹¤ μ •λ„λ΅ μ•κ³  λ„μ–΄κ°€λ©΄ λκ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;2-μ•”νΈν™”&quot;&gt;2. μ•”νΈν™”&lt;/h2&gt;

&lt;p&gt;μ΄μ  TCP/IP ν†µμ‹ μ„ ν•  λ• λ°μ΄ν„°λ¥Ό μ•”νΈν™” ν•λ” λ³΄μ•μ΄ ν•„μ”ν•κ³ ,&lt;/p&gt;

&lt;p&gt;κ·Έ λ³΄μ• μΈμ¦μ— TLSκ°€ μλ‹¤λ” κ²ƒλ„ μ•μ•μΌλ‹ &lt;strong&gt;TLSκ°€ μ–΄λ–»κ² λ°μ΄ν„°λ¥Ό μ•”νΈν™” ν•λ”μ§€&lt;/strong&gt; μ•μ•„λ΄…μ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ¨Όμ €, TLSλ” λ³΄μ•κ³Ό μ„±λ¥μƒ μ΄μλ΅ λ‘ κ°€μ§€μ μ•”νΈν™” λ°©λ²•μ„ νΌμ©ν•΄μ„ μ‚¬μ©ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ”°λΌμ„ λ‹¤μ λ‘ κ°€μ§€ μ•”νΈν™” λ°©λ²•μ„ μ΄ν•΄ν•΄μ•Ό ν•©λ‹λ‹¤&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;λ€μΉ­ν‚¤ μ•”νΈν™”(Symmetric key algorithm)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;λΉ„λ€μΉ­ν‚¤ μ•”νΈν™”(Asymmetric key algorithm)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;μ•”νΈν™”λ¥Ό ν•κΈ° μ„ν•΄μ„  μΌμΆ…μ ν‚¤(key)κ°€ ν•„μ”ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;ν‚¤λ” λ­ λ¬Έμκ°€ λ  μλ„ μκ³  μ«μκ°€ λ  μλ„ μκ³  λ§μλ€λ΅ μ •ν•  μ μμ§€μ”.&lt;/p&gt;

&lt;p&gt;μ•”νΈν™”λ” κ·Έλƒ¥ ν•λ” κ²ƒμ΄ μ•„λ‹λΌ μ΄ &lt;strong&gt;[ν‚¤]&lt;/strong&gt; + &lt;strong&gt;[λ°μ΄ν„°]&lt;/strong&gt;λ¥Ό μ΄μ©ν•μ—¬ &lt;strong&gt;[μ•”νΈν™”λ λ°μ΄ν„°]&lt;/strong&gt;λ¥Ό λ§λ“¤μ–΄ λ‚΄λ” κ²ƒμ…λ‹λ‹¤&lt;/p&gt;

&lt;p&gt;λ”°λΌμ„ ν‚¤κ°€ λ‹¨ ν• κΈ€μλΌλ„ λ‹¤λ¥΄λ‹¤λ©΄ μ•”νΈν™”μ λ‚΄μ©λ„ μ „ν€ λ‹¬λΌμ§‘λ‹λ‹¤!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;λ€μΉ­ν‚¤-μ•”νΈν™”&quot;&gt;λ€μΉ­ν‚¤ μ•”νΈν™”&lt;/h3&gt;
    &lt;p&gt;&lt;strong&gt;λ€μΉ­ν‚¤ μ•”νΈν™”λ”, μ•”νΈν™”λ¥Ό ν•λ” ν‚¤μ™€ μ•”νΈλ¥Ό ν•΄λ…ν•λ” ν‚¤κ°€ κ°™μ€ λ°©μ‹μ…λ‹λ‹¤.&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;μ΄λ• μ•”νΈν™”μ™€ λ³µνΈν™”μ— λ™μ‹μ— μ‚¬μ©λλ” μ΄ ν‚¤λ¥Ό  &lt;strong&gt;λ€μΉ­ν‚¤&lt;/strong&gt;  λΌκ³  ν•©λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μλ¥Όλ“¤λ©΄ μ•„λ κ·Έλ¦Όκ³Ό κ°™μµλ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/75003424/121342391-89bd7080-c95c-11eb-815b-492fd82d5c63.png&quot; alt=&quot;symmetric&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

    &lt;p&gt;μ, μ—¬κΈ°μ„ μ΄μ  λ€μΉ­ν‚¤ μ•”νΈν™”μ λ‹¨μ μ΄ λ“λ¬λ‚©λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;λ€μΉ­ν‚¤λ” μƒλ€λ°©λ„ λ‚λ„ μ„λ΅ κ³µμ λ¥Ό ν•΄μ•Όν•κΈ° λ•λ¬Έμ—,&lt;/p&gt;

    &lt;p&gt;λ€μΉ­ν‚¤λ¥Ό μ „λ‹¬ν•λ” κ³Όμ •μ—μ„ λ„κ°€ ν›”μ³λ³Ό μ„ν—μ΄ μμµλ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;λ§μ•½ λ€μΉ­ν‚¤κ°€ ν•΄ν‚Ήλ‹Ήν•λ‹¤λ©΄ κ·ΈλΌ λ‹Ήμ—°ν λ³µνΈν™”κ°€ κ°€λ¥ν•λ‹, λ°μ΄ν„°λ„ λ„μ¶λκ² λκ² μ£  :b&lt;/p&gt;

    &lt;p&gt;μ΄μ²λΌ λ€μΉ­ν‚¤ μ•”νΈν™” λ°©μ‹μ—μ„ , &lt;strong&gt;λ€μΉ­ν‚¤λ¥Ό μƒλ€μ—κ² μ „λ‹¬ν•λ” λ°©μ‹μ—μ„ ν•΄ν‚Ήλ‹Ήν•  λ¦¬μ¤ν¬κ°€&lt;/strong&gt; μμµλ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ΄λ¬ν• λ€μΉ­ν‚¤ μ•”νΈν™”μ κ·Όλ³Έμ μΈ λ¬Έμ λ¥Ό ν•΄κ²°ν•κ³ μ λ‚μ¨κ²ƒμ΄ λ‹¤μμ— μ†κ°ν•λ” &lt;strong&gt;λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” λ°©μ‹&lt;/strong&gt;μ…λ‹λ‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;λΉ„λ€μΉ­ν‚¤-μ•”νΈν™”&quot;&gt;λΉ„λ€μΉ­ν‚¤ μ•”νΈν™”&lt;/h3&gt;
    &lt;p&gt;&lt;strong&gt;ν•λ‚μ ν‚¤λ¥Ό κ°–λ” λ€μΉ­ν‚¤ μ•”νΈν™” λ°©μ‹κ³Ό λ‹¬λ¦¬,  λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” λ°©μ‹ μ€ ν• μμ ν‚¤λ¥Ό κ°–κ² λ©λ‹λ‹¤.&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;ν•λ§λ””λ΅ λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” λ°©μ‹μ—μ„  ν‚¤κ°€ 2κ° μ…λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ΄ λ‘κ°μ ν‚¤λ΅ κ°κ° μ•”νΈν™”, λ³µνΈν™”λ¥Ό ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

    &lt;p&gt;λ§μΌ A, BλΌλ” λ‘ κ°μ ν‚¤κ°€ μλ‹¤λ©΄ Aν‚¤λ΅ μ•”νΈν™”ν• λ°μ΄ν„°λ” Bν‚¤λ΅λ§ λ³µνΈν™”λ¥Ό ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;λν• Bν‚¤λ΅ μ•”νΈν™”ν• λ°μ΄ν„°λ” Aν‚¤λ΅λ§ λ³µνΈν™”λ¥Ό ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;Aν‚¤λ΅ μ•”νΈν™”ν• λ°μ΄ν„°λ¥Ό Aν‚¤λ΅ λ³µνΈν™” ν•  μ μ—†μΌλ©°, Bν‚¤λ„ λ§μ°¬κ°€μ§€ μ…λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

    &lt;p&gt;ν†µμƒμ μΌλ΅ λΉ„λ€μΉ­ν‚¤ λ°©μ‹μ—μ„ κ°€μ§€λ” λ‘κ°μ ν‚¤μ—μ„&lt;/p&gt;

    &lt;p&gt;ν•λ‚λ”  &lt;strong&gt;κ³µκ° ν‚¤(Public Key)&lt;/strong&gt; ,  ν•λ‚λ”  &lt;strong&gt;κ°μΈν‚¤(λΉ„λ°€ν‚¤, Private Key)&lt;/strong&gt; λΌκ³  λ¶€λ¦…λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ΄λ ‡κΈ° λ•λ¬Έμ— κ³µκ°ν‚¤λ” μ•”νΈν™”λ¥Ό, κ°μΈν‚¤λ” λ³µνΈν™”λ¥Ό ν•λ‹¤κ³  μ•λ ¤μ Έ μλ”λ° κ·Έλ ‡μ§€ μ•λ‹µλ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ΄λ¥Ό κ·Έλ¦ΌμΌλ΅ μ„¤λ…ν•μλ©΄ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/75003424/121317973-c631a200-c945-11eb-90c2-4779f59efea7.png&quot; alt=&quot;enc&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;
μ΄λ ‡λ“― ν• μμ ν‚¤λ΅ μ•”νΈν™”, λ³µνΈν™”λ¥Ό ν•λ” λ°©μ‹μ„  &lt;strong&gt;RSA μ•κ³ λ¦¬μ¦&lt;/strong&gt;  μ΄λΌ ν•©λ‹λ‹¤!
&lt;br /&gt;&lt;/p&gt;

    &lt;p&gt;μ΅°κΈλ” μ΄ν•΄ν•κΈ°μ‰½κ² κ·Έλ¦ΌμΌλ΅ ν‘ν„ν•΄λ³΄μλ©΄ μ•„λμ™€ κ°™μµλ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/75003424/121333638-f122f280-c953-11eb-8ce0-3f6b8763e3c8.png&quot; alt=&quot;rsa&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;μƒλ€λ°©μ κ³µκ°ν‚¤λ¥Ό λ°”νƒ•μΌλ΅ μ•”νΈν™”ν•΄μ„ λ³΄λ‚΄λ©΄ ν•΄λ‹Ή κ³µκ°ν‚¤μ μμΈ λΉ„λ°€ν‚¤λ¥Ό κ°€μ§„ μƒλ€λ°© λ§μ΄ μ•”νΈλ¥Ό ν•΄λ…ν•  μκ°€ μκ² μ£ ?&lt;/p&gt;

    &lt;p&gt;ν•΄μ»¤κ°€ κ³µκ°ν‚¤λ¥Ό μ–»λ”λ‹¤κ³ ν•΄λ„ μ•”νΈλ¥Ό ν•΄λ…ν•  μ μ—†κΈ°λ•λ¬Έμ— λ”μ± μ•μ „ν• μ•”νΈν™” λ°©μ‹μ…λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ–Έλ» λ³΄λ©΄ &lt;strong&gt;λΉ„λ€μΉ­ν‚¤(RSA)&lt;/strong&gt; λ°©μ‹μ λ°©λ²•μ΄ μ΄λ ‡κ² μ™„λ²½ν•΄ λ³΄μ΄λ”λ°&lt;/p&gt;

    &lt;p&gt;μ™ TLSλ” λ€μΉ­ν‚¤ λ°©μ‹κ³Ό λΉ„λ€μΉ­ν‚¤ λ°©μ‹μ„ κ°™μ΄ μ‚¬μ© ν• κΉμ”?&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;
κ·Έ μ΄μ λ” RSA μ•κ³ λ¦¬μ¦μ„ μ΄μ©ν• μ•”νΈν™” λ°©μ‹μ€ λ³µμ΅ν• μν•™μ  μ›λ¦¬λ΅ μ΄λ£¨μ–΄μ Έ μμ–΄,&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;CPU λ¦¬μ†μ¤λ¥Ό ν¬κ² μ†λ¨ν•λ‹¤λ” λ‹¨μ &lt;/strong&gt;μ΄ μκΈ° λ•λ¬Έμ…λ‹λ‹¤.&lt;/p&gt;

    &lt;p&gt;μ΄λ•λ¬Έμ—, RSA λΉ„λ€μΉ­ν‚¤ λ°©μ‹μΌλ΅λ§ ν†µμ‹ μ„ ν•κΈ°μ— μ„±λ¥μƒ μ–΄λ ¤μ›€μ΄ μμµλ‹λ‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;3-tlsμ-μ•”νΈν™”-λ°©μ‹&quot;&gt;3. TLSμ μ•”νΈν™” λ°©μ‹&lt;/h2&gt;

&lt;p&gt;μ§€κΈκΉμ§€ λ€μΉ­ν‚¤ λ°©μ‹κ³Ό λΉ„λ€μΉ­ν‚¤ λ°©μ‹μ μ›λ¦¬λ¥Ό μ•μ•„λ³΄μ•μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ„μ—μ„ μ„¤λ…λ“λ¦° λ‘ λ°©μ‹μ λ‹¨μ  λ•λ¬Έμ—, TLSμ—μ„λ” μ΄ λ‘ κ°€μ§€ λ°©μ‹μ„ λ³΄μ™„ν•μ—¬ μ‚¬μ©ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ€μΉ­ν‚¤ λ°©μ‹μ—μ„μ κ°€μ¥ ν° λ¬Έμ μ μ€ λ€μΉ­ν‚¤λ¥Ό μ „λ‹¬ν•  λ• ν•΄ν‚Ήλ‹Ήν•  λ¦¬μ¤ν¬μ€μ£ ?&lt;/p&gt;

&lt;p&gt;μ΄λ¥Ό RSA λΉ„λ€μΉ­ν‚¤ λ°©μ‹μΌλ΅ λ³΄μ•ν• κ²ƒμ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ‹¤μ  ν†µμ‹ μ„ ν•  λ•λ” CPU λ¦¬μ†μ¤ μ†λ¨κ°€ μ μ€ λ€μΉ­ν‚¤ λ°©μ‹μΌλ΅ λ°μ΄ν„°λ¥Ό μ£Όκ³  λ°›μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ΄ν•κΈ°μ‰½κ² κ·Έλ¦ΌμΌλ΅ μ„¤λ…λ“λ¦¬λ„λ΅ ν•κ² μµλ‹λ‹¤!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/75003424/121340354-7b6e5500-c95a-11eb-9450-97a64678b9cc.png&quot; alt=&quot;tls&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;CPU λ¦¬μ†μ¤λ¥Ό ν¬κ² μ†λ¨ν•λ‹¤λ” RSA&lt;/strong&gt;λ°©μ‹μ€ ν•λ²λ§ μ‚¬μ©ν•μ—¬ λ€μΉ­ν‚¤λ¥Ό μ•μ•„λ‚΄λ”μ©λ„λ΅λ§ μ“°μ΄κ³ &lt;/p&gt;

&lt;p&gt;λ‚λ¨Έμ§€ ν†µμ‹ μ€ κ°’μ΄ μ‹Ό λ€μΉ­ν‚¤ λ°©μ‹μ„ μ‚¬μ©ν•λ” κ²ƒμ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ·Έλ¦ΌμΌλ΅ λ³΄λ‹ λ” μ‰½κ² μ΄ν•΄κ°€ λμ‹μ§€μ”?&lt;/p&gt;

&lt;p&gt;μ΄λ ‡κ²  TLS, SSL, λ€μΉ­ν‚¤, λΉ„λ€μΉ­ν‚¤(κ³µκ°ν‚¤, κ°μΈν‚¤)μ— λ€ν•΄μ„  λ¨λ‘ μ•μ•„λ³΄μ•κµ¬μ”&lt;/p&gt;

&lt;p&gt;μ΄λ² ν¬μ¤ν…μ€ κΈΈμ–΄μ§€λ‹ μ—¬κΈ°μ„ λ§μΉκ³ ,&lt;/p&gt;

&lt;p&gt;μ΄ λ‹¤μ ν¬μ¤ν…μ—μ„  μΈμ¦μ„, λ””μ§€ν„Έ μ„λ…, CA λ“±λ“±μ— λ€ν•΄ λ‹¤λ¤„λ³΄κ² μµλ‹λ‹¤~&lt;/p&gt;</content><author><name>Sanghyuk Jeong</name><email>shjeong920522@gmail.com</email></author><category term="Kubernetes" /><category term="HTTPS" /><category term="static" /><category term="SSL" /><category term="TLS" /><category term="μΏ λ²„λ„¤ν‹°μ¤" /><category term="λ³΄μ•" /><category term="Security" /><category term="λ€μΉ­ν‚¤" /><category term="λΉ„λ€μΉ­ν‚¤" /><summary type="html">1. TLS / SSL / HTTPS λ€? SSL(Secure Socket Layer) SSLμ€ μ›Ήμ‚¬μ΄νΈμ™€ λΈλΌμ°μ €(νΉμ€, λ‘ μ„λ²„) μ‚¬μ΄μ— μ „μ†΅λ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•μ—¬ μΈν„°λ„· μ—°κ²° λ³΄μ•μ„ μ μ§€ν•λ” ν‘μ¤€ κΈ°μ μ…λ‹λ‹¤. μ΄λ” ν•΄μ»¤κ°€ κ°μΈ μ •λ³΄ λ° κΈμµ μ •λ³΄λ¥Ό ν¬ν•¨ν• μ „μ†΅λλ” λ¨λ“  μ •λ³΄λ¥Ό μ—΄λν•κ±°λ‚ ν›”μΉλ” κ²ƒμ„ λ°©μ§€ν•©λ‹λ‹¤. μ‰½κ² λ§ν•μλ©΄, λ„¤νΈμ›ν¬ ν†µμ‹ μ„ ν•  λ• λ³΄μ•μ„ μ κ³µν•κΈ° μ„ν•΄ μ„¤κ³„λ μ•”νΈ κ·μ•½μ΄λ©°, TCP/IP λ„¤νΈμ›ν¬λ¥Ό μ‚¬μ©ν•λ” ν†µμ‹ μ— μ μ©λ©λ‹λ‹¤. SSLμ κµ¬μ΅° TLS(Transport Layer Socket) μ΄λ¦„μ€ SSL κ³Ό λ‹¤λ¥΄μ§€λ§ μ‚¬μ‹¤ λ‘μ€ κ°™λ‹¤κ³  ν•©λ‹λ‹¤. TLS1.0μ€ SSL 3.0μ„ κ·Έλ€λ΅ κ³„μΉν• κ²ƒμ΄λΌκ³  ν•©λ‹λ‹¤. HTTP / HTTPS - HTTP HTTP λ” λ‹¤μκ³Ό κ°™μ΄ μ•”νΈν™” λμ§€ μ•μ€ ν‰λ¬ΈμΌλ΅ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•©λ‹λ‹¤ λ”°λΌμ„ λ„κµ°κ°€ ν¨ν‚·μ„ ν›”μ³λ³΄λ” μ¤λ‹ν•‘(Sniffing) κ³µκ²©μ— μ·¨μ•½ν•μ§€μ”. HTTP ν†µμ‹ μ—μ„  ν•΄μ»¤κ°€ Wire Sharkλ¥Ό ν†µν•΄ ν¨ν‚·μ„ ν™•μΈν•λ©΄ λ‚΄ λΉ„λ°€λ²νΈκ°€ κ·Έλ€λ΅ μ„λ²„λ΅ μ „μ†΅λλ” κ²ƒμ„ λ³Ό μ μλ”κ²ƒμ΄μ£  - HTTPS HTTPS λ” λ‹¤μκ³Ό κ°™μ΄ μ•”νΈν™” λ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•©λ‹λ‹¤ μ΄λ• μ‚¬μ©ν•λ” λ³΄μ• μΈμ¦(μ•”νΈν™” + μ„λ²„μΈμ¦ λ“±)μ΄ TLS(SSL)μ…λ‹λ‹¤. μ¦‰, HTTPSλ” TLS ν”„λ΅ν† μ½ μ„μ—μ„ λμ•„κ°€λ” HTTP ν”„λ΅ν† μ½μ…λ‹λ‹¤. κ°„λ‹¨ν•κ² λ§ν•΄μ„ ν†µμ‹ ν•  λ–„μ— λ°μ΄ν„°λ¥Ό β€μ•”νΈν™”β€™ ν•λ” λ³΄μ•μ΄ ν•„μ”ν•λ‹¤, HTTP ν†µμ‹ μ—μ„ λ³΄μ•μ„ μ¶”κ°€ν• κ²ƒμ΄ HTTPSμ΄λ©° μ΄λ• λ³΄μ•μ€ TLSλ¥Ό ν†µν•΄ ν•λ‹¤ μ •λ„λ΅ μ•κ³  λ„μ–΄κ°€λ©΄ λκ² μµλ‹λ‹¤. 2. μ•”νΈν™” μ΄μ  TCP/IP ν†µμ‹ μ„ ν•  λ• λ°μ΄ν„°λ¥Ό μ•”νΈν™” ν•λ” λ³΄μ•μ΄ ν•„μ”ν•κ³ , κ·Έ λ³΄μ• μΈμ¦μ— TLSκ°€ μλ‹¤λ” κ²ƒλ„ μ•μ•μΌλ‹ TLSκ°€ μ–΄λ–»κ² λ°μ΄ν„°λ¥Ό μ•”νΈν™” ν•λ”μ§€ μ•μ•„λ΄…μ‹λ‹¤. λ¨Όμ €, TLSλ” λ³΄μ•κ³Ό μ„±λ¥μƒ μ΄μλ΅ λ‘ κ°€μ§€μ μ•”νΈν™” λ°©λ²•μ„ νΌμ©ν•΄μ„ μ‚¬μ©ν•©λ‹λ‹¤. λ”°λΌμ„ λ‹¤μ λ‘ κ°€μ§€ μ•”νΈν™” λ°©λ²•μ„ μ΄ν•΄ν•΄μ•Ό ν•©λ‹λ‹¤ λ€μΉ­ν‚¤ μ•”νΈν™”(Symmetric key algorithm) λΉ„λ€μΉ­ν‚¤ μ•”νΈν™”(Asymmetric key algorithm) μ•”νΈν™”λ¥Ό ν•κΈ° μ„ν•΄μ„  μΌμΆ…μ ν‚¤(key)κ°€ ν•„μ”ν•©λ‹λ‹¤. ν‚¤λ” λ­ λ¬Έμκ°€ λ  μλ„ μκ³  μ«μκ°€ λ  μλ„ μκ³  λ§μλ€λ΅ μ •ν•  μ μμ§€μ”. μ•”νΈν™”λ” κ·Έλƒ¥ ν•λ” κ²ƒμ΄ μ•„λ‹λΌ μ΄ [ν‚¤] + [λ°μ΄ν„°]λ¥Ό μ΄μ©ν•μ—¬ [μ•”νΈν™”λ λ°μ΄ν„°]λ¥Ό λ§λ“¤μ–΄ λ‚΄λ” κ²ƒμ…λ‹λ‹¤ λ”°λΌμ„ ν‚¤κ°€ λ‹¨ ν• κΈ€μλΌλ„ λ‹¤λ¥΄λ‹¤λ©΄ μ•”νΈν™”μ λ‚΄μ©λ„ μ „ν€ λ‹¬λΌμ§‘λ‹λ‹¤! λ€μΉ­ν‚¤ μ•”νΈν™” λ€μΉ­ν‚¤ μ•”νΈν™”λ”, μ•”νΈν™”λ¥Ό ν•λ” ν‚¤μ™€ μ•”νΈλ¥Ό ν•΄λ…ν•λ” ν‚¤κ°€ κ°™μ€ λ°©μ‹μ…λ‹λ‹¤. μ΄λ• μ•”νΈν™”μ™€ λ³µνΈν™”μ— λ™μ‹μ— μ‚¬μ©λλ” μ΄ ν‚¤λ¥Ό λ€μΉ­ν‚¤ λΌκ³  ν•©λ‹λ‹¤. μλ¥Όλ“¤λ©΄ μ•„λ κ·Έλ¦Όκ³Ό κ°™μµλ‹λ‹¤. μ, μ—¬κΈ°μ„ μ΄μ  λ€μΉ­ν‚¤ μ•”νΈν™”μ λ‹¨μ μ΄ λ“λ¬λ‚©λ‹λ‹¤. λ€μΉ­ν‚¤λ” μƒλ€λ°©λ„ λ‚λ„ μ„λ΅ κ³µμ λ¥Ό ν•΄μ•Όν•κΈ° λ•λ¬Έμ—, λ€μΉ­ν‚¤λ¥Ό μ „λ‹¬ν•λ” κ³Όμ •μ—μ„ λ„κ°€ ν›”μ³λ³Ό μ„ν—μ΄ μμµλ‹λ‹¤. λ§μ•½ λ€μΉ­ν‚¤κ°€ ν•΄ν‚Ήλ‹Ήν•λ‹¤λ©΄ κ·ΈλΌ λ‹Ήμ—°ν λ³µνΈν™”κ°€ κ°€λ¥ν•λ‹, λ°μ΄ν„°λ„ λ„μ¶λκ² λκ² μ£  :b μ΄μ²λΌ λ€μΉ­ν‚¤ μ•”νΈν™” λ°©μ‹μ—μ„ , λ€μΉ­ν‚¤λ¥Ό μƒλ€μ—κ² μ „λ‹¬ν•λ” λ°©μ‹μ—μ„ ν•΄ν‚Ήλ‹Ήν•  λ¦¬μ¤ν¬κ°€ μμµλ‹λ‹¤. μ΄λ¬ν• λ€μΉ­ν‚¤ μ•”νΈν™”μ κ·Όλ³Έμ μΈ λ¬Έμ λ¥Ό ν•΄κ²°ν•κ³ μ λ‚μ¨κ²ƒμ΄ λ‹¤μμ— μ†κ°ν•λ” λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” λ°©μ‹μ…λ‹λ‹¤. λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” ν•λ‚μ ν‚¤λ¥Ό κ°–λ” λ€μΉ­ν‚¤ μ•”νΈν™” λ°©μ‹κ³Ό λ‹¬λ¦¬, λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” λ°©μ‹ μ€ ν• μμ ν‚¤λ¥Ό κ°–κ² λ©λ‹λ‹¤. ν•λ§λ””λ΅ λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” λ°©μ‹μ—μ„  ν‚¤κ°€ 2κ° μ…λ‹λ‹¤. μ΄ λ‘κ°μ ν‚¤λ΅ κ°κ° μ•”νΈν™”, λ³µνΈν™”λ¥Ό ν•  μ μμµλ‹λ‹¤. λ§μΌ A, BλΌλ” λ‘ κ°μ ν‚¤κ°€ μλ‹¤λ©΄ Aν‚¤λ΅ μ•”νΈν™”ν• λ°μ΄ν„°λ” Bν‚¤λ΅λ§ λ³µνΈν™”λ¥Ό ν•  μ μμµλ‹λ‹¤. λν• Bν‚¤λ΅ μ•”νΈν™”ν• λ°μ΄ν„°λ” Aν‚¤λ΅λ§ λ³µνΈν™”λ¥Ό ν•  μ μμµλ‹λ‹¤. Aν‚¤λ΅ μ•”νΈν™”ν• λ°μ΄ν„°λ¥Ό Aν‚¤λ΅ λ³µνΈν™” ν•  μ μ—†μΌλ©°, Bν‚¤λ„ λ§μ°¬κ°€μ§€ μ…λ‹λ‹¤. ν†µμƒμ μΌλ΅ λΉ„λ€μΉ­ν‚¤ λ°©μ‹μ—μ„ κ°€μ§€λ” λ‘κ°μ ν‚¤μ—μ„ ν•λ‚λ” κ³µκ° ν‚¤(Public Key) , ν•λ‚λ” κ°μΈν‚¤(λΉ„λ°€ν‚¤, Private Key) λΌκ³  λ¶€λ¦…λ‹λ‹¤. μ΄λ ‡κΈ° λ•λ¬Έμ— κ³µκ°ν‚¤λ” μ•”νΈν™”λ¥Ό, κ°μΈν‚¤λ” λ³µνΈν™”λ¥Ό ν•λ‹¤κ³  μ•λ ¤μ Έ μλ”λ° κ·Έλ ‡μ§€ μ•λ‹µλ‹λ‹¤. μ΄λ¥Ό κ·Έλ¦ΌμΌλ΅ μ„¤λ…ν•μλ©΄ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤ μ΄λ ‡λ“― ν• μμ ν‚¤λ΅ μ•”νΈν™”, λ³µνΈν™”λ¥Ό ν•λ” λ°©μ‹μ„ RSA μ•κ³ λ¦¬μ¦ μ΄λΌ ν•©λ‹λ‹¤! μ΅°κΈλ” μ΄ν•΄ν•κΈ°μ‰½κ² κ·Έλ¦ΌμΌλ΅ ν‘ν„ν•΄λ³΄μλ©΄ μ•„λμ™€ κ°™μµλ‹λ‹¤. μƒλ€λ°©μ κ³µκ°ν‚¤λ¥Ό λ°”νƒ•μΌλ΅ μ•”νΈν™”ν•΄μ„ λ³΄λ‚΄λ©΄ ν•΄λ‹Ή κ³µκ°ν‚¤μ μμΈ λΉ„λ°€ν‚¤λ¥Ό κ°€μ§„ μƒλ€λ°© λ§μ΄ μ•”νΈλ¥Ό ν•΄λ…ν•  μκ°€ μκ² μ£ ? ν•΄μ»¤κ°€ κ³µκ°ν‚¤λ¥Ό μ–»λ”λ‹¤κ³ ν•΄λ„ μ•”νΈλ¥Ό ν•΄λ…ν•  μ μ—†κΈ°λ•λ¬Έμ— λ”μ± μ•μ „ν• μ•”νΈν™” λ°©μ‹μ…λ‹λ‹¤. μ–Έλ» λ³΄λ©΄ λΉ„λ€μΉ­ν‚¤(RSA) λ°©μ‹μ λ°©λ²•μ΄ μ΄λ ‡κ² μ™„λ²½ν•΄ λ³΄μ΄λ”λ° μ™ TLSλ” λ€μΉ­ν‚¤ λ°©μ‹κ³Ό λΉ„λ€μΉ­ν‚¤ λ°©μ‹μ„ κ°™μ΄ μ‚¬μ© ν• κΉμ”? κ·Έ μ΄μ λ” RSA μ•κ³ λ¦¬μ¦μ„ μ΄μ©ν• μ•”νΈν™” λ°©μ‹μ€ λ³µμ΅ν• μν•™μ  μ›λ¦¬λ΅ μ΄λ£¨μ–΄μ Έ μμ–΄, CPU λ¦¬μ†μ¤λ¥Ό ν¬κ² μ†λ¨ν•λ‹¤λ” λ‹¨μ μ΄ μκΈ° λ•λ¬Έμ…λ‹λ‹¤. μ΄λ•λ¬Έμ—, RSA λΉ„λ€μΉ­ν‚¤ λ°©μ‹μΌλ΅λ§ ν†µμ‹ μ„ ν•κΈ°μ— μ„±λ¥μƒ μ–΄λ ¤μ›€μ΄ μμµλ‹λ‹¤. 3. TLSμ μ•”νΈν™” λ°©μ‹ μ§€κΈκΉμ§€ λ€μΉ­ν‚¤ λ°©μ‹κ³Ό λΉ„λ€μΉ­ν‚¤ λ°©μ‹μ μ›λ¦¬λ¥Ό μ•μ•„λ³΄μ•μµλ‹λ‹¤. μ„μ—μ„ μ„¤λ…λ“λ¦° λ‘ λ°©μ‹μ λ‹¨μ  λ•λ¬Έμ—, TLSμ—μ„λ” μ΄ λ‘ κ°€μ§€ λ°©μ‹μ„ λ³΄μ™„ν•μ—¬ μ‚¬μ©ν•©λ‹λ‹¤. λ€μΉ­ν‚¤ λ°©μ‹μ—μ„μ κ°€μ¥ ν° λ¬Έμ μ μ€ λ€μΉ­ν‚¤λ¥Ό μ „λ‹¬ν•  λ• ν•΄ν‚Ήλ‹Ήν•  λ¦¬μ¤ν¬μ€μ£ ? μ΄λ¥Ό RSA λΉ„λ€μΉ­ν‚¤ λ°©μ‹μΌλ΅ λ³΄μ•ν• κ²ƒμ…λ‹λ‹¤. μ‹¤μ  ν†µμ‹ μ„ ν•  λ•λ” CPU λ¦¬μ†μ¤ μ†λ¨κ°€ μ μ€ λ€μΉ­ν‚¤ λ°©μ‹μΌλ΅ λ°μ΄ν„°λ¥Ό μ£Όκ³  λ°›μµλ‹λ‹¤. μ΄ν•κΈ°μ‰½κ² κ·Έλ¦ΌμΌλ΅ μ„¤λ…λ“λ¦¬λ„λ΅ ν•κ² μµλ‹λ‹¤! CPU λ¦¬μ†μ¤λ¥Ό ν¬κ² μ†λ¨ν•λ‹¤λ” RSAλ°©μ‹μ€ ν•λ²λ§ μ‚¬μ©ν•μ—¬ λ€μΉ­ν‚¤λ¥Ό μ•μ•„λ‚΄λ”μ©λ„λ΅λ§ μ“°μ΄κ³  λ‚λ¨Έμ§€ ν†µμ‹ μ€ κ°’μ΄ μ‹Ό λ€μΉ­ν‚¤ λ°©μ‹μ„ μ‚¬μ©ν•λ” κ²ƒμ…λ‹λ‹¤. κ·Έλ¦ΌμΌλ΅ λ³΄λ‹ λ” μ‰½κ² μ΄ν•΄κ°€ λμ‹μ§€μ”? μ΄λ ‡κ² TLS, SSL, λ€μΉ­ν‚¤, λΉ„λ€μΉ­ν‚¤(κ³µκ°ν‚¤, κ°μΈν‚¤)μ— λ€ν•΄μ„  λ¨λ‘ μ•μ•„λ³΄μ•κµ¬μ” μ΄λ² ν¬μ¤ν…μ€ κΈΈμ–΄μ§€λ‹ μ—¬κΈ°μ„ λ§μΉκ³ , μ΄ λ‹¤μ ν¬μ¤ν…μ—μ„  μΈμ¦μ„, λ””μ§€ν„Έ μ„λ…, CA λ“±λ“±μ— λ€ν•΄ λ‹¤λ¤„λ³΄κ² μµλ‹λ‹¤~</summary></entry><entry><title type="html">[ #10 ] ν΄λ¬μ¤ν„° λ³΄μ• - 1</title><link href="https://shjeong92.github.io/2021/06/07/Learning-Kubernetes-10.html" rel="alternate" type="text/html" title="[ #10 ] ν΄λ¬μ¤ν„° λ³΄μ• - 1" /><published>2021-06-07T00:00:00+09:00</published><updated>2021-06-07T00:00:00+09:00</updated><id>https://shjeong92.github.io/2021/06/07/Learning-Kubernetes-10</id><content type="html" xml:base="https://shjeong92.github.io/2021/06/07/Learning-Kubernetes-10.html">&lt;p&gt;κΈ°λ³Έμ μΈ μΈμ¦ μλ‹¨μ—λ” &lt;strong&gt;Static Password File&lt;/strong&gt;μ„ ν†µν• λ°©λ²•κ³Ό, &lt;strong&gt;Static Token File&lt;/strong&gt;μ„ μ΄μ©ν• λ°©λ²•μ΄ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;h2 id=&quot;1---static-password-file&quot;&gt;1 - Static Password File&lt;/h2&gt;

&lt;p&gt;μ•„λμ μ μ €μ •λ³΄κ°€ λ‹΄κΈ΄ csvνμΌμ„ ν†µν•μ—¬ μΈμ¦ ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#user-details.csv
password123,username1,userId1
password133,username2,userId2
password113,username3,userId3 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;kubeadmμΌλ΅ ν΄λ¬μ¤ν„°λ¥Ό κµ¬μ„±ν•μ€μΌλ©΄ 
κ·Έλ¬κΈ° μ„ν•΄μ„  staticpodpathμ„μΉμ— kube-apiserver.yaml μ΄ μ΅΄μ¬ν•λ”λ°, μ•„λμ™€κ°™μ΄ μ‹¤ν–‰ μµμ…μ„ μ¶”κ°€ν•΄μ£Όλ©΄ λ©λ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s&quot;&gt;...μ¤‘λµ&lt;/span&gt;
  &lt;span class=&quot;s&quot;&gt;- command&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;kube-apiserver&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--advertise-address=10.178.0.2&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--allow-privileged=true&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--authorization-mode=Node,RBAC&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--client-ca-file=/etc/kubernetes/pki/ca.crt&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--enable-admission-plugins=NodeRestriction&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--enable-bootstrap-token-auth=true&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--etcd-cafile=/etc/kubernetes/pki/etcd/ca.crt&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--etcd-certfile=/etc/kubernetes/pki/apiserver-etcd-client.crt&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--etcd-keyfile=/etc/kubernetes/pki/apiserver-etcd-client.key&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--etcd-servers=https://127.0.0.1:2379&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--insecure-port=0&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--basic-auth-file=user-details.csv        &amp;lt;-----μ¶”κ°€λ μ‹¤ν–‰μµμ…&lt;/span&gt;
&lt;span class=&quot;nn&quot;&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;λν• μ΄ νμΌμ€ μ„ νƒμ μΌλ΅ 4λ²μ§Έ μ»¬λΌμ— κ·Έλ£Ήλ…μ„ λ„£μ„ μλ„ μμµλ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#user-details.csv 
password123,username1,userId1,group1
password133,username2,userId2,group2
password113,username3,userId3,group2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;2---static-token-file&quot;&gt;2 - Static Token File&lt;/h2&gt;

&lt;p&gt;λ‘λ²μ§Έ κΈ°λ³Έ μΈμ¦ λ°©λ²•μΌλ΅ Password λ€μ‹ μ— Tokenμ„ μ‚¬μ©ν•λ” λ°©λ²•μΈλ°μ”&lt;/p&gt;

&lt;p&gt;μ²«λ²μ§Έ μ»¬λΌμ— λΉ„λ°€λ²νΈ λ€μ‹ μ— ν† ν°μ΄ λ“¤μ–΄κ°€λ” μ°¨μ΄κ°€ μκ³ ,&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;user-token-details.csv
AjkfgljADSKFfjkwelkasdfKdfgkdlfga,username1,userId1,group1(optional)
RAakjkfskfgElkasdfjkERlfkglgDFFLg,username2,userId2,group2(optional)
lfkjgkqlwemdfgEaklFKSGkejsfdkgkas,username1,userId2,group2(optional)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ‹¤ν–‰ μµμ…μ΄ λ‹¤λ¥Έ μ°¨μ΄μ μ΄ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s&quot;&gt;...μ¤‘λµ&lt;/span&gt;
  &lt;span class=&quot;s&quot;&gt;- command&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;kube-apiserver&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--advertise-address=10.178.0.2&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--allow-privileged=true&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--authorization-mode=Node,RBAC&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--client-ca-file=/etc/kubernetes/pki/ca.crt&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--enable-admission-plugins=NodeRestriction&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--enable-bootstrap-token-auth=true&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--etcd-cafile=/etc/kubernetes/pki/etcd/ca.crt&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--etcd-certfile=/etc/kubernetes/pki/apiserver-etcd-client.crt&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--etcd-keyfile=/etc/kubernetes/pki/apiserver-etcd-client.key&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--etcd-servers=https://127.0.0.1:2379&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--insecure-port=0&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--token-auth-file=user-details.csv        &amp;lt;-----μ¶”κ°€λ μ‹¤ν–‰μµμ…&lt;/span&gt;
&lt;span class=&quot;nn&quot;&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ„ λ‘κ°€μ§€ λ°©λ²•μ€ μ¶”μ²λλ” μΈμ¦ λ°©μ‹μ΄ μ•„λ‹λΌκ³ ν•©λ‹λ‹¤.
λ‹¤μ ν¬μ¤νΈμ—μ„λ” μ‹¤μ λ΅ μ“°μ΄λ” λ°©μ‹μ— λ€ν•΄ λ‹¤λ¤„λ³΄κ² μµλ‹λ‹¤.&lt;/p&gt;</content><author><name>Sanghyuk Jeong</name><email>shjeong920522@gmail.com</email></author><category term="Kubernetes" /><category term="maintenance" /><category term="static" /><category term="pod" /><category term="strategy" /><category term="μΏ λ²„λ„¤ν‹°μ¤" /><category term="update" /><summary type="html">κΈ°λ³Έμ μΈ μΈμ¦ μλ‹¨μ—λ” Static Password Fileμ„ ν†µν• λ°©λ²•κ³Ό, Static Token Fileμ„ μ΄μ©ν• λ°©λ²•μ΄ μμµλ‹λ‹¤. 1 - Static Password File μ•„λμ μ μ €μ •λ³΄κ°€ λ‹΄κΈ΄ csvνμΌμ„ ν†µν•μ—¬ μΈμ¦ ν•  μ μμµλ‹λ‹¤. #user-details.csv password123,username1,userId1 password133,username2,userId2 password113,username3,userId3 kubeadmμΌλ΅ ν΄λ¬μ¤ν„°λ¥Ό κµ¬μ„±ν•μ€μΌλ©΄ κ·Έλ¬κΈ° μ„ν•΄μ„  staticpodpathμ„μΉμ— kube-apiserver.yaml μ΄ μ΅΄μ¬ν•λ”λ°, μ•„λμ™€κ°™μ΄ μ‹¤ν–‰ μµμ…μ„ μ¶”κ°€ν•΄μ£Όλ©΄ λ©λ‹λ‹¤ ...μ¤‘λµ - command: - kube-apiserver - --advertise-address=10.178.0.2 - --allow-privileged=true - --authorization-mode=Node,RBAC - --client-ca-file=/etc/kubernetes/pki/ca.crt - --enable-admission-plugins=NodeRestriction - --enable-bootstrap-token-auth=true - --etcd-cafile=/etc/kubernetes/pki/etcd/ca.crt - --etcd-certfile=/etc/kubernetes/pki/apiserver-etcd-client.crt - --etcd-keyfile=/etc/kubernetes/pki/apiserver-etcd-client.key - --etcd-servers=https://127.0.0.1:2379 - --insecure-port=0 - --basic-auth-file=user-details.csv &amp;lt;-----μ¶”κ°€λ μ‹¤ν–‰μµμ… ... λν• μ΄ νμΌμ€ μ„ νƒμ μΌλ΅ 4λ²μ§Έ μ»¬λΌμ— κ·Έλ£Ήλ…μ„ λ„£μ„ μλ„ μμµλ‹λ‹¤. #user-details.csv password123,username1,userId1,group1 password133,username2,userId2,group2 password113,username3,userId3,group2 2 - Static Token File λ‘λ²μ§Έ κΈ°λ³Έ μΈμ¦ λ°©λ²•μΌλ΅ Password λ€μ‹ μ— Tokenμ„ μ‚¬μ©ν•λ” λ°©λ²•μΈλ°μ” μ²«λ²μ§Έ μ»¬λΌμ— λΉ„λ°€λ²νΈ λ€μ‹ μ— ν† ν°μ΄ λ“¤μ–΄κ°€λ” μ°¨μ΄κ°€ μκ³ , user-token-details.csv AjkfgljADSKFfjkwelkasdfKdfgkdlfga,username1,userId1,group1(optional) RAakjkfskfgElkasdfjkERlfkglgDFFLg,username2,userId2,group2(optional) lfkjgkqlwemdfgEaklFKSGkejsfdkgkas,username1,userId2,group2(optional) μ‹¤ν–‰ μµμ…μ΄ λ‹¤λ¥Έ μ°¨μ΄μ μ΄ μμµλ‹λ‹¤. ...μ¤‘λµ - command: - kube-apiserver - --advertise-address=10.178.0.2 - --allow-privileged=true - --authorization-mode=Node,RBAC - --client-ca-file=/etc/kubernetes/pki/ca.crt - --enable-admission-plugins=NodeRestriction - --enable-bootstrap-token-auth=true - --etcd-cafile=/etc/kubernetes/pki/etcd/ca.crt - --etcd-certfile=/etc/kubernetes/pki/apiserver-etcd-client.crt - --etcd-keyfile=/etc/kubernetes/pki/apiserver-etcd-client.key - --etcd-servers=https://127.0.0.1:2379 - --insecure-port=0 - --token-auth-file=user-details.csv &amp;lt;-----μ¶”κ°€λ μ‹¤ν–‰μµμ… ... μ„ λ‘κ°€μ§€ λ°©λ²•μ€ μ¶”μ²λλ” μΈμ¦ λ°©μ‹μ΄ μ•„λ‹λΌκ³ ν•©λ‹λ‹¤. λ‹¤μ ν¬μ¤νΈμ—μ„λ” μ‹¤μ λ΅ μ“°μ΄λ” λ°©μ‹μ— λ€ν•΄ λ‹¤λ¤„λ³΄κ² μµλ‹λ‹¤.</summary></entry><entry><title type="html">[ #9 ] ν΄λ¬μ¤ν„° λ°±μ—… &amp;amp; λ³µκµ¬</title><link href="https://shjeong92.github.io/2021/06/04/Learning-Kubernetes-09.html" rel="alternate" type="text/html" title="[ #9 ] ν΄λ¬μ¤ν„° λ°±μ—… &amp;amp; λ³µκµ¬" /><published>2021-06-04T00:00:00+09:00</published><updated>2021-06-04T00:00:00+09:00</updated><id>https://shjeong92.github.io/2021/06/04/Learning-Kubernetes-09</id><content type="html" xml:base="https://shjeong92.github.io/2021/06/04/Learning-Kubernetes-09.html">&lt;p&gt;μ΄λ² ν¬μ¤νΈμ—μ„λ” ETCD databaseλ¥Ό μ΄μ©ν• ν΄λ¬μ¤ν„° λ°±μ—… λ° λ³µκµ¬ λ°©λ²•μ— λ€ν•΄μ„ λ‹¤λ¤„λ³΄κ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;h2 id=&quot;etcdλ€&quot;&gt;etcdλ€&lt;/h2&gt;

&lt;p&gt;etcdλ” λ¨λ“  ν΄λ¬μ¤ν„° λ°μ΄ν„°μ— λ€ν• Kubernetesμ λ°±μ—… μ €μ¥μ†λ΅ μ‚¬μ©λλ” μΌκ΄€λκ³  κ°€μ©μ„±μ΄ λ†’μ€ ν‚¤ κ°’ μ €μ¥μ†μ…λ‹λ‹¤&lt;/p&gt;

&lt;p&gt;κ·Έλ¦¬κ³  ETCDλ” κ° λ§μ¤ν„°λ…Έλ“μ— μ΅΄μ¬ν•κ³ , key=valueμ λ°μ΄ν„°λ” λ§μ¤ν„° λ…Έλ“μ /var/lib/etcd μ— μ €μ¥λ©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;ETCDλ” built in μ¤λƒ…μƒ· solutionμ„ κ°€μ§€κ³  μλ”λ°μ” μ΄λ¥Όν†µν•΄ ν„μ¬ μ‹¤ν–‰μ¤‘μΈ λ¨λ“  λ¦¬μ†μ¤μ μ •λ³΄λ¥Ό λ°±μ—…ν•κ³ , λ³µκµ¬ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;h3 id=&quot;step1---etcdκ°€-μ„¤μΉλμ–΄-μμ§€-μ•μ„κ²½μ°-μ„¤μΉν•©λ‹λ‹¤&quot;&gt;STEP1 - etcdκ°€ μ„¤μΉλμ–΄ μμ§€ μ•μ„κ²½μ° μ„¤μΉν•©λ‹λ‹¤.&lt;/h3&gt;

&lt;p&gt;μ  μΏ λ²„λ„¤ν‹° ν΄λ¬μ¤ν„°λ” 1 κ°μ λ§μ¤ν„°λ…Έλ“, 3κ°μ μ›μ»¤λ…Έλ“λ΅ κµ¬μ„±λμ–΄ μμµλ‹λ‹¤. googld cloud compute engine μΈμ¤ν„΄μ¤λ¥Ό μ‚¬μ©ν•μ—¬ κµ¬μ„±ν•μ€μΌλ©° λ¨λ“  λ…Έλ“λ” Ubuntu 18.04.5 LTS λ²„μ „μ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ•„λ μ»¤λ§¨λ“λ¥Ό μ΄μ©ν•΄ etcd-clientλ¥Ό μ„¤μΉν•΄μ¤λ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt update

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;etcd-client
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;step2---λ³µκµ¬μ‹ν‚¬-ν™κ²½-κµ¬μ„±&quot;&gt;STEP2 - λ³µκµ¬μ‹ν‚¬ ν™κ²½ κµ¬μ„±&lt;/h3&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#depl.yaml&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;apps/v1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Deployment&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp-deployment&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;front-end&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp-pod&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;front-end&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx-container&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx:1.19&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;replicas&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;selector&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;matchLabels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;front-end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;κ°„λ‹¨ν• yamlνμΌμ„ ν†µν•΄ 3κ°μ nginx νλ“λ¥Ό λ°°ν¬ν•©λ‹λ‹¤&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl apply &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; depl.yml 
deployment.apps/myapp-deployment created
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;κ·Έλ¦¬κ³  ν„μ¬ μ–΄λ–¤ λ¦¬μ†μ¤λ“¤μ΄ λμ•„κ°€κ³ μλ”μ§€ ν™•μΈν•΄μ£Όκ³  μ΄ μƒν™©μ μ¤λƒ…μƒ·μ„ μƒμ„±ν• κ²λ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ kubectl get all
NAME                                    READY   STATUS    RESTARTS   AGE
pod/myapp-deployment-7f6679cc7d-5qwxx   1/1     Running   0          32s
pod/myapp-deployment-7f6679cc7d-855lp   1/1     Running   0          32s
pod/myapp-deployment-7f6679cc7d-bxxjx   1/1     Running   0          32s

NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
service/kubernetes   ClusterIP   10.96.0.1    &amp;lt;none&amp;gt;        443/TCP   8d

NAME                               READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/myapp-deployment   3/3     3            3           32s

NAME                                          DESIRED   CURRENT   READY   AGE
replicaset.apps/myapp-deployment-7f6679cc7d   3         3         3       32s
shjeong920522@master:~/Pod$ 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;μ¤λƒ…μƒ·-μƒμ„±ν•κΈ°&quot;&gt;μ¤λƒ…μƒ· μƒμ„±ν•κΈ°&lt;/h2&gt;

&lt;p&gt;etcdctlμ μ¤λƒ…μƒ·μ„ μƒμ„±ν•κΈ°μ„ν•΄μ„  μ•„λμ™€κ°™μ€ μµμ…μ΄ ν•„μ”ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;etcdctl &lt;span class=&quot;nt&quot;&gt;--cacert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;μµμ…κ°’ &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--cert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;μµμ…κ°’ &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;μµμ…κ°’ &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
snapshot save λ°±μ—…κ²½λ΅ λ° νμΌμ΄λ¦„
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;κ·Έλ ‡λ‹¤λ©΄ μ΄ μµμ…κ°’μ€ μ–΄λ””μ„ ν™•μΈκ°€λ¥ν• κΉμ”?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;psλ…λ Ήμ–΄ μ™€ grepμ„ λ¥Ό ν™μ©ν•λ©΄ λλ‹µλ‹λ‹¤&lt;/p&gt;

&lt;p&gt;μ•„λ λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•μ—¬ λ‹¤ μ°Ύμ•„μ„ κ°’μ„ κ°€μ Έμ™€λ„λμ§€λ§&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps &lt;span class=&quot;nt&quot;&gt;-ef&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;etcd
root      2863  2764  1 05:36 ?        00:00:23 etcd &lt;span class=&quot;nt&quot;&gt;--advertise-client-urls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://10.178.0.2:2379 &lt;span class=&quot;nt&quot;&gt;--cert-file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/server.crt &lt;span class=&quot;nt&quot;&gt;--client-cert-auth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--data-dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/etcd &lt;span class=&quot;nt&quot;&gt;--initial-advertise-peer-urls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://10.178.0.2:2380 &lt;span class=&quot;nt&quot;&gt;--initial-cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;master&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://10.178.0.2:2380 &lt;span class=&quot;nt&quot;&gt;--key-file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/server.key &lt;span class=&quot;nt&quot;&gt;--listen-client-urls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://127.0.0.1:2379,https://10.178.0.2:2379 &lt;span class=&quot;nt&quot;&gt;--listen-metrics-urls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;http://127.0.0.1:2381 &lt;span class=&quot;nt&quot;&gt;--listen-peer-urls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://10.178.0.2:2380 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;master &lt;span class=&quot;nt&quot;&gt;--peer-cert-file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/peer.crt &lt;span class=&quot;nt&quot;&gt;--peer-client-cert-auth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--peer-key-file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/peer.key &lt;span class=&quot;nt&quot;&gt;--peer-trusted-ca-file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/ca.crt &lt;span class=&quot;nt&quot;&gt;--snapshot-count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10000 &lt;span class=&quot;nt&quot;&gt;--trusted-ca-file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/ca.crt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ν‘μ— λ“¤μ–΄κ°„ μ»¤λ§¨λ“λ΅ μ›ν•λ” λ¶€λ¶„μ„ κ°•μ΅°μ‹μΌ μ°Ύλ”λ°©λ²•μ„ μ¶”μ²λ“λ¦½λ‹λ‹¤. λμ•κµ΄λ ¤μ„ μ°Ύλ”κ²ƒλ³΄λ‹¤ ν›¨μ”¬ λΉ λ¥΄λ”λΌκµ¬μ”&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;&lt;center&gt;etcdctl λ…λ Ή μµμ…&lt;/center&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;&lt;center&gt;etcd &lt;br /&gt;ν”„λ΅μ„Έμ¤ μ‹¤ν–‰μµμ…&lt;/center&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;&lt;center&gt;κ°’&lt;/center&gt;&lt;/th&gt;
      &lt;th&gt;&lt;center&gt;μ»¤λ§¨λ“λ΅ λΉ¨λ¦¬μ°ΎκΈ°&lt;/center&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--cacert&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--trusted-ca-file&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;/etc/kubernetes/pki/etcd/ca.crt&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -ef | grep etcd | grep trusted&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--cert&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--cert-file&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;/etc/kubernetes/pki/etcd/server.crt&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -ef | grep etcd | grep &quot;\--cert&quot;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--key&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--key-file&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;/etc/kubernetes/pki/etcd/server.key&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -ef | grep etcd | grep &quot;\--key&quot;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;κ·Έλ¦¬κ³  κ°’ λ¶€λ¶„μ€ ν•­μƒ κ°™μ€κ²ƒμ΄ μ•„λ‹ μλ„ μκΈ°μ— μ»¤λ§¨λ“λ΅ μ§μ ‘ ν™•μΈν•μ…”μ•Ό ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ μ΄μ  μ¤λƒ…μƒ·μ„ μƒμ„±ν•κΈ°μ„ν•μ—¬ μ°μ„  λ£¨νΈκ³„μ •μΌλ΅ μ „ν™ν•΄μ¤λ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ•„λμ™€ κ°™μ΄ ν™κ²½λ³€μλ¥Ό λ“±λ΅ν•΄μ¤λ‹λ‹¤
ETCDCTL_API 3λ²„μ „μ„ μ‚¬μ©ν•κΈ° μ„ν•¨μ…λ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root# &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ETCDCTL_API&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root# etcdctl &lt;span class=&quot;nt&quot;&gt;--cacert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/ca.crt &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--cert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/server.crt &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/server.key &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; snapshot save /opt/backup
Snapshot saved at /opt/backup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ¤λƒ…μƒ·μ„ μƒμ„±ν•μ€μΌλ‹ μ•„κΉ λ°°ν¬ν•μ€λ deployment λ¥Ό deleteν•κ³  etcdctl λ³µκµ¬λ¥Όν•μ—¬
μ •λ§ λ™μ‘ν•λ deploymentλ¥Ό λ‹¤μ‹ λ°°ν¬ν•΄μ£Όλ”μ§€ ν™•μΈν•΄λ΄…μ‹λ‹¤&lt;/p&gt;

&lt;p&gt;μ°μ„  λ£¨νΈκ³„μ •μ—μ„ λ΅κ·Έμ•„μ›ƒ ν•΄μ£Όμ‹κµ¬μ”&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root# &lt;span class=&quot;nb&quot;&gt;exit
logout&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;deploymentλ¥Ό μ‚­μ μ‹μΌμ¤λ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl delete &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; depl.yml 
deployment.apps &lt;span class=&quot;s2&quot;&gt;&quot;myapp-deployment&quot;&lt;/span&gt; deleted
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;λ³µκµ¬ν•κΈ°λ΅ λ„μ–΄κ°‘λ‹λ‹¤.&lt;/p&gt;

&lt;h2 id=&quot;μ¤λƒ…μƒ·μΌλ΅-λ³µκµ¬ν•κΈ°&quot;&gt;μ¤λƒ…μƒ·μΌλ΅ λ³µκµ¬ν•κΈ°&lt;/h2&gt;

&lt;p&gt;λ³µκµ¬ν• λ•λ” μ¤λƒ…μƒ·μ„ λ§λ“¤λ• λ„£μ—λ μµμ…μ—μ„ λ„¤κ°€μ§€μ μµμ…μ΄ λ” μ¶”κ°€λ©λ‹λ‹¤.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;&lt;center&gt;etcdctl λ…λ Ή μµμ…&lt;/center&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;&lt;center&gt;etcd &lt;br /&gt;ν”„λ΅μ„Έμ¤ μ‹¤ν–‰μµμ…&lt;/center&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;&lt;center&gt;κ°’&lt;/center&gt;&lt;/th&gt;
      &lt;th&gt;&lt;center&gt;μ»¤λ§¨λ“λ΅ λΉ¨λ¦¬μ°ΎκΈ°&lt;/center&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--cacert&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--trusted-ca-file&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;/etc/kubernetes/pki/etcd/ca.crt&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -ef | grep etcd | grep trusted&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--cert&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--cert-file&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;/etc/kubernetes/pki/etcd/server.crt&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -ef | grep etcd | grep &quot;\--cert&quot;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--key&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--key-file&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;/etc/kubernetes/pki/etcd/server.key&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -ef | grep etcd | grep &quot;\--key&quot;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--initial-advertise-peer-urls&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--initial-advertise-peer-urls&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;https://10.178.0.2:2380&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -ef | grep etcd | grep initial&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--initial-cluster=master&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--initial-cluster=master&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;https://10.178.0.2:2380&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -ef | grep etcd | grep initial&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--data-dir&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--data-dir&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;/var/lib/etcd_backup&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -ef | grep etcd | grep &quot;\--data-dir&quot; &lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--name&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;--name&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;master(λ§μ¤ν„°λ…Έλ“μ΄λ¦„)&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -ef | grep etcd | grep &quot;\--name&quot;&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;μ μ—¬κΈ°κΉμ§€κ°€ restore ν• λ• ν•„μ”ν• λ¨λ“  μµμ…μ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ΄μ  μ•„κΉ μ°μ–΄λ†¨λ μ¤λƒ…μƒ·μΌλ΅ λ³µκµ¬λλ”μ§€ ν™•μΈν•΄λ΄…μ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ°μ„  λ£¨νΈ κ³„μ •μΌλ΅ μ „ν™ν•κµ¬μ”&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;restore λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•΄μ£Όκ³  λ΅κ·Έμ•„μ›ƒν•΄μ¤λ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root# etcdctl &lt;span class=&quot;nt&quot;&gt;--cacert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/ca.crt &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--cert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/server.crt &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/pki/etcd/server.key &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--initial-advertise-peer-urls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://10.178.0.2:2380 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--initial-cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;master&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://10.178.0.2:2380 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--data-dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/etcd_backup &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;master &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; snapshot restore /opt/backup

root# &lt;span class=&quot;nb&quot;&gt;exit
logout&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;/opt/backup μ— μƒμ„±ν•΄λ’€λ μ¤λƒ…μƒ·μ„μ΄μ©ν•΄μ„ /var/lib μ„μΉμ— etcd_backup νμΌμ„ μƒμ„±ν•©λ‹λ‹¤
staticpodμ—μ„ μ‹¤ν–‰λλ” etcdκ°€ μ΄λ¥Ό λ°”λΌλ³΄λ„λ΅ ν•΄μ¤μ•Όν•κ² μ§€μ”&lt;/p&gt;

&lt;p&gt;staticpodμ μ„μΉμΈ /etc/kubernetes/manifestλ΅ μ΄λ™ν›„ etcd.yamlμ„ μμ •ν•΄μ•Όν•©λ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /etc/kubernetes/manifest

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;vim etcd.yaml

~~~yaml
&lt;span class=&quot;c&quot;&gt;#etcd.yaml&lt;/span&gt;
...μ¤‘λµ

volumes:
- hostPath:
    path: /etc/kubernetes/pki/etcd
    &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: DirectoryOrCreate
  name: etcd-certs
- hostPath:
    path: /var/lib/etcd_backup     &amp;lt;&lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;  backupν• μ¤λƒ…μƒ·μ„ λ°”λΌλ³΄κ² μμ •ν•΄μ¤λ‹λ‹¤
    &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: DirectoryOrCreate
  name: etcd-data

...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;λ³€κ²½μ‚¬ν•­μ„ μ €μ¥ν•΄μ£Όλ©΄ μƒλ΅ λ΅λ“λ λ•κΉμ§€ μ‹κ°„μ΄ μ΅°κΈκ±Έλ¦½λ‹λ‹¤&lt;/p&gt;

&lt;p&gt;μ μ‹ν›„ μ •λ§ μ‹¤ν–‰ μ¤‘μ΄λ deploymentκ°€ μ‹¤ν–‰μ¤‘μΈμ§€ ν™•μΈν•΄λ΄…μ‹λ‹¤&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl get deploy
NAME               READY   UP-TO-DATE   AVAILABLE   AGE
myapp-deployment   3/3     3            3           20s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ§μ”~ μ λ³µκµ¬λκ²ƒμ„ ν™•μΈν•  μ μμ—μµλ‹λ‹¤&lt;/p&gt;</content><author><name>Sanghyuk Jeong</name><email>shjeong920522@gmail.com</email></author><category term="Kubernetes" /><category term="maintenance" /><category term="static" /><category term="pod" /><category term="strategy" /><category term="μΏ λ²„λ„¤ν‹°μ¤" /><category term="update" /><summary type="html">μ΄λ² ν¬μ¤νΈμ—μ„λ” ETCD databaseλ¥Ό μ΄μ©ν• ν΄λ¬μ¤ν„° λ°±μ—… λ° λ³µκµ¬ λ°©λ²•μ— λ€ν•΄μ„ λ‹¤λ¤„λ³΄κ² μµλ‹λ‹¤. etcdλ€ etcdλ” λ¨λ“  ν΄λ¬μ¤ν„° λ°μ΄ν„°μ— λ€ν• Kubernetesμ λ°±μ—… μ €μ¥μ†λ΅ μ‚¬μ©λλ” μΌκ΄€λκ³  κ°€μ©μ„±μ΄ λ†’μ€ ν‚¤ κ°’ μ €μ¥μ†μ…λ‹λ‹¤ κ·Έλ¦¬κ³  ETCDλ” κ° λ§μ¤ν„°λ…Έλ“μ— μ΅΄μ¬ν•κ³ , key=valueμ λ°μ΄ν„°λ” λ§μ¤ν„° λ…Έλ“μ /var/lib/etcd μ— μ €μ¥λ©λ‹λ‹¤. ETCDλ” built in μ¤λƒ…μƒ· solutionμ„ κ°€μ§€κ³  μλ”λ°μ” μ΄λ¥Όν†µν•΄ ν„μ¬ μ‹¤ν–‰μ¤‘μΈ λ¨λ“  λ¦¬μ†μ¤μ μ •λ³΄λ¥Ό λ°±μ—…ν•κ³ , λ³µκµ¬ν•  μ μμµλ‹λ‹¤. STEP1 - etcdκ°€ μ„¤μΉλμ–΄ μμ§€ μ•μ„κ²½μ° μ„¤μΉν•©λ‹λ‹¤. μ  μΏ λ²„λ„¤ν‹° ν΄λ¬μ¤ν„°λ” 1 κ°μ λ§μ¤ν„°λ…Έλ“, 3κ°μ μ›μ»¤λ…Έλ“λ΅ κµ¬μ„±λμ–΄ μμµλ‹λ‹¤. googld cloud compute engine μΈμ¤ν„΄μ¤λ¥Ό μ‚¬μ©ν•μ—¬ κµ¬μ„±ν•μ€μΌλ©° λ¨λ“  λ…Έλ“λ” Ubuntu 18.04.5 LTS λ²„μ „μ…λ‹λ‹¤. μ•„λ μ»¤λ§¨λ“λ¥Ό μ΄μ©ν•΄ etcd-clientλ¥Ό μ„¤μΉν•΄μ¤λ‹λ‹¤ $ sudo apt update $ sudo apt install etcd-client STEP2 - λ³µκµ¬μ‹ν‚¬ ν™κ²½ κµ¬μ„± #depl.yaml apiVersion: apps/v1 kind: Deployment metadata: name: myapp-deployment labels: app: myapp type: front-end spec: template: metadata: name: myapp-pod labels: app: myapp type: front-end spec: containers: - name: nginx-container image: nginx:1.19 replicas: 3 selector: matchLabels: type: front-end κ°„λ‹¨ν• yamlνμΌμ„ ν†µν•΄ 3κ°μ nginx νλ“λ¥Ό λ°°ν¬ν•©λ‹λ‹¤ $ kubectl apply -f depl.yml deployment.apps/myapp-deployment created κ·Έλ¦¬κ³  ν„μ¬ μ–΄λ–¤ λ¦¬μ†μ¤λ“¤μ΄ λμ•„κ°€κ³ μλ”μ§€ ν™•μΈν•΄μ£Όκ³  μ΄ μƒν™©μ μ¤λƒ…μƒ·μ„ μƒμ„±ν• κ²λ‹λ‹¤ $ kubectl get all NAME READY STATUS RESTARTS AGE pod/myapp-deployment-7f6679cc7d-5qwxx 1/1 Running 0 32s pod/myapp-deployment-7f6679cc7d-855lp 1/1 Running 0 32s pod/myapp-deployment-7f6679cc7d-bxxjx 1/1 Running 0 32s NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE service/kubernetes ClusterIP 10.96.0.1 &amp;lt;none&amp;gt; 443/TCP 8d NAME READY UP-TO-DATE AVAILABLE AGE deployment.apps/myapp-deployment 3/3 3 3 32s NAME DESIRED CURRENT READY AGE replicaset.apps/myapp-deployment-7f6679cc7d 3 3 3 32s shjeong920522@master:~/Pod$ μ¤λƒ…μƒ· μƒμ„±ν•κΈ° etcdctlμ μ¤λƒ…μƒ·μ„ μƒμ„±ν•κΈ°μ„ν•΄μ„  μ•„λμ™€κ°™μ€ μµμ…μ΄ ν•„μ”ν•©λ‹λ‹¤. etcdctl --cacert=μµμ…κ°’ \ --cert=μµμ…κ°’ \ --key=μµμ…κ°’ \ snapshot save λ°±μ—…κ²½λ΅ λ° νμΌμ΄λ¦„ κ·Έλ ‡λ‹¤λ©΄ μ΄ μµμ…κ°’μ€ μ–΄λ””μ„ ν™•μΈκ°€λ¥ν• κΉμ”? psλ…λ Ήμ–΄ μ™€ grepμ„ λ¥Ό ν™μ©ν•λ©΄ λλ‹µλ‹λ‹¤ μ•„λ λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•μ—¬ λ‹¤ μ°Ύμ•„μ„ κ°’μ„ κ°€μ Έμ™€λ„λμ§€λ§ $ ps -ef | grep etcd root 2863 2764 1 05:36 ? 00:00:23 etcd --advertise-client-urls=https://10.178.0.2:2379 --cert-file=/etc/kubernetes/pki/etcd/server.crt --client-cert-auth=true --data-dir=/var/lib/etcd --initial-advertise-peer-urls=https://10.178.0.2:2380 --initial-cluster=master=https://10.178.0.2:2380 --key-file=/etc/kubernetes/pki/etcd/server.key --listen-client-urls=https://127.0.0.1:2379,https://10.178.0.2:2379 --listen-metrics-urls=http://127.0.0.1:2381 --listen-peer-urls=https://10.178.0.2:2380 --name=master --peer-cert-file=/etc/kubernetes/pki/etcd/peer.crt --peer-client-cert-auth=true --peer-key-file=/etc/kubernetes/pki/etcd/peer.key --peer-trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt --snapshot-count=10000 --trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt ν‘μ— λ“¤μ–΄κ°„ μ»¤λ§¨λ“λ΅ μ›ν•λ” λ¶€λ¶„μ„ κ°•μ΅°μ‹μΌ μ°Ύλ”λ°©λ²•μ„ μ¶”μ²λ“λ¦½λ‹λ‹¤. λμ•κµ΄λ ¤μ„ μ°Ύλ”κ²ƒλ³΄λ‹¤ ν›¨μ”¬ λΉ λ¥΄λ”λΌκµ¬μ” etcdctl λ…λ Ή μµμ… etcd ν”„λ΅μ„Έμ¤ μ‹¤ν–‰μµμ… κ°’ μ»¤λ§¨λ“λ΅ λΉ¨λ¦¬μ°ΎκΈ° --cacert --trusted-ca-file /etc/kubernetes/pki/etcd/ca.crt ps -ef | grep etcd | grep trusted --cert --cert-file /etc/kubernetes/pki/etcd/server.crt ps -ef | grep etcd | grep &quot;\--cert&quot; --key --key-file /etc/kubernetes/pki/etcd/server.key ps -ef | grep etcd | grep &quot;\--key&quot; κ·Έλ¦¬κ³  κ°’ λ¶€λ¶„μ€ ν•­μƒ κ°™μ€κ²ƒμ΄ μ•„λ‹ μλ„ μκΈ°μ— μ»¤λ§¨λ“λ΅ μ§μ ‘ ν™•μΈν•μ…”μ•Ό ν•©λ‹λ‹¤. μ μ΄μ  μ¤λƒ…μƒ·μ„ μƒμ„±ν•κΈ°μ„ν•μ—¬ μ°μ„  λ£¨νΈκ³„μ •μΌλ΅ μ „ν™ν•΄μ¤λ‹λ‹¤ $ sudo -i μ•„λμ™€ κ°™μ΄ ν™κ²½λ³€μλ¥Ό λ“±λ΅ν•΄μ¤λ‹λ‹¤ ETCDCTL_API 3λ²„μ „μ„ μ‚¬μ©ν•κΈ° μ„ν•¨μ…λ‹λ‹¤. root# export ETCDCTL_API=3 root# etcdctl --cacert=/etc/kubernetes/pki/etcd/ca.crt \ &amp;gt; --cert=/etc/kubernetes/pki/etcd/server.crt \ &amp;gt; --key=/etc/kubernetes/pki/etcd/server.key \ &amp;gt; snapshot save /opt/backup Snapshot saved at /opt/backup μ¤λƒ…μƒ·μ„ μƒμ„±ν•μ€μΌλ‹ μ•„κΉ λ°°ν¬ν•μ€λ deployment λ¥Ό deleteν•κ³  etcdctl λ³µκµ¬λ¥Όν•μ—¬ μ •λ§ λ™μ‘ν•λ deploymentλ¥Ό λ‹¤μ‹ λ°°ν¬ν•΄μ£Όλ”μ§€ ν™•μΈν•΄λ΄…μ‹λ‹¤ μ°μ„  λ£¨νΈκ³„μ •μ—μ„ λ΅κ·Έμ•„μ›ƒ ν•΄μ£Όμ‹κµ¬μ” root# exit logout deploymentλ¥Ό μ‚­μ μ‹μΌμ¤λ‹λ‹¤. $ kubectl delete -f depl.yml deployment.apps &quot;myapp-deployment&quot; deleted λ³µκµ¬ν•κΈ°λ΅ λ„μ–΄κ°‘λ‹λ‹¤. μ¤λƒ…μƒ·μΌλ΅ λ³µκµ¬ν•κΈ° λ³µκµ¬ν• λ•λ” μ¤λƒ…μƒ·μ„ λ§λ“¤λ• λ„£μ—λ μµμ…μ—μ„ λ„¤κ°€μ§€μ μµμ…μ΄ λ” μ¶”κ°€λ©λ‹λ‹¤. etcdctl λ…λ Ή μµμ… etcd ν”„λ΅μ„Έμ¤ μ‹¤ν–‰μµμ… κ°’ μ»¤λ§¨λ“λ΅ λΉ¨λ¦¬μ°ΎκΈ° --cacert --trusted-ca-file /etc/kubernetes/pki/etcd/ca.crt ps -ef | grep etcd | grep trusted --cert --cert-file /etc/kubernetes/pki/etcd/server.crt ps -ef | grep etcd | grep &quot;\--cert&quot; --key --key-file /etc/kubernetes/pki/etcd/server.key ps -ef | grep etcd | grep &quot;\--key&quot; --initial-advertise-peer-urls --initial-advertise-peer-urls https://10.178.0.2:2380 ps -ef | grep etcd | grep initial --initial-cluster=master --initial-cluster=master https://10.178.0.2:2380 ps -ef | grep etcd | grep initial --data-dir --data-dir /var/lib/etcd_backup ps -ef | grep etcd | grep &quot;\--data-dir&quot; --name --name master(λ§μ¤ν„°λ…Έλ“μ΄λ¦„) ps -ef | grep etcd | grep &quot;\--name&quot; μ μ—¬κΈ°κΉμ§€κ°€ restore ν• λ• ν•„μ”ν• λ¨λ“  μµμ…μ…λ‹λ‹¤. μ΄μ  μ•„κΉ μ°μ–΄λ†¨λ μ¤λƒ…μƒ·μΌλ΅ λ³µκµ¬λλ”μ§€ ν™•μΈν•΄λ΄…μ‹λ‹¤. μ°μ„  λ£¨νΈ κ³„μ •μΌλ΅ μ „ν™ν•κµ¬μ” $ sudo -i restore λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•΄μ£Όκ³  λ΅κ·Έμ•„μ›ƒν•΄μ¤λ‹λ‹¤ root# etcdctl --cacert=/etc/kubernetes/pki/etcd/ca.crt \ &amp;gt; --cert=/etc/kubernetes/pki/etcd/server.crt \ &amp;gt; --key=/etc/kubernetes/pki/etcd/server.key \ &amp;gt; --initial-advertise-peer-urls=https://10.178.0.2:2380 \ &amp;gt; --initial-cluster=master=https://10.178.0.2:2380 \ &amp;gt; --data-dir=/var/lib/etcd_backup \ &amp;gt; --name=master \ &amp;gt; snapshot restore /opt/backup root# exit logout /opt/backup μ— μƒμ„±ν•΄λ’€λ μ¤λƒ…μƒ·μ„μ΄μ©ν•΄μ„ /var/lib μ„μΉμ— etcd_backup νμΌμ„ μƒμ„±ν•©λ‹λ‹¤ staticpodμ—μ„ μ‹¤ν–‰λλ” etcdκ°€ μ΄λ¥Ό λ°”λΌλ³΄λ„λ΅ ν•΄μ¤μ•Όν•κ² μ§€μ” staticpodμ μ„μΉμΈ /etc/kubernetes/manifestλ΅ μ΄λ™ν›„ etcd.yamlμ„ μμ •ν•΄μ•Όν•©λ‹λ‹¤ $ cd /etc/kubernetes/manifest $ sudo vim etcd.yaml ~~~yaml #etcd.yaml ...μ¤‘λµ volumes: - hostPath: path: /etc/kubernetes/pki/etcd type: DirectoryOrCreate name: etcd-certs - hostPath: path: /var/lib/etcd_backup &amp;lt;----------- backupν• μ¤λƒ…μƒ·μ„ λ°”λΌλ³΄κ² μμ •ν•΄μ¤λ‹λ‹¤ type: DirectoryOrCreate name: etcd-data ... λ³€κ²½μ‚¬ν•­μ„ μ €μ¥ν•΄μ£Όλ©΄ μƒλ΅ λ΅λ“λ λ•κΉμ§€ μ‹κ°„μ΄ μ΅°κΈκ±Έλ¦½λ‹λ‹¤ μ μ‹ν›„ μ •λ§ μ‹¤ν–‰ μ¤‘μ΄λ deploymentκ°€ μ‹¤ν–‰μ¤‘μΈμ§€ ν™•μΈν•΄λ΄…μ‹λ‹¤ $ kubectl get deploy NAME READY UP-TO-DATE AVAILABLE AGE myapp-deployment 3/3 3 3 20s μ§μ”~ μ λ³µκµ¬λκ²ƒμ„ ν™•μΈν•  μ μμ—μµλ‹λ‹¤</summary></entry><entry><title type="html">[ #8 ] ν΄λ¬μ¤ν„° μ μ§€λ³΄μ</title><link href="https://shjeong92.github.io/2021/06/03/Learning-Kubernetes-08.html" rel="alternate" type="text/html" title="[ #8 ] ν΄λ¬μ¤ν„° μ μ§€λ³΄μ" /><published>2021-06-03T00:00:00+09:00</published><updated>2021-06-03T00:00:00+09:00</updated><id>https://shjeong92.github.io/2021/06/03/Learning-Kubernetes-08</id><content type="html" xml:base="https://shjeong92.github.io/2021/06/03/Learning-Kubernetes-08.html">&lt;p&gt;μ¤λμ€ ν΄λ¬μ¤ν„°μ μ μ§€λ³΄μμ— κ΄€λ ¨ν• ν¬μ¤νΈλ¥Ό μ¨λ³ΌκΉ ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μΏ λ²„λ„¤ν‹°μ¤λ¥Ό μ΄μ©ν•μ—¬ μ„λΉ„μ¤λ¥Ό κµ¬μ¶•ν•κ³ λ‚μ„ μ–Έμ  κ°€λ” μ‹μ¤ν…μ„ μ—…λ°μ΄νΈ μ‹μΌμ•Όν•  μΌμ΄ μƒκΈΈ κ²ƒμ΄λ©°, μ¤λ¥λ΅ μΈν•μ—¬ λ…Έλ“κ°€ λ¨Ήν†µμ΄ λλ”μΌλ„ μƒκΈΈ κ²ƒμ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ·Έλ ‡λ‹¤λ©΄ λ…Έλ“μ μ‘λ™μ„ μ¤‘μ§€μ‹ν‚¤λ©΄, λλ” μ¤λ¥λ΅ μ¤‘μ§€λλ‹¤λ©΄ μ–΄λ–»κ² λ κΉμ”?&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;master nodeμ kube-contoller-managerμ—λ” pod-eviction-timeoutμ΄ μ΅΄μ¬ν•©λ‹λ‹¤&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;μ»¨λ””μ…&quot;&gt;μ»¨λ””μ…&lt;/h2&gt;

&lt;p&gt;κ° λ…Έλ“μ—λ” μ•„λμ™€ κ°™μ΄ μ—¬λ¬κ°€μ§€ conditionμ΄ μ΅΄μ¬ν•©λ‹λ‹¤&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;λ…Έλ“ μ»¨λ””μ…&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;μ„¤λ…&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;strong&gt;Ready&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;λ…Έλ“κ°€ μƒνƒ μ–‘νΈν•λ©° νλ“λ¥Ό μμ©ν•  μ¤€λΉ„κ°€ λμ–΄ μλ” κ²½μ° True, λ…Έλ“μ μƒνƒκ°€ λ¶λ‰ν•μ—¬ νλ“λ¥Ό μμ©ν•μ§€ λ»ν•  κ²½μ° False, κ·Έλ¦¬κ³  λ…Έλ“ μ»¨νΈλ΅¤λ¬κ°€ λ§μ§€λ§‰ node-monitor-grace-period (κΈ°λ³Έκ°’ 40 κΈ°κ°„ λ™μ• λ…Έλ“λ΅λ¶€ν„° μ‘λ‹µμ„ λ°›μ§€ λ»ν• κ²½μ°) Unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;strong&gt;DiskPressure&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;λ””μ¤ν¬ μ‚¬μ΄μ¦ μƒμ— μ••λ°•μ΄ μλ” κ²½μ°, μ¦‰ λ””μ¤ν¬ μ©λ‰μ΄ λ„‰λ„‰μΉ μ•μ€ κ²½μ° True, λ°λ€μ κ²½μ° False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;strong&gt;MemoryPressure&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;λ…Έλ“ λ©”λ¨λ¦¬ μƒμ— μ••λ°•μ΄ μλ” κ²½μ°, μ¦‰ λ…Έλ“ λ©”λ¨λ¦¬κ°€ λ„‰λ„‰μΉ μ•μ€ κ²½μ° True, λ°λ€μ κ²½μ° False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;strong&gt;PIDPressure&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ν”„λ΅μ„Έμ¤ μƒμ— μ••λ°•μ΄ μλ” κ²½μ°, μ¦‰ λ…Έλ“ μƒμ— λ§μ€ ν”„λ΅μ„Έμ¤λ“¤μ΄ μ΅΄μ¬ν•λ” κ²½μ° True, λ°λ€μ κ²½μ° False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;strong&gt;NetworkUnavailable&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;λ…Έλ“μ— λ€ν•΄ λ„¤νΈμ›ν¬κ°€ μ¬λ°”λ¥΄κ² κµ¬μ„±λμ§€ μ•μ€ κ²½μ° True, λ°λ€μ κ²½μ° False&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;λν• λ…Έλ“ lifecycle controllerλ” μ»¨λ””μ…μ„ μ•„λμ™€ κ°™μ€ &lt;strong&gt;&lt;em&gt;built-in taint&lt;/em&gt;&lt;/strong&gt;λ¥Ό μλ™μΌλ΅ μƒμ„±ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;h3 id=&quot;built-in-taints&quot;&gt;built-in taints&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;node.kubernetes.io/not-ready: λ…Έλ“κ°€ μ¤€λΉ„λμ§€ μ•μ. μ΄λ” NodeCondition Ready κ°€ β€Falseβ€λ΅ λ¨μ— ν•΄λ‹Ή.&lt;/li&gt;
  &lt;li&gt;node.kubernetes.io/unreachable: λ…Έλ“κ°€ λ…Έλ“ μ»¨νΈλ΅¤λ¬μ—μ„ λ„λ‹¬ν•  μ μ—†μ. μ΄λ”  NodeCondition Ready κ°€ β€Unknownβ€λ΅ λ¨μ— ν•΄λ‹Ή.&lt;/li&gt;
  &lt;li&gt;node.kubernetes.io/memory-pressure: λ…Έλ“μ— λ©”λ¨λ¦¬ ν• λ‹Ή μ••λ°•μ΄ μμ.&lt;/li&gt;
  &lt;li&gt;node.kubernetes.io/disk-pressure: λ…Έλ“μ— λ””μ¤ν¬ ν• λ‹Ή μ••λ°•μ΄ μμ.&lt;/li&gt;
  &lt;li&gt;node.kubernetes.io/pid-pressure: λ…Έλ“μ— PID ν• λ‹Ή μ••λ°•μ΄ μμ.&lt;/li&gt;
  &lt;li&gt;node.kubernetes.io/network-unavailable: λ…Έλ“μ λ„¤νΈμ›ν¬λ¥Ό μ‚¬μ©ν•  μ μ—†μ.&lt;/li&gt;
  &lt;li&gt;node.kubernetes.io/unschedulable: λ…Έλ“λ¥Ό μ¤μΌ€μ¤„ν•  μ μ—†μ.&lt;/li&gt;
  &lt;li&gt;node.cloudprovider.kubernetes.io/uninitialized: β€μ™Έλ¶€β€ ν΄λΌμ°λ“ κ³µκΈ‰μλ΅ kubeletμ„ μ‹μ‘ν•λ©΄, μ΄ ν…μΈνΈκ°€ λ…Έλ“μ—μ„ μ‚¬μ© λ¶κ°€λ¥μΌλ΅ ν‘μ‹λλ„λ΅ μ„¤μ •λ¨.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;κ·Έ μ¤‘μ—μ„λ„ &lt;code&gt;ready&lt;/code&gt; μ»¨λ””μ…μ€ μΆ€ νΉλ³„ν•λ°μ”. 
ready μ»¨λ””μ…μ μƒνƒκ°€ pod-eviction-timeout (kube-controller-managerμ— μ „λ‹¬λ μΈμ) λ³΄λ‹¤ λ” κΈΈκ² Unknown λλ” Falseλ΅ μ μ§€λλ” κ²½μ°, λ…Έλ“ μƒμ— λ¨λ“  νλ“λ” λ…Έλ“ μ»¨νΈλ΅¤λ¬μ— μν•΄ μ‚­μ λλ„λ΅ μ¤μΌ€μ¤„ λ©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;ν΄λΌμ°λ“-μ»¨νΈλ΅¤λ¬-κ΄€λ¦¬μμ μ»¨νΈλ΅¤λ¬κ°€ μ΄ λ…Έλ“λ¥Ό μ΄κΈ°ν™”ν•λ©΄, kubeletμ΄ μ΄ ν…μΈνΈλ¥Ό μ κ±°ν•©λ‹λ‹¤ μ¦‰ λ‹¤μ‹ podκ°€ λ°°μ •λ  μ μλ” μƒνƒκ°€ λλ”κ²ƒμ΄μ£ . κΈ°λ³Έ μ¶•μ¶ νƒ€μ„μ•„μ›ƒ κΈ°κ°„μ€ κΈ°λ³Έ 5λ¶„μΌλ΅ μ„¤μ •λμ–΄ μμµλ‹λ‹¤. λ§μ•½ λ…Έλ“κ°€ λ‹¤μ΄λμ—λ‹¤κ°€ 5λ¶„μ•μ— λ³µκµ¬κ°€ λμ—λ‹¤λ©΄ λ…Έλ“ λ‚΄μ podλ“¤μ€ κ·Έλ€λ΅ μ΅΄μ¬ν•μ§€λ§, μ„¤μ •λ νƒ€μ„μ•„μ›ƒ μ‹κ°„μ„ μ΄κ³Όν•λ‹¤λ©΄ κ·Έμ•μ νλ“λ“¤μ€ λ¨λ‘ μ¤‘λ‹¨ λλ”κ²ƒμ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ§μ•½ μμ •ν•κ³  μ‹¶λ‹¤λ©΄ λ§μ¤ν„° λ…Έλ“μ kube-system λ„¤μ„μ¤νμ΄μ¤μ— μλ” kube-controller-manager-masterμ„ editν•΄μ£Όλ©΄λ©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ·Έλ°λ° λ§μ΄μ£  μ΄ podλ” static podμ…λ‹λ‹¤. 
&lt;a href=&quot;https://shjeong92.github.io/2021/05/31/Learning-Kubernetes-06.html&quot;&gt;6λ²μ§Έ ν¬μ¤νΈ&lt;/a&gt;μ—μ„ μ„¤λ… ν–μ—λ”λ° static pod λ¥Ό μμ •ν•λ ¤λ©΄ 
static podμ„ μƒμ„±ν• yamlνμΌ μμ²΄λ¥Ό μμ •ν•λ‹¤κ³  ν–μ—μ£ ?&lt;/p&gt;

&lt;p&gt;static podμ μ„μΉλ¥Ό μ°Ύλ”κ²ƒ λ¶€ν„° λ³µμµν•΄λ΄…μ‹λ‹¤&lt;/p&gt;

&lt;p&gt;μ°μ„  config.yamlνμΌμ μ„μΉλ¥Ό μ°Ύμ•„μ¤λ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps &lt;span class=&quot;nt&quot;&gt;-ef&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;kubelet | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-config&quot;&lt;/span&gt;

root     10476     1  3 May28 ?        05:09:26 /usr/bin/kubelet &lt;span class=&quot;nt&quot;&gt;--bootstrap-kubeconfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/bootstrap-kubelet.conf &lt;span class=&quot;nt&quot;&gt;--kubeconfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/kubelet.conf &lt;span class=&quot;nt&quot;&gt;--config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/kubelet/config.yaml &lt;span class=&quot;nt&quot;&gt;--network-plugin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cni &lt;span class=&quot;nt&quot;&gt;--pod-infra-container-image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;k8s.gcr.io/pause:3.4.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;config.yamlνμΌ λ‚΄μ—μ„ staticpathλ¥Ό μ°Ύμ•„λƒ…μ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; static /var/lib/kubelet/config.yaml
staticPodPath: /etc/kubernetes/manifests
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;staticPodPathλ΅ μ΄λ™ν›„ λ­κ°€μλ‚ ν™•μΈν•΄λ΄…λ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /etc/kubernetes/manifests

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;etcd.yaml  kube-apiserver.yaml  kube-controller-manager.yaml  kube-scheduler.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ μ΄μ  μ΄ yamlνμΌμ„ μμ •ν•λ©΄ λ©λ‹λ‹¤.
μ €λ” μ΄ κΈ°λ³Έ 5λ¶„μΈ eviction-timeoutμ„ 60μ΄λ΅ λ°”κΎΈμ–΄ λ³΄κ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;commandμ— &lt;code&gt;--pod-eviction-timeout=60s&lt;/code&gt; μµμ…μ„ μ¶”κ°€ν•΄ μ¤μΌλ΅μ¨ λ§μ΄μ£ .&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;v1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Pod&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;annotations&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;kubernetes.io/config.hash&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;47cace34a635d6f3e305eee20e0e7b30&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;kubernetes.io/config.mirror&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;47cace34a635d6f3e305eee20e0e7b30&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;kubernetes.io/config.seen&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;2021-05-28T03:40:42.961803243Z&quot;&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;kubernetes.io/config.source&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;file&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;creationTimestamp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;2021-05-28T03:40:55Z&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;component&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;kube-controller-manager&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;tier&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;control-plane&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;kube-controller-manager-master&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;kube-system&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;ownerReferences&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;v1&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;controller&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Node&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;master&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;69f4d243-9420-45a9-928e-672a1d3b977a&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;resourceVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;478&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;4cfad35d-8664-42cf-9ed9-5fd5b4d771a4&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;kube-controller-manager&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--allocate-node-cidrs=true&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--pod-eviction-timeout=60s&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;#&amp;lt;----------- ν•΄λ‹ΉλΌμΈμ„ μ¶”κ°€ν•λ©΄ μ΄μ  5λ¶„μ΄μ•„λ‹ 60μ΄λ΅ λ³€κ²½λ©λ‹λ‹¤.&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--authentication-kubeconfig=/etc/kubernetes/controller-manager.conf&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--authorization-kubeconfig=/etc/kubernetes/controller-manager.conf&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--bind-address=127.0.0.1&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--client-ca-file=/etc/kubernetes/pki/ca.crt&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--cluster-cidr=10.244.0.0/16&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--cluster-name=kubernetes&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--cluster-signing-cert-file=/etc/kubernetes/pki/ca.crt&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--cluster-signing-key-file=/etc/kubernetes/pki/ca.key&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--controllers=*,bootstrapsigner,tokencleaner&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--kubeconfig=/etc/kubernetes/controller-manager.conf&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--leader-elect=true&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--port=0&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--requestheader-client-ca-file=/etc/kubernetes/pki/front-proxy-ca.crt&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--root-ca-file=/etc/kubernetes/pki/ca.crt&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--service-account-private-key-file=/etc/kubernetes/pki/sa.key&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--service-cluster-ip-range=10.96.0.0/12&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;--use-service-account-credentials=true&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;k8s.gcr.io/kube-controller-manager:v1.21.1&lt;/span&gt;

&lt;span class=&quot;s&quot;&gt;...μ¤‘λµ&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;μ €μ¥ν•΄μ£Όλ©΄ λ©μ·„λ‹¤κ°€&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kube-controller-manager-master    0/1     Running   0          3s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;μµμ…μ„ μ μ©μ‹μΌ podμ‹ μ¬μ‹λ™λ©λ‹λ‹¤~&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kube-controller-manager-master    1/1     Running   0          3s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;eviction-timeoutμ-μ΅΄μ¬μ΄μ &quot;&gt;eviction timeoutμ μ΅΄μ¬μ΄μ ?&lt;/h2&gt;
&lt;p&gt;μ„μ—μ„ eviction timeoutμ κ°’μ„ λ°”κΎΈλ” μ‹¤μµμ„ ν•΄λ³΄μ•λ”λ°μ” μ΄ timeoutμ€ λ¬΄μ—‡κ³Ό μ—°κ΄€μ΄ μλ”μ§€ λ‘κ°€μ§€ μΌ€μ΄μ¤λ¥Ό ν†µν•΄μ„ μ•μ•„λ³΄κ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;case1: nodeκ°€ λ¨Ήν†µμ΄ λμ—λ‹¤κ°€ μ„¤μ •ν•΄λ†“μ€ eviction-timeoutλ³΄λ‹¤ μ§¦μ€μ‹κ°„μ•μ— λ³µκµ¬λκ²½μ°&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;λ…Έλ“λ‚΄μ— μλ podλ“¤μ΄ kubectlμ— μν•΄ λ‹¤μ‹ ν•΄λ‹Ήλ…Έλ“μ—μ„ μ¬μ‹μ‘λ©λ‹λ‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;case2: nodeκ°€ λ¨Ήν†µμ΄ λν›„ eviction-timeoutμ„ μ΄κ³Όν•κ²½μ°&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;ν•΄λ‹Ή λ…Έλ“μ—μλ” podλ“¤μ„ λ¨λ‘ μ¶•μ¶ν• ν›„μ— λ…Έλ“κ°€ μ¬μ‹λ™λ©λ‹λ‹¤.&lt;/li&gt;
      &lt;li&gt;ν•΄λ‹Ή λ…Έλ“μ—μλ podμ΄ replicasetμ„ ν†µν•΄ μƒμ„±λμ—λ‹¤λ©΄ λ‹¤μ‹ λ‹¤λ¥Έλ…Έλ“μ— μ μƒμ„±μ΄ λκ² μ§€λ§, μΌλ° podμ΄λΌλ©΄ λ‹¤μ‹ μ‚΄μ•„λ‚μ§€ λ»ν• κ²λ‹λ‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;λ…Έλ“κ΄€λ ¨-λ…λ Ήμ–΄&quot;&gt;λ…Έλ“κ΄€λ ¨ λ…λ Ήμ–΄&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code&gt; kubectl drain node &lt;/code&gt;
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl drain node
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;ν•΄λ‹Ή λ…Έλ“μ—μλ” podλ“¤μ„ μΆ…λ£μ‹ν‚¤κ³ , λ‹¤λ¥Έλ…Έλ“μ— μ¬μ‹μ‘μ‹ν‚µλ‹λ‹¤ (graceful node shutdown) λν• ν•΄λ‹Ή λ…Έλ“λ¥Ό unschedulableν•κ² λ§λ“ λ‹¤.&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;kubernetesμ λ²„μ „ λλ” λ¦¬λ…μ¤ μ»¤λ„λ“±μ μ—…κ·Έλ μ΄λ“ν•  λ• μ‚¬μ©ν•  μ μκ² μµλ‹λ‹¤(kubeadm, kubelet, kubectl, β€¦)&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code&gt; kubectl cordon node &lt;/code&gt;
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl cordon node
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;ul&gt;
      &lt;li&gt;ν•΄λ‹Ή λ…Έλ“λ¥Ό unschedulableν•κ² λ§λ“­λ‹λ‹¤&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;μ‹¤ν–‰ μ¤‘μΈ Podλ¥Ό μ¶•μ¶ν•μ§€λ” μ•μµλ‹λ‹¤&lt;/strong&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code&gt; kubectl uncordon node &lt;/code&gt;
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl uncordon node
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;ul&gt;
      &lt;li&gt;ν•΄λ‹Ή λ…Έλ“λ¥Ό schedulableν•κ² λ§λ“ λ‹¤&lt;/li&gt;
      &lt;li&gt;μ—…κ·Έλ μ΄λ“λ¥Ό λ§μΉ λ…Έλ“λ¥Ό μ¤μΌ€μ¥΄λ¬λΈ”ν•κ² λ§λ“­λ‹λ‹¤ (taintλ¥Ό μ κ±°)&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;drainλ…λ Ήμ— μν•΄μ„ μ§‘λ‚κ°„ podλ“¤μ΄ λ‹¤μ‹ μ§‘μ„ μ°Ύμ•„μ¤μ§„ μ•μµλ‹λ‹¤.&lt;/strong&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;μΏ λ²„λ„¤ν‹°μ¤-λ²„μ „-λ°-λ²„μ „μ°¨μ΄-μ§€μ›&quot;&gt;μΏ λ²„λ„¤ν‹°μ¤ λ²„μ „ λ° λ²„μ „μ°¨μ΄ μ§€μ›&lt;/h2&gt;

&lt;h3 id=&quot;λ²„μ „&quot;&gt;λ²„μ „&lt;/h3&gt;
&lt;p&gt;μΏ λ²„λ„¤ν‹°μ¤ λ²„μ „μ€ x.y.zλ΅ ν‘ν„λλ”λ°, μ—¬κΈ°μ„ xλ” λ©”μ΄μ € λ²„μ „, yλ” λ§μ΄λ„ λ²„μ „, zλ” μ‹λ§¨ν‹± λ²„μ „ μ©μ–΄μ— λ”°λ¥Έ ν¨μΉ λ²„μ „μ…λ‹λ‹¤.
kubernetesμ—λ” μ—¬λ¬κ°€μ§€ μ»΄ν¬λ„νΈκ°€ μμµλ‹λ‹¤.
κ°κ°μ λ²„μ „μ€ μ „λ¶€ λ™μΌν•΄μ•Όν• κΉμ”? μ•„λ‹™λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;kube-apiserverμ λ²„μ „μ΄ μ£Όμ¶•μ΄λκ³ , λ‚λ¨Έμ§€ μ»΄ν¬λ„νΈλ” κ°κ° λ‹¤λ¥΄κ² ν• λ‘λ‹¨κ³„ λ²„μ „μ΄ λ‚®κ±°λ‚ κ°™μ•„λ„ μƒκ΄€μ΄ μ—†μµλ‹λ‹¤. νΉλ³„ν•κ² &lt;strong&gt;kubectl&lt;/strong&gt;μ κ²½μ°λ” kube-apiserverμ λ²„μ „λ³΄λ‹¤ ν•λ‹¨κ³„ λ†’μ€κ²½μ°λ„ μ§€μ›μ΄ λ©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ” μμ„Έν• λ‚΄μ©μ€ &lt;a href=&quot;https://kubernetes.io/ko/docs/setup/release/version-skew-policy/&quot;&gt;κ³µμ‹λ¬Έμ„&lt;/a&gt;μ—μ„ ν™•μΈκ°€λ¥ ν•©λ‹λ‹¤&lt;/p&gt;

&lt;h2 id=&quot;ν΄λ¬μ¤ν„°-μ—…κ·Έλ μ΄λ“&quot;&gt;ν΄λ¬μ¤ν„° μ—…κ·Έλ μ΄λ“&lt;/h2&gt;

&lt;p&gt;kubernetsλ” latestλ²„μ „λ¶€ν„° λ‘λ‹¨κ³„ λ‚®μ€λ²„μ „κΉμ§€ μ„λΉ„μ¤λ¥Ό μ§€μ›ν•λ”λ°μ”, λ§μ•½μ— ν„μ¬ 1.19λ²„μ „μ„ μ‚¬μ©ν•κ³  μλ”λ° 1.22λ²„μ „μ΄ μ¶μ‹ λλ‹¤λ©΄ μ—…κ·Έλ μ΄λ“λ¥Ό ν•΄μ•Όκ² μ£ .&lt;/p&gt;

&lt;p&gt;κ·Έλ ‡λ‹¤λ©΄ 1.19λ²„μ „μ—μ„ ν•λ²μ— 1.22λ²μΌλ΅ μ—…κ·Έλ μ΄λ“ μ‹ν‚¤λ©΄λ κΉμ”? μ¶”μ²λλ” λ°©λ²•μ— μν•λ©΄
ν•λ‹¨κ³„ ν•λ‹¨κ³„μ”© μ°¨λ΅€μ°¨λ΅€λ΅ μ—…κ·Έλ μ΄λ“ ν•΄μ•Όλλ‹¤κ³  ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;h3 id=&quot;μ—…κ·Έλ μ΄λ“-λ°©λ²•&quot;&gt;μ—…κ·Έλ μ΄λ“ λ°©λ²•&lt;/h3&gt;

&lt;p&gt;μΏ λ²„λ„¤ν‹°μ¤ ν™κ²½μ„ μ–΄λ–»κ² κµ¬μ„±ν•μ€λ”κ°€μ— λ”°λΌ μ—…κ·Έλ μ΄λ“ λ°©λ²•μ΄ λ‹¤μ–‘ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;κµ¬κΈ€μ GKE, AWSμ EKSλ“±μ kuberneteλ¥Ό μ§€μ›ν•λ” cloudμ κ²½μ°&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;κ°„λ‹¨ν• ν΄λ¦­ λ‡λ²μΌλ΅ μ—…κ·Έλ μ΄λ“ κ°€λ¥&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;The hard wayλ΅ μ„¤μΉν•κ²½μ°&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;ν•λ•€ν•λ•€ μ„¤μΉν• κ²ƒμ²λΌ μ—…κ·Έλ μ΄λ“ λν• ν•λ•€ν•λ•€ ν•΄μ•Όν•©λ‹λ‹¤&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;μ €λ” &lt;strong&gt;kubeadm&lt;/strong&gt;μ„ μ΄μ©ν•μ—¬ kubernetesν™κ²½μ„ κµ¬μ¶•ν•μ€κ³ , &lt;strong&gt;kubeadm&lt;/strong&gt;μ„ ν†µν• μ—…κ·Έλ μ΄λ“ λ°©λ²•μ— λ€ν•΄ μμ„Έν μ„¤λ…ν•΄ λ³΄κ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ €μ μΏ λ²„λ„¤ν‹°μ¤ ν™κ²½μ€ ν•κ°μ masterλ…Έλ“, 3κ°μ workerλ…Έλ“λ΅ κµ¬μ„±λμ–΄μμµλ‹λ‹¤. 1.20λ²„μ „μ„ μ΄μ©ν•κ³  μλ”λ° 1.21λ²„μ „μΌλ΅ μ—…κ·Έλ μ΄λ“ ν•΄λ³΄κ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;h3 id=&quot;step1---λ§μ¤ν„°-λ…Έλ“μ—-kubeadm-μ—…κ·Έλ μ΄λ“-μ‹ν‚¤κΈ°&quot;&gt;STEP1 - λ§μ¤ν„° λ…Έλ“μ— kubeadm μ—…κ·Έλ μ΄λ“ μ‹ν‚¤κΈ°.&lt;/h3&gt;

&lt;p&gt;λ§μ¤ν„° λ…Έλ“μ— μ ‘μ†ν•©λ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh gcloud
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ssh config&lt;/strong&gt;μ— μ„¤μ •μ„ ν•΄λ†¨κΈ°μ— μ΄λ ‡κ² κ°„λ‹¨ν•κ² μ ‘μ†κ°€λ¥ν•©λ‹λ‹¤. &lt;strong&gt;ssh config μ„¤μ •λ°©λ²•&lt;/strong&gt;μ΄ κ¶κΈν•μ‹λ©΄ &lt;a href=&quot;https://shjeong92.github.io/2021/06/01/Handling-ssh-config.html&quot;&gt;μ—¬κΈ°&lt;/a&gt;λ΅ μ΄λ™ν•μ„Έμ”.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;κ·Έλ¦¬κ³   kubernetesν™κ²½μ„ κµ¬μ¶•ν• λ• holdμ‹μΌλ†¨μ—λ kubeadmμ„ unholdμ‹μΌμ£Όκ³ , apt-get μƒ‰μΈ μ—…λ°μ΄νΈν›„, kubeadmμ„ μ—…λ°μ΄νΈ ν•λ‹¤μ λ‹¤μ‹ kubeadmμ„ holdμ‹μΌ μ¤„κ²λ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 1.21.x-00μ—μ„ xλ¥Ό μµμ‹  ν¨μΉ λ²„μ „μΌλ΅ λ°”κΏ‰λ‹λ‹¤&lt;/span&gt;
apt-mark unhold kubeadm &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
apt-get update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;kubeadm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1.21.x-00 &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
apt-mark hold kubeadm

&lt;span class=&quot;c&quot;&gt;#λ²„μ „ ν™•μΈν•΄μ£ΌκΈ°&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubeadm version
kubeadm version: &amp;amp;version.Info&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Major:&lt;span class=&quot;s2&quot;&gt;&quot;1&quot;&lt;/span&gt;, Minor:&lt;span class=&quot;s2&quot;&gt;&quot;21&quot;&lt;/span&gt;, GitVersion:&lt;span class=&quot;s2&quot;&gt;&quot;v1.21.1&quot;&lt;/span&gt;, GitCommit:&lt;span class=&quot;s2&quot;&gt;&quot;5e58841cce77d4bc13713ad2b91fa0d961e69192&quot;&lt;/span&gt;, GitTreeState:&lt;span class=&quot;s2&quot;&gt;&quot;clean&quot;&lt;/span&gt;, BuildDate:&lt;span class=&quot;s2&quot;&gt;&quot;2021-05-12T14:17:27Z&quot;&lt;/span&gt;, GoVersion:&lt;span class=&quot;s2&quot;&gt;&quot;go1.16.4&quot;&lt;/span&gt;, Compiler:&lt;span class=&quot;s2&quot;&gt;&quot;gc&quot;&lt;/span&gt;, Platform:&lt;span class=&quot;s2&quot;&gt;&quot;linux/amd64&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;apt-mark unhold&lt;/strong&gt;μ™€ &lt;strong&gt;apt-mark hold&lt;/strong&gt; ν•΄μ£Όλ” μ΄μ λ” kubeadmμ„ μ—…κ·Έλ μ΄λ“ν•λ©΄ μ„¤μΉμ‹ kubeletκ³Ό κ°™μ€ λ‹¤λ¥Έ κµ¬μ„± μ”μ†κ°€ κΈ°λ³Έμ μΌλ΅ μµμ‹  λ²„μ „ μΌλ΅ μλ™μΌλ΅ μ—…κ·Έλ μ΄λ“λκΈ° λ•λ¬Έμ…λ‹λ‹¤. (kubernetesλ” μ—¬λ¬λ²„μ „μ„ ν•κΊΌλ²μ— μ—…κ·Έλ μ΄λ“ κ¶μ¥ν•μ§€ μ•κΈ°λ•λ¬Έμ…λ‹λ‹¤!) μ΄λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ λ³΄λ¥λ¥Ό μ‚¬μ©ν•μ—¬ ν¨ν‚¤μ§€λ¥Ό λ³΄λ¥ λ κ²ƒμΌλ΅ ν‘μ‹ν•μ—¬ ν¨ν‚¤μ§€κ°€ μλ™μΌλ΅ μ„¤μΉ, μ—…κ·Έλ μ΄λ“ λλ” μ κ±°λμ§€ μ•λ„λ΅ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;h3 id=&quot;step2---μ—…κ·Έλ μ΄λ“-μ •λ³΄-ν™•μΈν•κΈ°&quot;&gt;STEP2 - μ—…κ·Έλ μ΄λ“ μ •λ³΄ ν™•μΈν•κΈ°&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubeadm upgrade plan

...

COMPONENT            CURRENT AVAILABLE

API Server           v1.20.0 v1.21.1

Controller Manager   v1.20.0 v1.21.1

Scheduler            v1.20.0 v1.21.1

Kube Proxy           v1.20.0 v1.21.1

...

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;step3---μ—…κ·Έλ μ΄λ“-μ μ©μ‹ν‚¤κΈ°&quot;&gt;STEP3 - μ—…κ·Έλ μ΄λ“ μ μ©μ‹ν‚¤κΈ°&lt;/h3&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubeadm upgrade plan apply v1.21.1
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;μ΅°κΈ μ¤λκ±Έλ¦΄ μλ„ μμµλ‹λ‹¤&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

μ•„λμ™€κ°™μ΄λ¨λ©΄ μ„±κ³µ
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;upgrade/successful] SUCCESS! Your cluster was upgraded to &lt;span class=&quot;s2&quot;&gt;&quot;v1.21.1&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Enjoy!

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;upgrade/kubelet] Now that your control plane is upgraded, please proceed with upgrading your kubelets &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;you haven&lt;span class=&quot;s1&quot;&gt;&apos;t already done so.
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;step4---node-drainν›„-kubelet-kubectl-μ—…λ°μ΄νΈν›„-μ¬μ‹μ‘ν•κΈ°&quot;&gt;STEP4 - node drainν›„ kubelet, kubectl μ—…λ°μ΄νΈν›„ μ¬μ‹μ‘ν•κΈ°&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#λ…Έλ“ λ“λ μΈν•κΈ°(λ¨λ“  pod μΆ…λ£ν›„ λ‹¤λ¥Έλ…Έλ“μ— μƒλ΅ μ‹¤ν–‰ν•κΈ° λ° ν•΄λ‹Ήλ…Έλ“ unschedulableν•κ² λ§λ“¬)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl drain &amp;lt;node-to-drain&amp;gt; &lt;span class=&quot;nt&quot;&gt;--ignore-daemonsets&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-mark unhold kubelet kubectl &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-get update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;kubelet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1.21.1-00 &lt;span class=&quot;nv&quot;&gt;kubectl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1.21.1-00 &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-mark hold kubelet kubectl

&lt;span class=&quot;c&quot;&gt;#μ„¤μ • μμ •μ‚¬ν•­ μ¬λ΅λ”©&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl daemon-reload
&lt;span class=&quot;c&quot;&gt;#kubelet μ¬μ‹μ‘&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl restart kubelet

&lt;span class=&quot;c&quot;&gt;#μ—…λ°μ΄νΈκ°€ λλ‚¬μΌλ―€λ΅ λ‹¤μ‹ schedulableν•κ² λ§λ“¤μ–΄μ£ΌκΈ°&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl uncordon &amp;lt;node-to-uncordon&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ—¬κΈ°κΉμ§€κ°€ λ§μ¤ν„°λ…Έλ“μ μ—…κ·Έλ μ΄λ“ λ°©λ²•μ΄μ—μµλ‹λ‹¤.&lt;/p&gt;

&lt;hr /&gt;
&lt;h1 id=&quot;rocket-μ—¬κΈ°μ„λ¶€ν„°λ”-μ›μ»¤λ…Έλ“λ“¤μ„-μ—…κ·Έλ μ΄λ“-ν•©λ‹λ‹¤&quot;&gt;:rocket: μ—¬κΈ°μ„λ¶€ν„°λ” μ›μ»¤λ…Έλ“λ“¤μ„ μ—…κ·Έλ μ΄λ“ ν•©λ‹λ‹¤.&lt;/h1&gt;

&lt;h3 id=&quot;step5---μ›μ»¤-λ…Έλ“μ—-kubeadm-μ„¤μΉν•κΈ°&quot;&gt;STEP5 - μ›μ»¤ λ…Έλ“μ— kubeadm μ„¤μΉν•κΈ°&lt;/h3&gt;

&lt;p&gt;μ°μ„  3κ°μ μ›μ»¤λ…Έλ“μ¤‘ ν•λ‚μΈ worker-1μ— μ ‘μ†ν•©λ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh worker-1 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;κ·Έ λ‹¤μ, λ§μ¤ν„°λ…Έλ“μ— μ„¤μΉν–λκ³Ό κ°™μ€λ°©λ²•μΌλ΅ kubeadmλ¥Ό μ„¤μΉν•©λ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-mark unhold kubeadm &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-get update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;kubeadm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1.21.x-00 &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-mark hold kubeadm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ•„κΉ λ§μ¤ν„°λ…Έλ“μ—μ„ μ•„λμ μ»¤λ§¨λ“λ¥Ό μ΄μ©ν•΄ upgradeκ°€λ¥ λ²„μ „μ„ ν™•μΈν•κ³  v1.21.1λ΅ applyν–μ—μµλ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubeadm upgrade plan
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubeadm upgrade apply v1.21.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ν•μ§€λ§ μ›μ»¤λ…Έλ“μ—μ„λ” μ•„λμ μ»¤λ§¨λ“λ¥Ό μ΄μ©ν•μ—¬ ν΄λ¬μ¤ν„°μ—μ„ kubeadm ClusterConfiguration μ„ κ°€μ Έμ¤λ©°,
μ΄ λ…Έλ“μ kubelet κµ¬μ„±μ„ μ—…κ·Έλ μ΄λ“ ν•©λ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubeadm upgrade node
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;κ·Έλ¦¬κ³  λ§μ¤ν„° λ…Έλ“λ΅ μ΄λ™ν•μ—¬ μ—…κ·Έλ μ΄λ“ ν•  μ›μ»¤λ…Έλ“λ¥Ό λ“λ μΈ ν•΄μ¤λ‹λ‹¤. (λ§μ¤ν„° λ…Έλ“μ—μ„ μ›μ»¤λ…Έλ“λ΅ μ ‘μ†ν–μ—κΈ°μ— μ ‘μ† μΆ…λ£ν•λ©΄ λ§μ¤ν„°λ…Έλ“λ΅ μ΄λ™ν•©λ‹λ‹¤.)&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit
logout
&lt;/span&gt;Connection to 10.128.0.5 closed.

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl drain worker-1 &lt;span class=&quot;nt&quot;&gt;--ignore-daemonsets&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;step6---μ›μ»¤λ…Έλ“μ-kubelet-λ°-kubectl-μ—…κ·Έλ μ΄λ“&quot;&gt;STEP6 - μ›μ»¤λ…Έλ“μ kubelet λ° kubectl μ—…κ·Έλ μ΄λ“&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# λ‹¤μ‹ μ›μ»¤λ…Έλ“λ΅ μ ‘μ†ν•κΈ°&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh worker-1
 

&lt;span class=&quot;c&quot;&gt;# kubectl κ³Ό kubelet μ—…λ°μ΄νΈν•κΈ°&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-mark unhold kubectl kubelet &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-get update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;kubectl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1.21.1-00 &lt;span class=&quot;nv&quot;&gt;kubelet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1.21.1-00 &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-mark hold kubectl kubelet
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;step7---kubelet-λ‹¤μ‹-μ‹μ‘ν•κΈ°&quot;&gt;STEP7 - kubelet λ‹¤μ‹ μ‹μ‘ν•κΈ°&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl daemon-reload
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl restart kubelet
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;step8---cordon-ν•΄μ¬ν•κΈ°&quot;&gt;STEP8 - cordon ν•΄μ¬ν•κΈ°&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#λ§μ¤ν„°λ…Έλ“λ΅ μ΄λ™ν•κΈ°&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl uncordon worker-1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;step9---λ°λ³µν•κΈ°&quot;&gt;STEP9 - λ°λ³µν•κΈ°&lt;/h3&gt;

&lt;p&gt;μ—…κ·Έλ μ΄λ“ ν•  μ›μ»¤λ…Έλ“μ—
STEP5 ~ STEP8μ„ λ‘κ°™μ΄ μ§„ν–‰ν•΄μ¤λ‹λ‹¤&lt;/p&gt;

&lt;p&gt;λ§μ§€λ§‰μΌλ΅ μ—…λ°μ΄νΈκ°€ μ λμ—λ”μ§€ ν™•μΈν•΄μ¤λ‹λ‹¤&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl get nodes
NAME         STATUS   ROLES                  AGE    VERSION
master       Ready    control-plane,master   6d8h   v1.21.1
worker-1     Ready    &amp;lt;none&amp;gt;                 6d8h   v1.21.1
worker-2     Ready    &amp;lt;none&amp;gt;                 6d8h   v1.21.1
worker-3     Ready    &amp;lt;none&amp;gt;                 6d8h   v1.21.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;λ²„μ „μ΄ v1.21.1λ΅ μ μ—…κ·Έλ μ΄λ“ λκ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.&lt;/p&gt;</content><author><name>Sanghyuk Jeong</name><email>shjeong920522@gmail.com</email></author><category term="Kubernetes" /><category term="maintenance" /><category term="static" /><category term="pod" /><category term="strategy" /><category term="μΏ λ²„λ„¤ν‹°μ¤" /><category term="update" /><summary type="html">μ¤λμ€ ν΄λ¬μ¤ν„°μ μ μ§€λ³΄μμ— κ΄€λ ¨ν• ν¬μ¤νΈλ¥Ό μ¨λ³ΌκΉ ν•©λ‹λ‹¤. μΏ λ²„λ„¤ν‹°μ¤λ¥Ό μ΄μ©ν•μ—¬ μ„λΉ„μ¤λ¥Ό κµ¬μ¶•ν•κ³ λ‚μ„ μ–Έμ  κ°€λ” μ‹μ¤ν…μ„ μ—…λ°μ΄νΈ μ‹μΌμ•Όν•  μΌμ΄ μƒκΈΈ κ²ƒμ΄λ©°, μ¤λ¥λ΅ μΈν•μ—¬ λ…Έλ“κ°€ λ¨Ήν†µμ΄ λλ”μΌλ„ μƒκΈΈ κ²ƒμ…λ‹λ‹¤. κ·Έλ ‡λ‹¤λ©΄ λ…Έλ“μ μ‘λ™μ„ μ¤‘μ§€μ‹ν‚¤λ©΄, λλ” μ¤λ¥λ΅ μ¤‘μ§€λλ‹¤λ©΄ μ–΄λ–»κ² λ κΉμ”? master nodeμ kube-contoller-managerμ—λ” pod-eviction-timeoutμ΄ μ΅΄μ¬ν•©λ‹λ‹¤ μ»¨λ””μ… κ° λ…Έλ“μ—λ” μ•„λμ™€ κ°™μ΄ μ—¬λ¬κ°€μ§€ conditionμ΄ μ΅΄μ¬ν•©λ‹λ‹¤ λ…Έλ“ μ»¨λ””μ… μ„¤λ… Ready λ…Έλ“κ°€ μƒνƒ μ–‘νΈν•λ©° νλ“λ¥Ό μμ©ν•  μ¤€λΉ„κ°€ λμ–΄ μλ” κ²½μ° True, λ…Έλ“μ μƒνƒκ°€ λ¶λ‰ν•μ—¬ νλ“λ¥Ό μμ©ν•μ§€ λ»ν•  κ²½μ° False, κ·Έλ¦¬κ³  λ…Έλ“ μ»¨νΈλ΅¤λ¬κ°€ λ§μ§€λ§‰ node-monitor-grace-period (κΈ°λ³Έκ°’ 40 κΈ°κ°„ λ™μ• λ…Έλ“λ΅λ¶€ν„° μ‘λ‹µμ„ λ°›μ§€ λ»ν• κ²½μ°) Unknown DiskPressure λ””μ¤ν¬ μ‚¬μ΄μ¦ μƒμ— μ••λ°•μ΄ μλ” κ²½μ°, μ¦‰ λ””μ¤ν¬ μ©λ‰μ΄ λ„‰λ„‰μΉ μ•μ€ κ²½μ° True, λ°λ€μ κ²½μ° False MemoryPressure λ…Έλ“ λ©”λ¨λ¦¬ μƒμ— μ••λ°•μ΄ μλ” κ²½μ°, μ¦‰ λ…Έλ“ λ©”λ¨λ¦¬κ°€ λ„‰λ„‰μΉ μ•μ€ κ²½μ° True, λ°λ€μ κ²½μ° False PIDPressure ν”„λ΅μ„Έμ¤ μƒμ— μ••λ°•μ΄ μλ” κ²½μ°, μ¦‰ λ…Έλ“ μƒμ— λ§μ€ ν”„λ΅μ„Έμ¤λ“¤μ΄ μ΅΄μ¬ν•λ” κ²½μ° True, λ°λ€μ κ²½μ° False NetworkUnavailable λ…Έλ“μ— λ€ν•΄ λ„¤νΈμ›ν¬κ°€ μ¬λ°”λ¥΄κ² κµ¬μ„±λμ§€ μ•μ€ κ²½μ° True, λ°λ€μ κ²½μ° False λν• λ…Έλ“ lifecycle controllerλ” μ»¨λ””μ…μ„ μ•„λμ™€ κ°™μ€ built-in taintλ¥Ό μλ™μΌλ΅ μƒμ„±ν•©λ‹λ‹¤. built-in taints node.kubernetes.io/not-ready: λ…Έλ“κ°€ μ¤€λΉ„λμ§€ μ•μ. μ΄λ” NodeCondition Ready κ°€ β€Falseβ€λ΅ λ¨μ— ν•΄λ‹Ή. node.kubernetes.io/unreachable: λ…Έλ“κ°€ λ…Έλ“ μ»¨νΈλ΅¤λ¬μ—μ„ λ„λ‹¬ν•  μ μ—†μ. μ΄λ” NodeCondition Ready κ°€ β€Unknownβ€λ΅ λ¨μ— ν•΄λ‹Ή. node.kubernetes.io/memory-pressure: λ…Έλ“μ— λ©”λ¨λ¦¬ ν• λ‹Ή μ••λ°•μ΄ μμ. node.kubernetes.io/disk-pressure: λ…Έλ“μ— λ””μ¤ν¬ ν• λ‹Ή μ••λ°•μ΄ μμ. node.kubernetes.io/pid-pressure: λ…Έλ“μ— PID ν• λ‹Ή μ••λ°•μ΄ μμ. node.kubernetes.io/network-unavailable: λ…Έλ“μ λ„¤νΈμ›ν¬λ¥Ό μ‚¬μ©ν•  μ μ—†μ. node.kubernetes.io/unschedulable: λ…Έλ“λ¥Ό μ¤μΌ€μ¤„ν•  μ μ—†μ. node.cloudprovider.kubernetes.io/uninitialized: β€μ™Έλ¶€β€ ν΄λΌμ°λ“ κ³µκΈ‰μλ΅ kubeletμ„ μ‹μ‘ν•λ©΄, μ΄ ν…μΈνΈκ°€ λ…Έλ“μ—μ„ μ‚¬μ© λ¶κ°€λ¥μΌλ΅ ν‘μ‹λλ„λ΅ μ„¤μ •λ¨. κ·Έ μ¤‘μ—μ„λ„ ready μ»¨λ””μ…μ€ μΆ€ νΉλ³„ν•λ°μ”. ready μ»¨λ””μ…μ μƒνƒκ°€ pod-eviction-timeout (kube-controller-managerμ— μ „λ‹¬λ μΈμ) λ³΄λ‹¤ λ” κΈΈκ² Unknown λλ” Falseλ΅ μ μ§€λλ” κ²½μ°, λ…Έλ“ μƒμ— λ¨λ“  νλ“λ” λ…Έλ“ μ»¨νΈλ΅¤λ¬μ— μν•΄ μ‚­μ λλ„λ΅ μ¤μΌ€μ¤„ λ©λ‹λ‹¤. ν΄λΌμ°λ“-μ»¨νΈλ΅¤λ¬-κ΄€λ¦¬μμ μ»¨νΈλ΅¤λ¬κ°€ μ΄ λ…Έλ“λ¥Ό μ΄κΈ°ν™”ν•λ©΄, kubeletμ΄ μ΄ ν…μΈνΈλ¥Ό μ κ±°ν•©λ‹λ‹¤ μ¦‰ λ‹¤μ‹ podκ°€ λ°°μ •λ  μ μλ” μƒνƒκ°€ λλ”κ²ƒμ΄μ£ . κΈ°λ³Έ μ¶•μ¶ νƒ€μ„μ•„μ›ƒ κΈ°κ°„μ€ κΈ°λ³Έ 5λ¶„μΌλ΅ μ„¤μ •λμ–΄ μμµλ‹λ‹¤. λ§μ•½ λ…Έλ“κ°€ λ‹¤μ΄λμ—λ‹¤κ°€ 5λ¶„μ•μ— λ³µκµ¬κ°€ λμ—λ‹¤λ©΄ λ…Έλ“ λ‚΄μ podλ“¤μ€ κ·Έλ€λ΅ μ΅΄μ¬ν•μ§€λ§, μ„¤μ •λ νƒ€μ„μ•„μ›ƒ μ‹κ°„μ„ μ΄κ³Όν•λ‹¤λ©΄ κ·Έμ•μ νλ“λ“¤μ€ λ¨λ‘ μ¤‘λ‹¨ λλ”κ²ƒμ…λ‹λ‹¤. λ§μ•½ μμ •ν•κ³  μ‹¶λ‹¤λ©΄ λ§μ¤ν„° λ…Έλ“μ kube-system λ„¤μ„μ¤νμ΄μ¤μ— μλ” kube-controller-manager-masterμ„ editν•΄μ£Όλ©΄λ©λ‹λ‹¤. κ·Έλ°λ° λ§μ΄μ£  μ΄ podλ” static podμ…λ‹λ‹¤. 6λ²μ§Έ ν¬μ¤νΈμ—μ„ μ„¤λ… ν–μ—λ”λ° static pod λ¥Ό μμ •ν•λ ¤λ©΄ static podμ„ μƒμ„±ν• yamlνμΌ μμ²΄λ¥Ό μμ •ν•λ‹¤κ³  ν–μ—μ£ ? static podμ μ„μΉλ¥Ό μ°Ύλ”κ²ƒ λ¶€ν„° λ³µμµν•΄λ΄…μ‹λ‹¤ μ°μ„  config.yamlνμΌμ μ„μΉλ¥Ό μ°Ύμ•„μ¤λ‹λ‹¤. $ ps -ef | grep kubelet | grep &quot;\--config&quot; root 10476 1 3 May28 ? 05:09:26 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --network-plugin=cni --pod-infra-container-image=k8s.gcr.io/pause:3.4.1 config.yamlνμΌ λ‚΄μ—μ„ staticpathλ¥Ό μ°Ύμ•„λƒ…μ‹λ‹¤ $ sudo grep -i static /var/lib/kubelet/config.yaml staticPodPath: /etc/kubernetes/manifests staticPodPathλ΅ μ΄λ™ν›„ λ­κ°€μλ‚ ν™•μΈν•΄λ΄…λ‹λ‹¤. $ cd /etc/kubernetes/manifests $ ls etcd.yaml kube-apiserver.yaml kube-controller-manager.yaml kube-scheduler.yaml μ μ΄μ  μ΄ yamlνμΌμ„ μμ •ν•λ©΄ λ©λ‹λ‹¤. μ €λ” μ΄ κΈ°λ³Έ 5λ¶„μΈ eviction-timeoutμ„ 60μ΄λ΅ λ°”κΎΈμ–΄ λ³΄κ² μµλ‹λ‹¤. commandμ— --pod-eviction-timeout=60s μµμ…μ„ μ¶”κ°€ν•΄ μ¤μΌλ΅μ¨ λ§μ΄μ£ . apiVersion: v1 kind: Pod metadata: annotations: kubernetes.io/config.hash: 47cace34a635d6f3e305eee20e0e7b30 kubernetes.io/config.mirror: 47cace34a635d6f3e305eee20e0e7b30 kubernetes.io/config.seen: &quot;2021-05-28T03:40:42.961803243Z&quot; kubernetes.io/config.source: file creationTimestamp: &quot;2021-05-28T03:40:55Z&quot; labels: component: kube-controller-manager tier: control-plane name: kube-controller-manager-master namespace: kube-system ownerReferences: - apiVersion: v1 controller: true kind: Node name: master uid: 69f4d243-9420-45a9-928e-672a1d3b977a resourceVersion: &quot;478&quot; uid: 4cfad35d-8664-42cf-9ed9-5fd5b4d771a4 spec: containers: - command: - kube-controller-manager - --allocate-node-cidrs=true - --pod-eviction-timeout=60s #&amp;lt;----------- ν•΄λ‹ΉλΌμΈμ„ μ¶”κ°€ν•λ©΄ μ΄μ  5λ¶„μ΄μ•„λ‹ 60μ΄λ΅ λ³€κ²½λ©λ‹λ‹¤. - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf - --bind-address=127.0.0.1 - --client-ca-file=/etc/kubernetes/pki/ca.crt - --cluster-cidr=10.244.0.0/16 - --cluster-name=kubernetes - --cluster-signing-cert-file=/etc/kubernetes/pki/ca.crt - --cluster-signing-key-file=/etc/kubernetes/pki/ca.key - --controllers=*,bootstrapsigner,tokencleaner - --kubeconfig=/etc/kubernetes/controller-manager.conf - --leader-elect=true - --port=0 - --requestheader-client-ca-file=/etc/kubernetes/pki/front-proxy-ca.crt - --root-ca-file=/etc/kubernetes/pki/ca.crt - --service-account-private-key-file=/etc/kubernetes/pki/sa.key - --service-cluster-ip-range=10.96.0.0/12 - --use-service-account-credentials=true image: k8s.gcr.io/kube-controller-manager:v1.21.1 ...μ¤‘λµ μ €μ¥ν•΄μ£Όλ©΄ λ©μ·„λ‹¤κ°€ kube-controller-manager-master 0/1 Running 0 3s μµμ…μ„ μ μ©μ‹μΌ podμ‹ μ¬μ‹λ™λ©λ‹λ‹¤~ kube-controller-manager-master 1/1 Running 0 3s eviction timeoutμ μ΅΄μ¬μ΄μ ? μ„μ—μ„ eviction timeoutμ κ°’μ„ λ°”κΎΈλ” μ‹¤μµμ„ ν•΄λ³΄μ•λ”λ°μ” μ΄ timeoutμ€ λ¬΄μ—‡κ³Ό μ—°κ΄€μ΄ μλ”μ§€ λ‘κ°€μ§€ μΌ€μ΄μ¤λ¥Ό ν†µν•΄μ„ μ•μ•„λ³΄κ² μµλ‹λ‹¤. case1: nodeκ°€ λ¨Ήν†µμ΄ λμ—λ‹¤κ°€ μ„¤μ •ν•΄λ†“μ€ eviction-timeoutλ³΄λ‹¤ μ§¦μ€μ‹κ°„μ•μ— λ³µκµ¬λκ²½μ° λ…Έλ“λ‚΄μ— μλ podλ“¤μ΄ kubectlμ— μν•΄ λ‹¤μ‹ ν•΄λ‹Ήλ…Έλ“μ—μ„ μ¬μ‹μ‘λ©λ‹λ‹¤. case2: nodeκ°€ λ¨Ήν†µμ΄ λν›„ eviction-timeoutμ„ μ΄κ³Όν•κ²½μ° ν•΄λ‹Ή λ…Έλ“μ—μλ” podλ“¤μ„ λ¨λ‘ μ¶•μ¶ν• ν›„μ— λ…Έλ“κ°€ μ¬μ‹λ™λ©λ‹λ‹¤. ν•΄λ‹Ή λ…Έλ“μ—μλ podμ΄ replicasetμ„ ν†µν•΄ μƒμ„±λμ—λ‹¤λ©΄ λ‹¤μ‹ λ‹¤λ¥Έλ…Έλ“μ— μ μƒμ„±μ΄ λκ² μ§€λ§, μΌλ° podμ΄λΌλ©΄ λ‹¤μ‹ μ‚΄μ•„λ‚μ§€ λ»ν• κ²λ‹λ‹¤. λ…Έλ“κ΄€λ ¨ λ…λ Ήμ–΄ kubectl drain node $ kubectl drain node ν•΄λ‹Ή λ…Έλ“μ—μλ” podλ“¤μ„ μΆ…λ£μ‹ν‚¤κ³ , λ‹¤λ¥Έλ…Έλ“μ— μ¬μ‹μ‘μ‹ν‚µλ‹λ‹¤ (graceful node shutdown) λν• ν•΄λ‹Ή λ…Έλ“λ¥Ό unschedulableν•κ² λ§λ“ λ‹¤. kubernetesμ λ²„μ „ λλ” λ¦¬λ…μ¤ μ»¤λ„λ“±μ μ—…κ·Έλ μ΄λ“ν•  λ• μ‚¬μ©ν•  μ μκ² μµλ‹λ‹¤(kubeadm, kubelet, kubectl, β€¦) kubectl cordon node $ kubectl cordon node ν•΄λ‹Ή λ…Έλ“λ¥Ό unschedulableν•κ² λ§λ“­λ‹λ‹¤ μ‹¤ν–‰ μ¤‘μΈ Podλ¥Ό μ¶•μ¶ν•μ§€λ” μ•μµλ‹λ‹¤ kubectl uncordon node $ kubectl uncordon node ν•΄λ‹Ή λ…Έλ“λ¥Ό schedulableν•κ² λ§λ“ λ‹¤ μ—…κ·Έλ μ΄λ“λ¥Ό λ§μΉ λ…Έλ“λ¥Ό μ¤μΌ€μ¥΄λ¬λΈ”ν•κ² λ§λ“­λ‹λ‹¤ (taintλ¥Ό μ κ±°) drainλ…λ Ήμ— μν•΄μ„ μ§‘λ‚κ°„ podλ“¤μ΄ λ‹¤μ‹ μ§‘μ„ μ°Ύμ•„μ¤μ§„ μ•μµλ‹λ‹¤. μΏ λ²„λ„¤ν‹°μ¤ λ²„μ „ λ° λ²„μ „μ°¨μ΄ μ§€μ› λ²„μ „ μΏ λ²„λ„¤ν‹°μ¤ λ²„μ „μ€ x.y.zλ΅ ν‘ν„λλ”λ°, μ—¬κΈ°μ„ xλ” λ©”μ΄μ € λ²„μ „, yλ” λ§μ΄λ„ λ²„μ „, zλ” μ‹λ§¨ν‹± λ²„μ „ μ©μ–΄μ— λ”°λ¥Έ ν¨μΉ λ²„μ „μ…λ‹λ‹¤. kubernetesμ—λ” μ—¬λ¬κ°€μ§€ μ»΄ν¬λ„νΈκ°€ μμµλ‹λ‹¤. κ°κ°μ λ²„μ „μ€ μ „λ¶€ λ™μΌν•΄μ•Όν• κΉμ”? μ•„λ‹™λ‹λ‹¤. kube-apiserverμ λ²„μ „μ΄ μ£Όμ¶•μ΄λκ³ , λ‚λ¨Έμ§€ μ»΄ν¬λ„νΈλ” κ°κ° λ‹¤λ¥΄κ² ν• λ‘λ‹¨κ³„ λ²„μ „μ΄ λ‚®κ±°λ‚ κ°™μ•„λ„ μƒκ΄€μ΄ μ—†μµλ‹λ‹¤. νΉλ³„ν•κ² kubectlμ κ²½μ°λ” kube-apiserverμ λ²„μ „λ³΄λ‹¤ ν•λ‹¨κ³„ λ†’μ€κ²½μ°λ„ μ§€μ›μ΄ λ©λ‹λ‹¤. λ” μμ„Έν• λ‚΄μ©μ€ κ³µμ‹λ¬Έμ„μ—μ„ ν™•μΈκ°€λ¥ ν•©λ‹λ‹¤ ν΄λ¬μ¤ν„° μ—…κ·Έλ μ΄λ“ kubernetsλ” latestλ²„μ „λ¶€ν„° λ‘λ‹¨κ³„ λ‚®μ€λ²„μ „κΉμ§€ μ„λΉ„μ¤λ¥Ό μ§€μ›ν•λ”λ°μ”, λ§μ•½μ— ν„μ¬ 1.19λ²„μ „μ„ μ‚¬μ©ν•κ³  μλ”λ° 1.22λ²„μ „μ΄ μ¶μ‹ λλ‹¤λ©΄ μ—…κ·Έλ μ΄λ“λ¥Ό ν•΄μ•Όκ² μ£ . κ·Έλ ‡λ‹¤λ©΄ 1.19λ²„μ „μ—μ„ ν•λ²μ— 1.22λ²μΌλ΅ μ—…κ·Έλ μ΄λ“ μ‹ν‚¤λ©΄λ κΉμ”? μ¶”μ²λλ” λ°©λ²•μ— μν•λ©΄ ν•λ‹¨κ³„ ν•λ‹¨κ³„μ”© μ°¨λ΅€μ°¨λ΅€λ΅ μ—…κ·Έλ μ΄λ“ ν•΄μ•Όλλ‹¤κ³  ν•©λ‹λ‹¤. μ—…κ·Έλ μ΄λ“ λ°©λ²• μΏ λ²„λ„¤ν‹°μ¤ ν™κ²½μ„ μ–΄λ–»κ² κµ¬μ„±ν•μ€λ”κ°€μ— λ”°λΌ μ—…κ·Έλ μ΄λ“ λ°©λ²•μ΄ λ‹¤μ–‘ν•©λ‹λ‹¤. κµ¬κΈ€μ GKE, AWSμ EKSλ“±μ kuberneteλ¥Ό μ§€μ›ν•λ” cloudμ κ²½μ° κ°„λ‹¨ν• ν΄λ¦­ λ‡λ²μΌλ΅ μ—…κ·Έλ μ΄λ“ κ°€λ¥ The hard wayλ΅ μ„¤μΉν•κ²½μ° ν•λ•€ν•λ•€ μ„¤μΉν• κ²ƒμ²λΌ μ—…κ·Έλ μ΄λ“ λν• ν•λ•€ν•λ•€ ν•΄μ•Όν•©λ‹λ‹¤ μ €λ” kubeadmμ„ μ΄μ©ν•μ—¬ kubernetesν™κ²½μ„ κµ¬μ¶•ν•μ€κ³ , kubeadmμ„ ν†µν• μ—…κ·Έλ μ΄λ“ λ°©λ²•μ— λ€ν•΄ μμ„Έν μ„¤λ…ν•΄ λ³΄κ² μµλ‹λ‹¤. μ €μ μΏ λ²„λ„¤ν‹°μ¤ ν™κ²½μ€ ν•κ°μ masterλ…Έλ“, 3κ°μ workerλ…Έλ“λ΅ κµ¬μ„±λμ–΄μμµλ‹λ‹¤. 1.20λ²„μ „μ„ μ΄μ©ν•κ³  μλ”λ° 1.21λ²„μ „μΌλ΅ μ—…κ·Έλ μ΄λ“ ν•΄λ³΄κ² μµλ‹λ‹¤. STEP1 - λ§μ¤ν„° λ…Έλ“μ— kubeadm μ—…κ·Έλ μ΄λ“ μ‹ν‚¤κΈ°. λ§μ¤ν„° λ…Έλ“μ— μ ‘μ†ν•©λ‹λ‹¤ $ ssh gcloud ssh configμ— μ„¤μ •μ„ ν•΄λ†¨κΈ°μ— μ΄λ ‡κ² κ°„λ‹¨ν•κ² μ ‘μ†κ°€λ¥ν•©λ‹λ‹¤. ssh config μ„¤μ •λ°©λ²•μ΄ κ¶κΈν•μ‹λ©΄ μ—¬κΈ°λ΅ μ΄λ™ν•μ„Έμ”. κ·Έλ¦¬κ³  kubernetesν™κ²½μ„ κµ¬μ¶•ν• λ• holdμ‹μΌλ†¨μ—λ kubeadmμ„ unholdμ‹μΌμ£Όκ³ , apt-get μƒ‰μΈ μ—…λ°μ΄νΈν›„, kubeadmμ„ μ—…λ°μ΄νΈ ν•λ‹¤μ λ‹¤μ‹ kubeadmμ„ holdμ‹μΌ μ¤„κ²λ‹λ‹¤. # 1.21.x-00μ—μ„ xλ¥Ό μµμ‹  ν¨μΉ λ²„μ „μΌλ΅ λ°”κΏ‰λ‹λ‹¤ apt-mark unhold kubeadm &amp;amp;&amp;amp; \ apt-get update &amp;amp;&amp;amp; apt-get install -y kubeadm=1.21.x-00 &amp;amp;&amp;amp; \ apt-mark hold kubeadm #λ²„μ „ ν™•μΈν•΄μ£ΌκΈ° $ kubeadm version kubeadm version: &amp;amp;version.Info{Major:&quot;1&quot;, Minor:&quot;21&quot;, GitVersion:&quot;v1.21.1&quot;, GitCommit:&quot;5e58841cce77d4bc13713ad2b91fa0d961e69192&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2021-05-12T14:17:27Z&quot;, GoVersion:&quot;go1.16.4&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;} apt-mark unholdμ™€ apt-mark hold ν•΄μ£Όλ” μ΄μ λ” kubeadmμ„ μ—…κ·Έλ μ΄λ“ν•λ©΄ μ„¤μΉμ‹ kubeletκ³Ό κ°™μ€ λ‹¤λ¥Έ κµ¬μ„± μ”μ†κ°€ κΈ°λ³Έμ μΌλ΅ μµμ‹  λ²„μ „ μΌλ΅ μλ™μΌλ΅ μ—…κ·Έλ μ΄λ“λκΈ° λ•λ¬Έμ…λ‹λ‹¤. (kubernetesλ” μ—¬λ¬λ²„μ „μ„ ν•κΊΌλ²μ— μ—…κ·Έλ μ΄λ“ κ¶μ¥ν•μ§€ μ•κΈ°λ•λ¬Έμ…λ‹λ‹¤!) μ΄λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ λ³΄λ¥λ¥Ό μ‚¬μ©ν•μ—¬ ν¨ν‚¤μ§€λ¥Ό λ³΄λ¥ λ κ²ƒμΌλ΅ ν‘μ‹ν•μ—¬ ν¨ν‚¤μ§€κ°€ μλ™μΌλ΅ μ„¤μΉ, μ—…κ·Έλ μ΄λ“ λλ” μ κ±°λμ§€ μ•λ„λ΅ν•©λ‹λ‹¤. STEP2 - μ—…κ·Έλ μ΄λ“ μ •λ³΄ ν™•μΈν•κΈ° $ kubeadm upgrade plan ... COMPONENT CURRENT AVAILABLE API Server v1.20.0 v1.21.1 Controller Manager v1.20.0 v1.21.1 Scheduler v1.20.0 v1.21.1 Kube Proxy v1.20.0 v1.21.1 ... STEP3 - μ—…κ·Έλ μ΄λ“ μ μ©μ‹ν‚¤κΈ° $ kubeadm upgrade plan apply v1.21.1 (μ΅°κΈ μ¤λκ±Έλ¦΄ μλ„ μμµλ‹λ‹¤) μ•„λμ™€κ°™μ΄λ¨λ©΄ μ„±κ³µ [upgrade/successful] SUCCESS! Your cluster was upgraded to &quot;v1.21.1&quot;. Enjoy! [upgrade/kubelet] Now that your control plane is upgraded, please proceed with upgrading your kubelets if you haven&apos;t already done so. STEP4 - node drainν›„ kubelet, kubectl μ—…λ°μ΄νΈν›„ μ¬μ‹μ‘ν•κΈ° #λ…Έλ“ λ“λ μΈν•κΈ°(λ¨λ“  pod μΆ…λ£ν›„ λ‹¤λ¥Έλ…Έλ“μ— μƒλ΅ μ‹¤ν–‰ν•κΈ° λ° ν•΄λ‹Ήλ…Έλ“ unschedulableν•κ² λ§λ“¬) $ kubectl drain &amp;lt;node-to-drain&amp;gt; --ignore-daemonsets $ apt-mark unhold kubelet kubectl &amp;amp;&amp;amp; \ $ apt-get update &amp;amp;&amp;amp; apt-get install -y kubelet=1.21.1-00 kubectl=1.21.1-00 &amp;amp;&amp;amp; \ $ apt-mark hold kubelet kubectl #μ„¤μ • μμ •μ‚¬ν•­ μ¬λ΅λ”© $ sudo systemctl daemon-reload #kubelet μ¬μ‹μ‘ $ sudo systemctl restart kubelet #μ—…λ°μ΄νΈκ°€ λλ‚¬μΌλ―€λ΅ λ‹¤μ‹ schedulableν•κ² λ§λ“¤μ–΄μ£ΌκΈ° $ kubectl uncordon &amp;lt;node-to-uncordon&amp;gt; μ—¬κΈ°κΉμ§€κ°€ λ§μ¤ν„°λ…Έλ“μ μ—…κ·Έλ μ΄λ“ λ°©λ²•μ΄μ—μµλ‹λ‹¤. :rocket: μ—¬κΈ°μ„λ¶€ν„°λ” μ›μ»¤λ…Έλ“λ“¤μ„ μ—…κ·Έλ μ΄λ“ ν•©λ‹λ‹¤. STEP5 - μ›μ»¤ λ…Έλ“μ— kubeadm μ„¤μΉν•κΈ° μ°μ„  3κ°μ μ›μ»¤λ…Έλ“μ¤‘ ν•λ‚μΈ worker-1μ— μ ‘μ†ν•©λ‹λ‹¤. ssh worker-1 κ·Έ λ‹¤μ, λ§μ¤ν„°λ…Έλ“μ— μ„¤μΉν–λκ³Ό κ°™μ€λ°©λ²•μΌλ΅ kubeadmλ¥Ό μ„¤μΉν•©λ‹λ‹¤. $ apt-mark unhold kubeadm &amp;amp;&amp;amp; \ $ apt-get update &amp;amp;&amp;amp; apt-get install -y kubeadm=1.21.x-00 &amp;amp;&amp;amp; \ $ apt-mark hold kubeadm μ•„κΉ λ§μ¤ν„°λ…Έλ“μ—μ„ μ•„λμ μ»¤λ§¨λ“λ¥Ό μ΄μ©ν•΄ upgradeκ°€λ¥ λ²„μ „μ„ ν™•μΈν•κ³  v1.21.1λ΅ applyν–μ—μµλ‹λ‹¤. $ kubeadm upgrade plan $ kubeadm upgrade apply v1.21.1 ν•μ§€λ§ μ›μ»¤λ…Έλ“μ—μ„λ” μ•„λμ μ»¤λ§¨λ“λ¥Ό μ΄μ©ν•μ—¬ ν΄λ¬μ¤ν„°μ—μ„ kubeadm ClusterConfiguration μ„ κ°€μ Έμ¤λ©°, μ΄ λ…Έλ“μ kubelet κµ¬μ„±μ„ μ—…κ·Έλ μ΄λ“ ν•©λ‹λ‹¤. $ kubeadm upgrade node κ·Έλ¦¬κ³  λ§μ¤ν„° λ…Έλ“λ΅ μ΄λ™ν•μ—¬ μ—…κ·Έλ μ΄λ“ ν•  μ›μ»¤λ…Έλ“λ¥Ό λ“λ μΈ ν•΄μ¤λ‹λ‹¤. (λ§μ¤ν„° λ…Έλ“μ—μ„ μ›μ»¤λ…Έλ“λ΅ μ ‘μ†ν–μ—κΈ°μ— μ ‘μ† μΆ…λ£ν•λ©΄ λ§μ¤ν„°λ…Έλ“λ΅ μ΄λ™ν•©λ‹λ‹¤.) $ exit logout Connection to 10.128.0.5 closed. $ kubectl drain worker-1 --ignore-daemonsets STEP6 - μ›μ»¤λ…Έλ“μ kubelet λ° kubectl μ—…κ·Έλ μ΄λ“ # λ‹¤μ‹ μ›μ»¤λ…Έλ“λ΅ μ ‘μ†ν•κΈ° $ ssh worker-1 # kubectl κ³Ό kubelet μ—…λ°μ΄νΈν•κΈ° $ apt-mark unhold kubectl kubelet &amp;amp;&amp;amp; \ $ apt-get update &amp;amp;&amp;amp; apt-get install -y kubectl=1.21.1-00 kubelet=1.21.1-00 &amp;amp;&amp;amp; \ $ apt-mark hold kubectl kubelet STEP7 - kubelet λ‹¤μ‹ μ‹μ‘ν•κΈ° $ sudo systemctl daemon-reload $ sudo systemctl restart kubelet STEP8 - cordon ν•΄μ¬ν•κΈ° #λ§μ¤ν„°λ…Έλ“λ΅ μ΄λ™ν•κΈ° $ exit $ kubectl uncordon worker-1 STEP9 - λ°λ³µν•κΈ° μ—…κ·Έλ μ΄λ“ ν•  μ›μ»¤λ…Έλ“μ— STEP5 ~ STEP8μ„ λ‘κ°™μ΄ μ§„ν–‰ν•΄μ¤λ‹λ‹¤ λ§μ§€λ§‰μΌλ΅ μ—…λ°μ΄νΈκ°€ μ λμ—λ”μ§€ ν™•μΈν•΄μ¤λ‹λ‹¤ $ kubectl get nodes NAME STATUS ROLES AGE VERSION master Ready control-plane,master 6d8h v1.21.1 worker-1 Ready &amp;lt;none&amp;gt; 6d8h v1.21.1 worker-2 Ready &amp;lt;none&amp;gt; 6d8h v1.21.1 worker-3 Ready &amp;lt;none&amp;gt; 6d8h v1.21.1 λ²„μ „μ΄ v1.21.1λ΅ μ μ—…κ·Έλ μ΄λ“ λκ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.</summary></entry><entry><title type="html">[ #7 ] λ°°ν¬ μ „λµ</title><link href="https://shjeong92.github.io/2021/06/02/Learning-Kubernetes-07.html" rel="alternate" type="text/html" title="[ #7 ] λ°°ν¬ μ „λµ" /><published>2021-06-02T00:00:00+09:00</published><updated>2021-06-02T00:00:00+09:00</updated><id>https://shjeong92.github.io/2021/06/02/Learning-Kubernetes-07</id><content type="html" xml:base="https://shjeong92.github.io/2021/06/02/Learning-Kubernetes-07.html">&lt;p&gt;μΏ λ²„λ„¤ν‹°μ¤μ—λ”μ•„λ κ·Έλ¦Όκ³Ό κ°™μ΄ λ‘κ°€μ§€ λ°°ν¬λ°©λ²•μ΄ μμµλ‹λ‹¤&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/75003424/120428975-9582c300-c3af-11eb-95cf-ba8825576440.png&quot; alt=&quot;deplstrategy&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;recreate&quot;&gt;Recreate&lt;/h2&gt;
&lt;p&gt;Recreate λ°©μ‹μ€ μ΄μ „λ²„μ „ Aλ¥Ό μΆ…λ£μ‹ν‚¨ν›„ μ‹ κ·λ²„μ „ Bλ¥Ό λ΅¤μ•„μ›ƒ μ‹ν‚¤λ” λ°©μ‹μ…λ‹λ‹¤.&lt;/p&gt;

&lt;h3 id=&quot;pros&quot;&gt;pros&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;κ°€μ¥ μ‰¬μ΄ λ°°ν¬λ°©λ²•&lt;/li&gt;
  &lt;li&gt;ν΄λΌμ°λ“ λ¦¬μ†μ¤ λΉ„μ”μ΄ μ μ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;cons&quot;&gt;cons&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Aκ°€ μ¤‘μ§€λκ³  Bκ°€ λ°°ν¬λκΈ°μ „κΉμ§€ μ„λΉ„μ¤κ°€ μ¤‘λ‹¨λμ–΄ μ‚¬μ©μμ—κ² μ•…μν–¥μ„ μ¤&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;rolling-update&quot;&gt;Rolling Update&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;κΈ°μ΅΄μ„λ²„λ¥Ό μμ°¨μ μΌλ΅ μ¤‘μ§€μ‹ν‚¤λ©° μμ°¨μ μΌλ΅ μ—…κ·Έλ μ΄λ“ μ‹ν‚¤λ” λ°©μ‹μΌλ΅, kubernetesμ—μ„ spec.strategy.typeμ„ μ§€μ •ν•μ§€ μ•μΌλ©΄ κΈ°λ³Έμ μΌλ΅ RollingUpdateλ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;μ²μ μΏ λ²„λ„¤ν‹°μ¤μ— μ…λ¬Έν•μ€μ„λ• replicasetκ³Ό, deploymentμ μ°¨μ΄μ μ€ yamlνμΌλ΅λ§ λ†“κ³  λ΄¤μ„λ•λ” λ‹¤λ¥Έμ μ΄ kind λ¶€λ¶„ λ§κ³ λ” μ—†μ—μµλ‹λ‹¤. λ‘κ°™μ΄ νλ“λ¥Ό μ μ •κ°―μ λ§νΌ μƒμ„±ν•΄μ£Όκ³ , crashλλ©΄ λ‹¤μ‹ λ³µκµ¬μ‹μΌμ£Όλ” μ μ—μ„λ” λ§μ΄μ£ .&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;μ¤λμ€ λ°°ν¬λ°©μ‹μ— λ€ν•΄ κ³µλ¶€ν•λ©΄μ„ μ™ deploymentλ¥Ό μ‚¬μ©ν•μ—¬ podμ„ λ°°ν¬ν•λ”κ°€μ— λ€ν• κ¶κΈμ¦μ„ ν’€ μ μμ—μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;Deploymentλ¥Ό μ‚¬μ©ν•μ—¬ podμ„ λ°°ν¬ ν•κ²λλ©΄ λ΅¤μ•„μ›ƒμ„ μƒμ„±ν•©λ‹λ‹¤. κ·Έλ¦¬κ³  μ΄ λ΅¤μ•„μ›ƒμ€ μƒλ΅μ΄ λ°°ν¬ λ²„μ „(revision)μ„ μƒμ„±ν•©λ‹λ‹¤. μ΄λ§μ΄ μ μ΄ν•΄κ°€ μ• λμ‹¤μλ„ μλ”λ°&lt;/p&gt;

&lt;p&gt;μμ„Έν• μ„¤λ…μ€ μ‹¤μµμ„ μ§„ν–‰ν•λ©΄μ„ ν•λ„λ΅ ν•κ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ•„λμ™€κ°™μ΄ deployment definitionμ„ μ‘μ„±ν• yamlνμΌμ΄ μμµλ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#depl.yaml&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;apps/v1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Deployment&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp-deployment&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;front-end&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp-pod&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;front-end&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx-container&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;replicas&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;selector&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;matchLabels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;front-end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ•„λμ λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•μ—¬ deploymentλ¥Ό μƒμ„±ν•κ²λλ©΄&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kubectl apply &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; depl.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;myapp-deploymentλΌλ” μ΄λ¦„μ„κ°€μ§„ deploymentμ™€, myapp-deployment-hashκ°’ μ„ κ°€μ§„ replicaset, κ·Έλ¦¬κ³  deploymentλ¥Ό ν†µν•΄ μƒμ„±λ replicasetμ— μν•΄ μƒμ„±λ podμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kubectl get all
NAME                                    READY   STATUS    RESTARTS   AGE
pod/myapp-deployment-7df67f74c5-4nkmq   1/1     Running   0          5m27s
pod/myapp-deployment-7df67f74c5-bnl9r   1/1     Running   0          5m27s
pod/myapp-deployment-7df67f74c5-jsd9p   1/1     Running   0          5m27s

NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;S&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   AGE
service/kubernetes   ClusterIP   10.96.0.1    &amp;lt;none&amp;gt;        443/TCP   5d2h

NAME                               READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/myapp-deployment   3/3     3            3           5m27s

NAME                                          DESIRED   CURRENT   READY   AGE
replicaset.apps/myapp-deployment-7df67f74c5   3         3         3       5m27s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ•„μ§κΉμ§€λ” λ³„ μ°¨μ΄κ°€ μ—†μ§€μ”, deploymentκ°€ μƒκ²Όλ‹¤λ”κ²ƒ μ™Έμ—λ” λ§μ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;ν•μ§€λ§ μ‚¬μ‹¤μ€ μ΄μ™Έμ—λ„ &lt;code&gt;revision&lt;/code&gt;μ΄λΌλ” κ²ƒμ„ μƒμ„±ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ΄λ” ν•΄λ‹Ή deploymentλ¥Ό μ—…λ°μ΄νΈ ν• λ•λ§λ‹¤ μƒκΈ°κ³ , μ΄μ „ &lt;code&gt;revision&lt;/code&gt;μ μ •λ³΄λ„ κ°€μ§‘λ‹λ‹¤. λν•, μƒλ΅μ΄ λ²„μ „μ &lt;code&gt;replicaset&lt;/code&gt;μ„ μƒμ„±ν•κ³ , μ΄μ „λ²„μ „μ &lt;code&gt;replicaset&lt;/code&gt;μ μ •λ³΄λ¥Ό λ‚¨κ²¨λ†“μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ§μ•½μ— μ—…λ°μ΄νΈν›„μ— λ¬Έμ κ°€ μƒκ²Όμ„μ‹μ— λ΅¤λ°±μ„ κ°€λ¥μΌ€ ν•κΈ° μ„ν•΄μ„ μ…λ‹λ‹¤. κ·Έλ¦¬κ³  μ΄λ¬ν•μ μ΄ &lt;strong&gt;deployment&lt;/strong&gt;λ¥Ό μ‚¬μ©ν•΄μ„ podμ„ λ°°ν¬ν–μ„λ•λ‘ &lt;strong&gt;replicaset&lt;/strong&gt;μ„ μ‚¬μ©ν–μ„λ•μ κ°€μ¥ ν° μ°¨μ΄μ μ΄ μ•„λ‹κΉ μ‹¶μµλ‹λ‹¤.&lt;/p&gt;

&lt;h2 id=&quot;rollout-μƒνƒν™•μΈ&quot;&gt;Rollout μƒνƒν™•μΈ&lt;/h2&gt;

&lt;p&gt;deploymentλ¥Ό μ‚¬μ©ν•μ—¬ podμ„ λ°°ν¬ν•κ²λλ©΄ rolloutμ„ μƒμ„±ν•λ‹¤κ³  ν–μ—λ”λ° 
μ¶”κ°€λ΅ μ‚¬μ©ν•  μ μλ” μ»¤λ§¨λ“λ„ μƒκΉλ‹λ‹¤. &lt;code&gt;rollout&lt;/code&gt; μ΄λΌλ” μ»¤λ§¨λ“μΈλ°μ”.&lt;/p&gt;

&lt;p&gt;rollout μ»¤λ§¨λ“λ¥Ό ν†µν•μ—¬ deploymentμ revisionλ° historyλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤&lt;/p&gt;

&lt;p&gt;&lt;code&gt; kubectl rollout status deployment &lt;/code&gt; μ»¤λ§¨λ“λ¥Ό μ‚¬μ©ν•μ—¬ λ‹¤μκ³Ό κ°™μ΄ λ΅¤μ•„μ›ƒ μƒμ„±μ μƒνƒλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl rollout status deployment/myapp-deployment
Waiting &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;deployment &lt;span class=&quot;s2&quot;&gt;&quot;myapp-deployment&quot;&lt;/span&gt; rollout to finish: 0 of 3 updated replicas are available...
Waiting &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;deployment &lt;span class=&quot;s2&quot;&gt;&quot;myapp-deployment&quot;&lt;/span&gt; rollout to finish: 1 of 3 updated replicas are available...
Waiting &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;deployment &lt;span class=&quot;s2&quot;&gt;&quot;myapp-deployment&quot;&lt;/span&gt; rollout to finish: 2 of 3 updated replicas are available...
deployment &lt;span class=&quot;s2&quot;&gt;&quot;myapp-deployment&quot;&lt;/span&gt; successfully rolled out
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;rollout-history-ν™•μΈ&quot;&gt;Rollout history ν™•μΈ&lt;/h2&gt;

&lt;p&gt;λν• &lt;code&gt; kubectl rollout history deployment &lt;/code&gt; μ»¤λ§¨λ“λ¥Ό μ‚¬μ©ν•λ©΄ μ•„λμ™€ κ°™μ΄ λ¦¬λΉ„μ „ μ •λ³΄λ¥Ό ν™•μΈν•  μ μλ”λ°μ”&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl rollout &lt;span class=&quot;nb&quot;&gt;history &lt;/span&gt;deploy/myapp-deployment
deployment.apps/myapp-deployment 
REVISION  CHANGE-CAUSE
1         &amp;lt;none&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ν•λ‚μ revision λ°–μ— λ³΄μ΄μ§€μ•μµλ‹λ‹¤. κ·Έ μ΄μ λ” depl.yamlμ„ μ΄μ©ν•μ—¬ μ²μμΌλ΅ λ°°ν¬ν• λ²„μ „μ΄κΈ° λ•λ¬Έμ…λ‹λ‹¤.&lt;/p&gt;

&lt;h2 id=&quot;rollout-update&quot;&gt;Rollout update&lt;/h2&gt;
&lt;p&gt;ν•΄λ‹Ή deploymentλ¥Ό μ—…λ°μ΄νΈν•λ©΄ μ–΄λ–¤μΌμ΄ μƒκΈ°λ”μ§€ λ³΄λ„λ΅ ν•κ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ°μ„  yamlνμΌμ„ μμ •ν•΄μ¤λ‹λ‹¤&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#depl.yaml&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;apps/v1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Deployment&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp-deployment&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;front-end&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp-pod&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;front-end&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx-container&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx:1.20-alpine       &amp;lt;----- λ°”λ€λ¶€λ¶„&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;replicas&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;selector&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;matchLabels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;front-end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;μ΄λ―Έμ§€λ¥Ό λ°”κΏ€λ•μ—λ” κ°„λ‹¨ν•κ² set imageλ¥Ό ν†µν•΄μ„λ„ κ°€λ¥ν•μ§€λ§ κ°μΈμ μΌλ΅ λ³€κ²½μƒν™©μ„ μ΄λ ¥μΌλ΅ λ‚¨κΈ°λ”κ² μΆ‹λ‹¤κ³  μƒκ°ν•μ—¬ ν•΄λ‹Ή λ°©λ²•μ„ μ‚¬μ©ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ³€κ²½μ‚¬ν•­μ„ μ μ©μ‹μΌμ¤λ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl apply &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; depl.yaml
deployment.apps/myapp-deployment configured
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;κ·Έλ‹¤μ replicasetκ³Ό revisionμ„ ν™•μΈν•΄λ΄…μ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl get rs
NAME                          DESIRED   CURRENT   READY   AGE
myapp-deployment-79896f8f68   3         3         3       5m14s
myapp-deployment-7df67f74c5   0         0         0       5m42s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;replicasetμ΄ ν•λ‚λ” μƒκ²ΌμΌλ©°,&lt;/p&gt;

&lt;p&gt;revisionλ„ ν•λ‚λ” μƒκΈ΄κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ kubectl rollout history deploy myapp-deployment
deployment.apps/myapp-deployment 
REVISION  CHANGE-CAUSE
2         &amp;lt;none&amp;gt;
1         &amp;lt;none&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ν•μ§€λ§ change-causeκ°€ None μΌλ΅ λμμΌλ©΄ λ¬΄μ—‡μ΄ λ°”λ€μ—λ”μ§€ μ• μ κ°€μ—†λ”λ°, μ•„λ μ»¤λ§¨λ“λ¥Ό μ΄μ©ν•λ©΄ λ”°λ΅ μ„¤μ •μ΄ κ°€λ¥ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;kubectl annotate deployment.v1.apps/[deployment name] kubernetes.io/change-cause=&quot;reason of update&quot;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ν•΄λ‹Ήμ»¤λ§¨λ“λ¥Ό μ‚¬μ©ν•μ—¬ μ£Όμ„μ„ λ‹¬κ³  λ‹¤μ‹ ν™•μΈν•΄λ΄…μ‹λ‹¤&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl annotate deployment.v1.apps/myapp-deployment kubernetes.io/change-cause&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;image updated to 1.20&quot;&lt;/span&gt;
deployment.apps/myapp-deployment annotated


&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl rollout &lt;span class=&quot;nb&quot;&gt;history &lt;/span&gt;deployment myapp-deployment
deployment.apps/myapp-deployment 
REVISION  CHANGE-CAUSE
1         &amp;lt;none&amp;gt;
2         image updated to 1.20
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;μ£Όμ„μ΄ μ λ‹¬λ¦°κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;h2 id=&quot;rollback&quot;&gt;Rollback&lt;/h2&gt;
&lt;p&gt;λ§μ•½μ— μƒλ΅μ΄ λ²„μ „μΌλ΅ μ—…λ°μ΄νΈλ¥Ό ν–λ”λ° λ¬Έμ κ°€ μƒκ²Όμ„λ• μ΄μ „ λ²„μ „ μΌλ΅ λμ•„κ° μ μλ” κΈ°λ¥μ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code&gt; kubeclt rollout undo deployment &lt;/code&gt;μ»¤λ§¨λ“λ¥Ό μ‚¬μ©ν•μ—¬ λ΅¤λ°± μ‹ν‚¬ μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ§μ ‘ μ‹¤μµν•΄λ΄…μ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl rollout undo deployment myapp-deployment
deployment.apps/myapp-deployment rolled back
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;μ„±κ³µμ μΌλ΅ λ΅¤λ°± λμ—λ‹¤κ³  λΉλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ°μ„  imageκ°€ λ‹¤μ‹ μ›λλ€λ΅ λμ•„μ™”λ”μ§€ ν™•μΈν•΄λ΄…λ‹λ‹¤&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl describe deployment myapp-deployment
Name:                   myapp-deployment
Namespace:              default
CreationTimestamp:      Wed, 02 Jun 2021 07:05:06 +0000
Labels:                 &lt;span class=&quot;nv&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;myapp
                        &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;front-end
Annotations:            deployment.kubernetes.io/revision: 3
                        kubernetes.io/change-cause: 
Selector:               &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;front-end
Replicas:               3 desired | 3 updated | 3 total | 3 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:  &lt;span class=&quot;nv&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;myapp
           &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;front-end
  Containers:
   nginx-container:
    Image:        nginx          &amp;lt;&lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt; 1.20 μ—μ„ λ‹¤μ‹ μ›λλ€λ΅ λμ•„μ¨κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.
    Port:         &amp;lt;none&amp;gt;
    Host Port:    &amp;lt;none&amp;gt;
    Environment:  &amp;lt;none&amp;gt;
    Mounts:       &amp;lt;none&amp;gt;
  Volumes:        &amp;lt;none&amp;gt;
Conditions:
  Type           Status  Reason
  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;           &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt;
  Available      True    MinimumReplicasAvailable
  Progressing    True    NewReplicaSetAvailable
OldReplicaSets:  &amp;lt;none&amp;gt;
NewReplicaSet:   myapp-deployment-7df67f74c5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;3/3 replicas created&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Events:
  Type    Reason             Age                  From                   Message
  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;    &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt;             &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                 &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                   &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
  Normal  ScalingReplicaSet  23m                  deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 1
  Normal  ScalingReplicaSet  23m                  deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 2
  Normal  ScalingReplicaSet  23m                  deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 2
  Normal  ScalingReplicaSet  23m                  deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 1
  Normal  ScalingReplicaSet  23m                  deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 3
  Normal  ScalingReplicaSet  23m                  deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 0
  Normal  ScalingReplicaSet  4m28s                deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 1
  Normal  ScalingReplicaSet  4m24s                deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 2
  Normal  ScalingReplicaSet  4m24s                deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 2
  Normal  ScalingReplicaSet  4m20s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;x2 over 24m&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 3
  Normal  ScalingReplicaSet  4m20s                deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 1
  Normal  ScalingReplicaSet  4m16s                deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;κ·ΈλΌ replicasetκ³Ό revisionμ€ μ–΄λ–¨κΉμ”?&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#μ΄λ―Έμ§€ 1.20μΌλ΅ μ—…λ°μ΄νΈν›„ replicaset μƒνƒ&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl get rs
NAME                          DESIRED   CURRENT   READY   AGE
myapp-deployment-79896f8f68   3         3         3       5m14s
myapp-deployment-7df67f74c5   0         0         0       5m42s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#λ΅¤λ°±ν›„ replicasetμƒνƒ&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl get rs
NAME                          DESIRED   CURRENT   READY   AGE
myapp-deployment-79896f8f68   0         0         0       25m
myapp-deployment-7df67f74c5   3         3         3       26m
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;revision&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl rollout &lt;span class=&quot;nb&quot;&gt;history &lt;/span&gt;deployment myapp-deployment
deployment.apps/myapp-deployment 
REVISION  CHANGE-CAUSE
2         image updated to 1.20
3         &amp;lt;none&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;replicasetμ€ μ΄μ „ λ²„μ „μ replicasetμΌλ΅ λ°”λ€κ²ƒμ„ ν™•μΈν•  μκ°€ μλ”λ° revisionμ€ 1λ΅λμ•„κ°€λ”κ²ƒμ΄μ•„λ‹ 1μ΄ μ¦κ°€ν• κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.
μ—¬κΈ°μ„ κ¶κΈν•μ μ΄ μƒκ²Όμµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;undoλ¥Ό μ—¬λ¬λ²ν•λ©΄ μ–΄λ–»κ²λ κΉμ”?&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl rollout &lt;span class=&quot;nb&quot;&gt;history &lt;/span&gt;deployment myapp-deployment
deployment.apps/myapp-deployment 
REVISION  CHANGE-CAUSE
3         &amp;lt;none&amp;gt;
4         image updated to 1.20
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;κ²°κ³Ό&quot;&gt;κ²°κ³Ό&lt;/h3&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl describe deployment myapp-deployment
Name:                   myapp-deployment
Namespace:              default
CreationTimestamp:      Wed, 02 Jun 2021 07:05:06 +0000
Labels:                 &lt;span class=&quot;nv&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;myapp
                        &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;front-end
Annotations:            deployment.kubernetes.io/revision: 4
                        kubernetes.io/change-cause: image updated to 1.20
Selector:               &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;front-end
Replicas:               3 desired | 3 updated | 3 total | 3 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:  &lt;span class=&quot;nv&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;myapp
           &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;front-end
  Containers:
   nginx-container:
    Image:        nginx:1.20
    Port:         &amp;lt;none&amp;gt;
    Host Port:    &amp;lt;none&amp;gt;
    Environment:  &amp;lt;none&amp;gt;
    Mounts:       &amp;lt;none&amp;gt;
  Volumes:        &amp;lt;none&amp;gt;
Conditions:
  Type           Status  Reason
  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;           &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt;
  Available      True    MinimumReplicasAvailable
  Progressing    True    NewReplicaSetAvailable
OldReplicaSets:  &amp;lt;none&amp;gt;
NewReplicaSet:   myapp-deployment-79896f8f68 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;3/3 replicas created&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Events:
  Type    Reason             Age                  From                   Message
  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;    &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt;             &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                 &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                   &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
  Normal  ScalingReplicaSet  14m                  deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 1
  Normal  ScalingReplicaSet  14m                  deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 2
  Normal  ScalingReplicaSet  14m                  deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 2
  Normal  ScalingReplicaSet  14m &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;x2 over 33m&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;    deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 3
  Normal  ScalingReplicaSet  14m                  deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 1
  Normal  ScalingReplicaSet  13m                  deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 0
  Normal  ScalingReplicaSet  2m13s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;x2 over 33m&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 1
  Normal  ScalingReplicaSet  2m9s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;x2 over 33m&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 2
  Normal  ScalingReplicaSet  2m9s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;x2 over 33m&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 2
  Normal  ScalingReplicaSet  2m5s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;x2 over 33m&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 1
  Normal  ScalingReplicaSet  2m5s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;x2 over 33m&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   deployment-controller  Scaled up replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-79896f8f68 to 3
  Normal  ScalingReplicaSet  2m1s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;x2 over 33m&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   deployment-controller  Scaled down replica &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;myapp-deployment-7df67f74c5 to 0

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;undo λ¥Ό μ—¬λ¬λ²ν•λ‹ nginx &amp;lt;-&amp;gt; nginx:1.20 μ™”λ‹¤ κ°”λ‹¤ ν•λ” λ¨μµμ„ λ³΄μ—¬μ¤λ‹λ‹¤.&lt;/p&gt;

&lt;h2 id=&quot;rocket-history&quot;&gt;:rocket: history&lt;/h2&gt;
&lt;p&gt;historyλ¥Ό λ³΄μ•„λ„ λ‘μ¤„μ κ²°κ³Όλ§ λ³΄μ—¬μ£ΌκΈ°λ„ν–κ³ , μ •λ§ λ°”λ΅ μ΄μ „λ‹¨κ³„κΉμ§€λ§ μ΄λ™ν•  μ μλ”κ±΄μ§€λ„ κ¶κΈν–μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ¶κΈν•κ±΄ λ»μ°ΈκΈ°μ— λ°”λ΅ kubernetes.ioλ¥Ό μ°Ύλ‹¤λ³΄λ‹ μ›ν•λ” revisionμΌλ΅ κ°€λ ¤λ©΄ &lt;strong&gt;β€“to-revision=[resion-number]&lt;/strong&gt; λ¥Ό μ…λ ¥ν•΄μ•Όλλ”κ²ƒμ„ μ• μ μμ—μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;deployment μ spec λ°‘μ— revisionHistoryLimit: 10 μΌλ΅ μ„¤μ •λμ–΄ μλ”κ²ƒλ„ ν™•μΈν–μΌλ©° μ΄ λν• μμ •ν•  μ μμ—κµ°μ” γ…γ…&lt;/p&gt;

&lt;p&gt;λ°”λ΅ μ΄μ „ λ‹¨κ³„λ§ μ΄λ™ κ°€λ¥ν•λ‹¤κ³  ν¬μ¤νΈ μ¬λ Έλ‹¤κ°€ νΈλ‹¤λ‹¥ μμ •ν•λ„¤μ”&lt;/p&gt;

&lt;p&gt;κ·Έλ‚μ €λ‚ historyμ—λ” μ™ μ‚¬λ ν–‡κ°λ¦¬κ² λ‘μ¤„λ§μ„ λ³΄μ—¬μ¤¬λ κ±ΈκΉμ”?&lt;/p&gt;

&lt;p&gt;kubernetesλ” μƒλ‹Ήν &lt;strong&gt;λ‘λ‘ν–κΈ°&lt;/strong&gt; λ•λ¬Έμ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ΄λ―Έ κΈ°μ–µν•κ³ μλ” replicasetλ‘ λ‹¤λ¦„μ΄ μ—†κΈ°μ— μƒλ΅μ΄ replicasetμ„ μƒμ„±ν•μ§€ μ•λ”κ²ƒμ΄μ—μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;historyμ— μ—†λ” λ‹¤λ¥Έ λ²„μ „μ nginxμ μ΄λ―Έμ§€λ΅ λ°”κΎΈμ–΄μ£Όλ‹ replicasetκ³Ό history κ°κ° ν•λ‚μ”© λ” μƒκΈ°λ”κ²ƒμ„ ν™•μΈν•  μ μμ—μµλ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl get rs
NAME                          DESIRED   CURRENT   READY   AGE
myapp-deployment-54d59f8648   3         3         3       17m
myapp-deployment-79896f8f68   0         0         0       117m
myapp-deployment-7df67f74c5   0         0         0       118m

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl rollout &lt;span class=&quot;nb&quot;&gt;history &lt;/span&gt;deploy myapp-deployment
deployment.apps/myapp-deployment 
REVISION  CHANGE-CAUSE
3         image updated to 1.20
4         &amp;lt;none&amp;gt;
5         &amp;lt;none&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>Sanghyuk Jeong</name><email>shjeong920522@gmail.com</email></author><category term="Docker" /><category term="Kubernetes" /><category term="Replicasets" /><category term="Deployment" /><category term="static" /><category term="pod" /><category term="strategy" /><category term="μΏ λ²„λ„¤ν‹°μ¤" /><category term="rolling" /><category term="update" /><summary type="html">μΏ λ²„λ„¤ν‹°μ¤μ—λ”μ•„λ κ·Έλ¦Όκ³Ό κ°™μ΄ λ‘κ°€μ§€ λ°°ν¬λ°©λ²•μ΄ μμµλ‹λ‹¤ Recreate Recreate λ°©μ‹μ€ μ΄μ „λ²„μ „ Aλ¥Ό μΆ…λ£μ‹ν‚¨ν›„ μ‹ κ·λ²„μ „ Bλ¥Ό λ΅¤μ•„μ›ƒ μ‹ν‚¤λ” λ°©μ‹μ…λ‹λ‹¤. pros κ°€μ¥ μ‰¬μ΄ λ°°ν¬λ°©λ²• ν΄λΌμ°λ“ λ¦¬μ†μ¤ λΉ„μ”μ΄ μ μ cons Aκ°€ μ¤‘μ§€λκ³  Bκ°€ λ°°ν¬λκΈ°μ „κΉμ§€ μ„λΉ„μ¤κ°€ μ¤‘λ‹¨λμ–΄ μ‚¬μ©μμ—κ² μ•…μν–¥μ„ μ¤ Rolling Update κΈ°μ΅΄μ„λ²„λ¥Ό μμ°¨μ μΌλ΅ μ¤‘μ§€μ‹ν‚¤λ©° μμ°¨μ μΌλ΅ μ—…κ·Έλ μ΄λ“ μ‹ν‚¤λ” λ°©μ‹μΌλ΅, kubernetesμ—μ„ spec.strategy.typeμ„ μ§€μ •ν•μ§€ μ•μΌλ©΄ κΈ°λ³Έμ μΌλ΅ RollingUpdateλ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. μ²μ μΏ λ²„λ„¤ν‹°μ¤μ— μ…λ¬Έν•μ€μ„λ• replicasetκ³Ό, deploymentμ μ°¨μ΄μ μ€ yamlνμΌλ΅λ§ λ†“κ³  λ΄¤μ„λ•λ” λ‹¤λ¥Έμ μ΄ kind λ¶€λ¶„ λ§κ³ λ” μ—†μ—μµλ‹λ‹¤. λ‘κ°™μ΄ νλ“λ¥Ό μ μ •κ°―μ λ§νΌ μƒμ„±ν•΄μ£Όκ³ , crashλλ©΄ λ‹¤μ‹ λ³µκµ¬μ‹μΌμ£Όλ” μ μ—μ„λ” λ§μ΄μ£ . μ¤λμ€ λ°°ν¬λ°©μ‹μ— λ€ν•΄ κ³µλ¶€ν•λ©΄μ„ μ™ deploymentλ¥Ό μ‚¬μ©ν•μ—¬ podμ„ λ°°ν¬ν•λ”κ°€μ— λ€ν• κ¶κΈμ¦μ„ ν’€ μ μμ—μµλ‹λ‹¤. Deploymentλ¥Ό μ‚¬μ©ν•μ—¬ podμ„ λ°°ν¬ ν•κ²λλ©΄ λ΅¤μ•„μ›ƒμ„ μƒμ„±ν•©λ‹λ‹¤. κ·Έλ¦¬κ³  μ΄ λ΅¤μ•„μ›ƒμ€ μƒλ΅μ΄ λ°°ν¬ λ²„μ „(revision)μ„ μƒμ„±ν•©λ‹λ‹¤. μ΄λ§μ΄ μ μ΄ν•΄κ°€ μ• λμ‹¤μλ„ μλ”λ° μμ„Έν• μ„¤λ…μ€ μ‹¤μµμ„ μ§„ν–‰ν•λ©΄μ„ ν•λ„λ΅ ν•κ² μµλ‹λ‹¤. μ•„λμ™€κ°™μ΄ deployment definitionμ„ μ‘μ„±ν• yamlνμΌμ΄ μμµλ‹λ‹¤. #depl.yaml apiVersion: apps/v1 kind: Deployment metadata: name: myapp-deployment labels: app: myapp type: front-end spec: template: metadata: name: myapp-pod labels: app: myapp type: front-end spec: containers: - name: nginx-container image: nginx replicas: 3 selector: matchLabels: type: front-end μ•„λμ λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•μ—¬ deploymentλ¥Ό μƒμ„±ν•κ²λλ©΄ kubectl apply -f depl.yaml myapp-deploymentλΌλ” μ΄λ¦„μ„κ°€μ§„ deploymentμ™€, myapp-deployment-hashκ°’ μ„ κ°€μ§„ replicaset, κ·Έλ¦¬κ³  deploymentλ¥Ό ν†µν•΄ μƒμ„±λ replicasetμ— μν•΄ μƒμ„±λ podμ„ ν™•μΈν•  μ μμµλ‹λ‹¤. kubectl get all NAME READY STATUS RESTARTS AGE pod/myapp-deployment-7df67f74c5-4nkmq 1/1 Running 0 5m27s pod/myapp-deployment-7df67f74c5-bnl9r 1/1 Running 0 5m27s pod/myapp-deployment-7df67f74c5-jsd9p 1/1 Running 0 5m27s NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE service/kubernetes ClusterIP 10.96.0.1 &amp;lt;none&amp;gt; 443/TCP 5d2h NAME READY UP-TO-DATE AVAILABLE AGE deployment.apps/myapp-deployment 3/3 3 3 5m27s NAME DESIRED CURRENT READY AGE replicaset.apps/myapp-deployment-7df67f74c5 3 3 3 5m27s μ•„μ§κΉμ§€λ” λ³„ μ°¨μ΄κ°€ μ—†μ§€μ”, deploymentκ°€ μƒκ²Όλ‹¤λ”κ²ƒ μ™Έμ—λ” λ§μ…λ‹λ‹¤. ν•μ§€λ§ μ‚¬μ‹¤μ€ μ΄μ™Έμ—λ„ revisionμ΄λΌλ” κ²ƒμ„ μƒμ„±ν•©λ‹λ‹¤. μ΄λ” ν•΄λ‹Ή deploymentλ¥Ό μ—…λ°μ΄νΈ ν• λ•λ§λ‹¤ μƒκΈ°κ³ , μ΄μ „ revisionμ μ •λ³΄λ„ κ°€μ§‘λ‹λ‹¤. λν•, μƒλ΅μ΄ λ²„μ „μ replicasetμ„ μƒμ„±ν•κ³ , μ΄μ „λ²„μ „μ replicasetμ μ •λ³΄λ¥Ό λ‚¨κ²¨λ†“μµλ‹λ‹¤. λ§μ•½μ— μ—…λ°μ΄νΈν›„μ— λ¬Έμ κ°€ μƒκ²Όμ„μ‹μ— λ΅¤λ°±μ„ κ°€λ¥μΌ€ ν•κΈ° μ„ν•΄μ„ μ…λ‹λ‹¤. κ·Έλ¦¬κ³  μ΄λ¬ν•μ μ΄ deploymentλ¥Ό μ‚¬μ©ν•΄μ„ podμ„ λ°°ν¬ν–μ„λ•λ‘ replicasetμ„ μ‚¬μ©ν–μ„λ•μ κ°€μ¥ ν° μ°¨μ΄μ μ΄ μ•„λ‹κΉ μ‹¶μµλ‹λ‹¤. Rollout μƒνƒν™•μΈ deploymentλ¥Ό μ‚¬μ©ν•μ—¬ podμ„ λ°°ν¬ν•κ²λλ©΄ rolloutμ„ μƒμ„±ν•λ‹¤κ³  ν–μ—λ”λ° μ¶”κ°€λ΅ μ‚¬μ©ν•  μ μλ” μ»¤λ§¨λ“λ„ μƒκΉλ‹λ‹¤. rollout μ΄λΌλ” μ»¤λ§¨λ“μΈλ°μ”. rollout μ»¤λ§¨λ“λ¥Ό ν†µν•μ—¬ deploymentμ revisionλ° historyλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤ kubectl rollout status deployment μ»¤λ§¨λ“λ¥Ό μ‚¬μ©ν•μ—¬ λ‹¤μκ³Ό κ°™μ΄ λ΅¤μ•„μ›ƒ μƒμ„±μ μƒνƒλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤. $ kubectl rollout status deployment/myapp-deployment Waiting for deployment &quot;myapp-deployment&quot; rollout to finish: 0 of 3 updated replicas are available... Waiting for deployment &quot;myapp-deployment&quot; rollout to finish: 1 of 3 updated replicas are available... Waiting for deployment &quot;myapp-deployment&quot; rollout to finish: 2 of 3 updated replicas are available... deployment &quot;myapp-deployment&quot; successfully rolled out Rollout history ν™•μΈ λν• kubectl rollout history deployment μ»¤λ§¨λ“λ¥Ό μ‚¬μ©ν•λ©΄ μ•„λμ™€ κ°™μ΄ λ¦¬λΉ„μ „ μ •λ³΄λ¥Ό ν™•μΈν•  μ μλ”λ°μ” $ kubectl rollout history deploy/myapp-deployment deployment.apps/myapp-deployment REVISION CHANGE-CAUSE 1 &amp;lt;none&amp;gt; ν•λ‚μ revision λ°–μ— λ³΄μ΄μ§€μ•μµλ‹λ‹¤. κ·Έ μ΄μ λ” depl.yamlμ„ μ΄μ©ν•μ—¬ μ²μμΌλ΅ λ°°ν¬ν• λ²„μ „μ΄κΈ° λ•λ¬Έμ…λ‹λ‹¤. Rollout update ν•΄λ‹Ή deploymentλ¥Ό μ—…λ°μ΄νΈν•λ©΄ μ–΄λ–¤μΌμ΄ μƒκΈ°λ”μ§€ λ³΄λ„λ΅ ν•κ² μµλ‹λ‹¤. μ°μ„  yamlνμΌμ„ μμ •ν•΄μ¤λ‹λ‹¤ #depl.yaml apiVersion: apps/v1 kind: Deployment metadata: name: myapp-deployment labels: app: myapp type: front-end spec: template: metadata: name: myapp-pod labels: app: myapp type: front-end spec: containers: - name: nginx-container image: nginx:1.20-alpine &amp;lt;----- λ°”λ€λ¶€λ¶„ replicas: 3 selector: matchLabels: type: front-end μ΄λ―Έμ§€λ¥Ό λ°”κΏ€λ•μ—λ” κ°„λ‹¨ν•κ² set imageλ¥Ό ν†µν•΄μ„λ„ κ°€λ¥ν•μ§€λ§ κ°μΈμ μΌλ΅ λ³€κ²½μƒν™©μ„ μ΄λ ¥μΌλ΅ λ‚¨κΈ°λ”κ² μΆ‹λ‹¤κ³  μƒκ°ν•μ—¬ ν•΄λ‹Ή λ°©λ²•μ„ μ‚¬μ©ν•©λ‹λ‹¤. λ³€κ²½μ‚¬ν•­μ„ μ μ©μ‹μΌμ¤λ‹λ‹¤. $ kubectl apply -f depl.yaml deployment.apps/myapp-deployment configured κ·Έλ‹¤μ replicasetκ³Ό revisionμ„ ν™•μΈν•΄λ΄…μ‹λ‹¤ $ kubectl get rs NAME DESIRED CURRENT READY AGE myapp-deployment-79896f8f68 3 3 3 5m14s myapp-deployment-7df67f74c5 0 0 0 5m42s replicasetμ΄ ν•λ‚λ” μƒκ²ΌμΌλ©°, revisionλ„ ν•λ‚λ” μƒκΈ΄κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤. $ kubectl rollout history deploy myapp-deployment deployment.apps/myapp-deployment REVISION CHANGE-CAUSE 2 &amp;lt;none&amp;gt; 1 &amp;lt;none&amp;gt; ν•μ§€λ§ change-causeκ°€ None μΌλ΅ λμμΌλ©΄ λ¬΄μ—‡μ΄ λ°”λ€μ—λ”μ§€ μ• μ κ°€μ—†λ”λ°, μ•„λ μ»¤λ§¨λ“λ¥Ό μ΄μ©ν•λ©΄ λ”°λ΅ μ„¤μ •μ΄ κ°€λ¥ν•©λ‹λ‹¤. kubectl annotate deployment.v1.apps/[deployment name] kubernetes.io/change-cause=&quot;reason of update&quot; ν•΄λ‹Ήμ»¤λ§¨λ“λ¥Ό μ‚¬μ©ν•μ—¬ μ£Όμ„μ„ λ‹¬κ³  λ‹¤μ‹ ν™•μΈν•΄λ΄…μ‹λ‹¤ $ kubectl annotate deployment.v1.apps/myapp-deployment kubernetes.io/change-cause=&quot;image updated to 1.20&quot; deployment.apps/myapp-deployment annotated $ kubectl rollout history deployment myapp-deployment deployment.apps/myapp-deployment REVISION CHANGE-CAUSE 1 &amp;lt;none&amp;gt; 2 image updated to 1.20 μ£Όμ„μ΄ μ λ‹¬λ¦°κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤. Rollback λ§μ•½μ— μƒλ΅μ΄ λ²„μ „μΌλ΅ μ—…λ°μ΄νΈλ¥Ό ν–λ”λ° λ¬Έμ κ°€ μƒκ²Όμ„λ• μ΄μ „ λ²„μ „ μΌλ΅ λμ•„κ° μ μλ” κΈ°λ¥μ…λ‹λ‹¤. kubeclt rollout undo deployment μ»¤λ§¨λ“λ¥Ό μ‚¬μ©ν•μ—¬ λ΅¤λ°± μ‹ν‚¬ μ μμµλ‹λ‹¤. μ§μ ‘ μ‹¤μµν•΄λ΄…μ‹λ‹¤. $ kubectl rollout undo deployment myapp-deployment deployment.apps/myapp-deployment rolled back μ„±κ³µμ μΌλ΅ λ΅¤λ°± λμ—λ‹¤κ³  λΉλ‹λ‹¤. μ°μ„  imageκ°€ λ‹¤μ‹ μ›λλ€λ΅ λμ•„μ™”λ”μ§€ ν™•μΈν•΄λ΄…λ‹λ‹¤ $ kubectl describe deployment myapp-deployment Name: myapp-deployment Namespace: default CreationTimestamp: Wed, 02 Jun 2021 07:05:06 +0000 Labels: app=myapp type=front-end Annotations: deployment.kubernetes.io/revision: 3 kubernetes.io/change-cause: Selector: type=front-end Replicas: 3 desired | 3 updated | 3 total | 3 available | 0 unavailable StrategyType: RollingUpdate MinReadySeconds: 0 RollingUpdateStrategy: 25% max unavailable, 25% max surge Pod Template: Labels: app=myapp type=front-end Containers: nginx-container: Image: nginx &amp;lt;------- 1.20 μ—μ„ λ‹¤μ‹ μ›λλ€λ΅ λμ•„μ¨κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤. Port: &amp;lt;none&amp;gt; Host Port: &amp;lt;none&amp;gt; Environment: &amp;lt;none&amp;gt; Mounts: &amp;lt;none&amp;gt; Volumes: &amp;lt;none&amp;gt; Conditions: Type Status Reason ---- ------ ------ Available True MinimumReplicasAvailable Progressing True NewReplicaSetAvailable OldReplicaSets: &amp;lt;none&amp;gt; NewReplicaSet: myapp-deployment-7df67f74c5 (3/3 replicas created) Events: Type Reason Age From Message ---- ------ ---- ---- ------- Normal ScalingReplicaSet 23m deployment-controller Scaled up replica set myapp-deployment-79896f8f68 to 1 Normal ScalingReplicaSet 23m deployment-controller Scaled down replica set myapp-deployment-7df67f74c5 to 2 Normal ScalingReplicaSet 23m deployment-controller Scaled up replica set myapp-deployment-79896f8f68 to 2 Normal ScalingReplicaSet 23m deployment-controller Scaled down replica set myapp-deployment-7df67f74c5 to 1 Normal ScalingReplicaSet 23m deployment-controller Scaled up replica set myapp-deployment-79896f8f68 to 3 Normal ScalingReplicaSet 23m deployment-controller Scaled down replica set myapp-deployment-7df67f74c5 to 0 Normal ScalingReplicaSet 4m28s deployment-controller Scaled up replica set myapp-deployment-7df67f74c5 to 1 Normal ScalingReplicaSet 4m24s deployment-controller Scaled down replica set myapp-deployment-79896f8f68 to 2 Normal ScalingReplicaSet 4m24s deployment-controller Scaled up replica set myapp-deployment-7df67f74c5 to 2 Normal ScalingReplicaSet 4m20s (x2 over 24m) deployment-controller Scaled up replica set myapp-deployment-7df67f74c5 to 3 Normal ScalingReplicaSet 4m20s deployment-controller Scaled down replica set myapp-deployment-79896f8f68 to 1 Normal ScalingReplicaSet 4m16s deployment-controller Scaled down replica set myapp-deployment-79896f8f68 to 0 κ·ΈλΌ replicasetκ³Ό revisionμ€ μ–΄λ–¨κΉμ”? #μ΄λ―Έμ§€ 1.20μΌλ΅ μ—…λ°μ΄νΈν›„ replicaset μƒνƒ $ kubectl get rs NAME DESIRED CURRENT READY AGE myapp-deployment-79896f8f68 3 3 3 5m14s myapp-deployment-7df67f74c5 0 0 0 5m42s #λ΅¤λ°±ν›„ replicasetμƒνƒ $ kubectl get rs NAME DESIRED CURRENT READY AGE myapp-deployment-79896f8f68 0 0 0 25m myapp-deployment-7df67f74c5 3 3 3 26m revision $ kubectl rollout history deployment myapp-deployment deployment.apps/myapp-deployment REVISION CHANGE-CAUSE 2 image updated to 1.20 3 &amp;lt;none&amp;gt; replicasetμ€ μ΄μ „ λ²„μ „μ replicasetμΌλ΅ λ°”λ€κ²ƒμ„ ν™•μΈν•  μκ°€ μλ”λ° revisionμ€ 1λ΅λμ•„κ°€λ”κ²ƒμ΄μ•„λ‹ 1μ΄ μ¦κ°€ν• κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤. μ—¬κΈ°μ„ κ¶κΈν•μ μ΄ μƒκ²Όμµλ‹λ‹¤. undoλ¥Ό μ—¬λ¬λ²ν•λ©΄ μ–΄λ–»κ²λ κΉμ”? $ kubectl rollout history deployment myapp-deployment deployment.apps/myapp-deployment REVISION CHANGE-CAUSE 3 &amp;lt;none&amp;gt; 4 image updated to 1.20 κ²°κ³Ό $ kubectl describe deployment myapp-deployment Name: myapp-deployment Namespace: default CreationTimestamp: Wed, 02 Jun 2021 07:05:06 +0000 Labels: app=myapp type=front-end Annotations: deployment.kubernetes.io/revision: 4 kubernetes.io/change-cause: image updated to 1.20 Selector: type=front-end Replicas: 3 desired | 3 updated | 3 total | 3 available | 0 unavailable StrategyType: RollingUpdate MinReadySeconds: 0 RollingUpdateStrategy: 25% max unavailable, 25% max surge Pod Template: Labels: app=myapp type=front-end Containers: nginx-container: Image: nginx:1.20 Port: &amp;lt;none&amp;gt; Host Port: &amp;lt;none&amp;gt; Environment: &amp;lt;none&amp;gt; Mounts: &amp;lt;none&amp;gt; Volumes: &amp;lt;none&amp;gt; Conditions: Type Status Reason ---- ------ ------ Available True MinimumReplicasAvailable Progressing True NewReplicaSetAvailable OldReplicaSets: &amp;lt;none&amp;gt; NewReplicaSet: myapp-deployment-79896f8f68 (3/3 replicas created) Events: Type Reason Age From Message ---- ------ ---- ---- ------- Normal ScalingReplicaSet 14m deployment-controller Scaled up replica set myapp-deployment-7df67f74c5 to 1 Normal ScalingReplicaSet 14m deployment-controller Scaled down replica set myapp-deployment-79896f8f68 to 2 Normal ScalingReplicaSet 14m deployment-controller Scaled up replica set myapp-deployment-7df67f74c5 to 2 Normal ScalingReplicaSet 14m (x2 over 33m) deployment-controller Scaled up replica set myapp-deployment-7df67f74c5 to 3 Normal ScalingReplicaSet 14m deployment-controller Scaled down replica set myapp-deployment-79896f8f68 to 1 Normal ScalingReplicaSet 13m deployment-controller Scaled down replica set myapp-deployment-79896f8f68 to 0 Normal ScalingReplicaSet 2m13s (x2 over 33m) deployment-controller Scaled up replica set myapp-deployment-79896f8f68 to 1 Normal ScalingReplicaSet 2m9s (x2 over 33m) deployment-controller Scaled down replica set myapp-deployment-7df67f74c5 to 2 Normal ScalingReplicaSet 2m9s (x2 over 33m) deployment-controller Scaled up replica set myapp-deployment-79896f8f68 to 2 Normal ScalingReplicaSet 2m5s (x2 over 33m) deployment-controller Scaled down replica set myapp-deployment-7df67f74c5 to 1 Normal ScalingReplicaSet 2m5s (x2 over 33m) deployment-controller Scaled up replica set myapp-deployment-79896f8f68 to 3 Normal ScalingReplicaSet 2m1s (x2 over 33m) deployment-controller Scaled down replica set myapp-deployment-7df67f74c5 to 0 undo λ¥Ό μ—¬λ¬λ²ν•λ‹ nginx &amp;lt;-&amp;gt; nginx:1.20 μ™”λ‹¤ κ°”λ‹¤ ν•λ” λ¨μµμ„ λ³΄μ—¬μ¤λ‹λ‹¤. :rocket: history historyλ¥Ό λ³΄μ•„λ„ λ‘μ¤„μ κ²°κ³Όλ§ λ³΄μ—¬μ£ΌκΈ°λ„ν–κ³ , μ •λ§ λ°”λ΅ μ΄μ „λ‹¨κ³„κΉμ§€λ§ μ΄λ™ν•  μ μλ”κ±΄μ§€λ„ κ¶κΈν–μµλ‹λ‹¤. κ¶κΈν•κ±΄ λ»μ°ΈκΈ°μ— λ°”λ΅ kubernetes.ioλ¥Ό μ°Ύλ‹¤λ³΄λ‹ μ›ν•λ” revisionμΌλ΅ κ°€λ ¤λ©΄ β€“to-revision=[resion-number] λ¥Ό μ…λ ¥ν•΄μ•Όλλ”κ²ƒμ„ μ• μ μμ—μµλ‹λ‹¤. deployment μ spec λ°‘μ— revisionHistoryLimit: 10 μΌλ΅ μ„¤μ •λμ–΄ μλ”κ²ƒλ„ ν™•μΈν–μΌλ©° μ΄ λν• μμ •ν•  μ μμ—κµ°μ” γ…γ… λ°”λ΅ μ΄μ „ λ‹¨κ³„λ§ μ΄λ™ κ°€λ¥ν•λ‹¤κ³  ν¬μ¤νΈ μ¬λ Έλ‹¤κ°€ νΈλ‹¤λ‹¥ μμ •ν•λ„¤μ” κ·Έλ‚μ €λ‚ historyμ—λ” μ™ μ‚¬λ ν–‡κ°λ¦¬κ² λ‘μ¤„λ§μ„ λ³΄μ—¬μ¤¬λ κ±ΈκΉμ”? kubernetesλ” μƒλ‹Ήν λ‘λ‘ν–κΈ° λ•λ¬Έμ…λ‹λ‹¤. μ΄λ―Έ κΈ°μ–µν•κ³ μλ” replicasetλ‘ λ‹¤λ¦„μ΄ μ—†κΈ°μ— μƒλ΅μ΄ replicasetμ„ μƒμ„±ν•μ§€ μ•λ”κ²ƒμ΄μ—μµλ‹λ‹¤. historyμ— μ—†λ” λ‹¤λ¥Έ λ²„μ „μ nginxμ μ΄λ―Έμ§€λ΅ λ°”κΎΈμ–΄μ£Όλ‹ replicasetκ³Ό history κ°κ° ν•λ‚μ”© λ” μƒκΈ°λ”κ²ƒμ„ ν™•μΈν•  μ μμ—μµλ‹λ‹¤. $ kubectl get rs NAME DESIRED CURRENT READY AGE myapp-deployment-54d59f8648 3 3 3 17m myapp-deployment-79896f8f68 0 0 0 117m myapp-deployment-7df67f74c5 0 0 0 118m $ kubectl rollout history deploy myapp-deployment deployment.apps/myapp-deployment REVISION CHANGE-CAUSE 3 image updated to 1.20 4 &amp;lt;none&amp;gt; 5 &amp;lt;none&amp;gt;</summary></entry><entry><title type="html">ssh config μ„¤μ •μΌλ΅ κ°„νΈν•κ² sshμ ‘μ†ν•κΈ°</title><link href="https://shjeong92.github.io/2021/06/01/Handling-ssh-config.html" rel="alternate" type="text/html" title="ssh config μ„¤μ •μΌλ΅ κ°„νΈν•κ² sshμ ‘μ†ν•κΈ°" /><published>2021-06-01T00:00:00+09:00</published><updated>2021-06-01T00:00:00+09:00</updated><id>https://shjeong92.github.io/2021/06/01/Handling-ssh-config</id><content type="html" xml:base="https://shjeong92.github.io/2021/06/01/Handling-ssh-config.html">&lt;p&gt;μµκ·Ό λ‡μΌκ°„ kubernetesλ¥Ό κ³µλ¶€ν•λ©΄μ„ κµ¬κΈ€ ν΄λΌμ°λ“μ— sshμ ‘μ†μ„ ν•λ”μΌμ΄ μ¦μ•λ”λ°μ”, μ ‘μ† ν•  λ•λ§λ‹¤ κµ¬κΈ€ ν΄λΌμ°λ“μ— μ ‘μ†ν•΄μ„ μΈμ¤ν„΄μ¤μ μ™Έλ¶€ IPλ¥Ό ν™•μΈ ν•μ—¬μ•Όν•κ³  κΈ΄ ssh μ ‘μ†λ¬Έμ„ μ“°λ”κ² κ·€μ°®μ•λ”λ° μ•κ³ λ³΄λ‹ μ΄λ¥Ό κ°„νΈν•κ² ν•΄μ£Όλ” μ„¤μ •μ΄ μλ”κµ°μ”.&lt;/p&gt;

&lt;p&gt;μ΄ κΈ€μ—μ„  λ§¥μ—μ„ GCPμ— μ ‘μ†ν•κΈ° μ„ν• &lt;code&gt;RSA key pair&lt;/code&gt;λ¥Ό μƒμ„±ν•λ” λ¶€λ¶„λ¶€ν„° &lt;code&gt;ssh config&lt;/code&gt; μ„¤μ •ν•λ”λ²•μ„ λ‹¤λ£¨κ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;h2 id=&quot;key-pair-μƒμ„±ν•κΈ°&quot;&gt;key pair μƒμ„±ν•κΈ°&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#-t μ•”νΈν™”νƒ€μ… -f key pair μ €μ¥ν•  μ„μΉ -C μ£Όμ„(λ³΄ν†µ μ‚¬μ©μ λ΅κ·ΈμΈIDλ¥Ό μ μ)
$ssh-keygen -t rsa -f ~/.ssh/&amp;lt;KEY_FILE_NAME&amp;gt; -C &quot;account@gmail.com&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ„μ™€κ°™μ΄ μ…λ ¥ν•λ©΄ RSA key pairκ°€ μƒμ„±λ©λ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; rsa &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ~/.ssh/test &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;test@gmail.com&quot;&lt;/span&gt;
Generating public/private rsa key pair.
Enter passphrase &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;no passphrase&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 
Enter same passphrase again: 
Your identification has been saved &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /Users/sanghyukjeong/.ssh/test.
Your public key has been saved &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /Users/sanghyukjeong/.ssh/test.pub.
The key fingerprint is:
SHA256:6TjvkM1IFHeI5ywCVgt8DFJpqiK+K4SZO4eTuBcEHkQ &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;@gmail.com
The key&lt;span class=&quot;s1&quot;&gt;&apos;s randomart image is:
+---[RSA 3072]----+
|+E+=. .....      |
|.o*.o..oo.       |
|.=.o. .+         |
|... ... o.       |
|o+   ...S        |
|B..  . B         |
|*+ .  * +        |
|O.o    +         |
|oOo    .o        |
+----[SHA256]-----+
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ΄ν›„ catλ…λ Ήμ–΄λ΅ rsa κ³µκ°ν‚¤λ¥Ό ν™•μΈν•  μ μλ”λ°
κµ¬κΈ€ ν΄λΌμ°λ“ μΈμ¤ν„΄μ¤μ— μ΄ ν‚¤λ¥Ό λ“±λ΅ν•κΈ°μ„ν•΄ λ³µμ‚¬ ν•΄λ†“μµλ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; ~/.ssh/test.pub
ssh-rsa AAAB3NzaC1yc2EAAAADAQABAAABgQDIlHiLTIM6oCQtjILfmIaTZv6j37J0kZNNjIgK0dFOxSYnMgXirh8gbRqFQY7kMWXZwAo82akxyTAP65GcjsqR+L1RarkKlYA7/lj7rvAf2VMJXy0X6yCbGo3yHcPGEoWLlsOgeYZDAk3Wld/hGdBWKXX4404iUQygjWbIircQ6BNZBb14nbhJK+pLWXMB7TmaRvtDsumBAko0shkA5g6y1oNGdpGBsUTQHk+rqQhqZElP9hgXp71qGhTO0V11kH41n0beReBoi9YngrpJtu6b4h1Ttm4N7CpCU5rUW38i5s71aInLuPolCDXlA8b6qVtBqg6dQ6/IgNQgQFRpwIkcf4v0EHKygcdm+QM25x3VAx1XC51gqHxhdU71/24EiUw0EW3cIvER6150aZF3PiAe5odstk9vx4L/1Vtu1GySQ2Qz8LcK1J3lawh3i8yaobVPUOIOxGDhme+tRMuyy16PhumtxSI5SeSwoIhYEIZtHKHFHKztNGV6m5aNSLZwzbk&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;@gmail.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;key-λ“±λ΅ν•κΈ°&quot;&gt;key λ“±λ΅ν•κΈ°&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/75003424/120263396-9136a700-c2d6-11eb-8c97-65769591c66c.png&quot; alt=&quot;gcp&quot; /&gt;&lt;/p&gt;

&lt;p&gt;computeμ—”μ§„ -&amp;gt; λ©”νƒ€λ°μ΄ν„° -&amp;gt; SSH ν‚¤λ΅ μ΄λ™ν›„μ—&lt;/p&gt;

&lt;p&gt;ν•­λ©μ¶”κ°€λ¥Ό ν΄λ¦­ν•μ—¬ κ³µκ°ν‚¤λ¥Ό μ¶”κ°€ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;ν‚¤λ“±λ΅μ΄ λλ‚¬μΌλ‹ ssh μ ‘μ†μ„ ν•΄λ΄…μ‹λ‹¤&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; ~/.ssh/test yourID@your.gcloudExternal.ip

Welcome to Ubuntu 18.04.5 LTS &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux 5.4.0-1043-gcp x86_64&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Documentation:  https://help.ubuntu.com
 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Management:     https://landscape.canonical.com
 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Support:        https://ubuntu.com/advantage

  System information as of Tue Jun  1 03:44:22 UTC 2021

  System load:  0.27               Users logged &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;:        0
  Usage of /:   14.2% of 28.90GB   IP address &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;ens4:    10.178.0.2
  Memory usage: 44%                IP address &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;docker0: 172.17.0.1
  Swap usage:   0%                 IP address &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;cni0:    10.244.0.1
  Processes:    143

 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Super-optimized &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;small spaces - &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;how we shrank the memory
   footprint of MicroK8s to make it the smallest full K8s around.

   https://ubuntu.com/blog/microk8s-memory-optimisation
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ μ ‘μ† λλ”κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ·Έλ¬λ‚ μ ‘μ†ν• λ•λ§λ‹¤ μ € μ»¤λ§¨λ“λ¥Ό λ‹¤ μ…λ ¥ν•λ”κ²ƒμ€ μ°Έ κ·€μ°®μ€μΌμ…λ‹λ‹¤. ipμ •λ„λ” ν•λ²λ³΄λ©΄ μ™Έμ°μ‹λ”λ¶„μ΄ μ•„λ‹λΌλ©΄μ” γ…γ…&lt;/p&gt;

&lt;p&gt;μ΄μ  ssh configνμΌ μ„¤μ •μ—λ€ν•΄ μ•μ•„λ΄…μ‹λ‹¤&lt;/p&gt;

&lt;h2 id=&quot;ssh-config-μ„¤μ •ν•μ—¬-ssh-μ ‘μ†-κ°„νΈν•κ²-ν•κΈ°&quot;&gt;ssh config μ„¤μ •ν•μ—¬ ssh μ ‘μ† κ°„νΈν•κ² ν•κΈ°&lt;/h2&gt;

&lt;p&gt;Linux/Unixμ„λ²„ μ ‘μ† κ³„μ •λ“¤μ„ μ—¬λ¬ κ°€μ§€ κ΄€λ¦¬ν•λ” κ²½μ°, λ³„λ„λ΅ λ©”λ¨λ‚ νμΌμ— μ ‘μ† κ³„μ • / λΉ„λ°€λ²νΈ λ“±μ„ κ΄€λ¦¬ν•κ±°λ‚ aliasμ— μ ‘μ† λ…λ Ήμ–΄λ¥Ό μ„¤μ •ν•λ” λ²κ±°λ΅μ›€μ΄ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;ν•μ§€λ§ .ssh κ²½λ΅ λ°‘ config νμΌμ— κ³„μ • μ •λ³΄λ“¤μ„ μ €μ¥ν•μ—¬ κ΄€λ¦¬ν•λ©΄ μ •λ§ νΈλ¦¬ν•κ² μ ‘μ†λ“¤μ„ κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ°μ„  μ‚¬μ©μ ν™ λ””λ ‰ν† λ¦¬μ—μ„ .ssh ν΄λ”λ΅ μ ‘κ·Όν•©λ‹λ‹¤. .ssh ν΄λ”λ” ssh μ ‘μ†μ„ ν• λ²μ΄λΌλ„ ν–λ‹¤λ©΄, rsa νμΌμ΄λ‚ known_hosts λ“±μ΄ μƒμ„±λκΈ° λ•λ¬Έμ— μλ™μΌλ΅ μƒμ„±λλ” λ””λ ‰ν† λ¦¬μ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;ν™λ””λ ‰ν† λ¦¬μ— μλ” .sshν΄λ”μ— λ“¤μ–΄κ°€μ„ config νμΌμ„ μƒμ„±ν•΄μ¤λ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/.ssh

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vim config
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Host gcloud
        HostName 10.178.0.3
        User shjeong920522
        IdentityFile: ~/.ssh/test
        Port 22
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Host: μ ‘μ†ν•  μ •λ³΄μ μ΄λ¦„μ…λ‹λ‹¤.&lt;/li&gt;
  &lt;li&gt;HostName: μ ‘μ†ν•  μ„λ²„μ μ™Έλ¶€ IP μ£Όμ†λ¥Ό μ…λ ¥ν•μ„Έμ”&lt;/li&gt;
  &lt;li&gt;User: μ ‘μ†ν•  μ„λ²„μ user μ •λ³΄μ…λ‹λ‹¤.&lt;/li&gt;
  &lt;li&gt;IdentityFile: μΈμ¦ ν‚¤νμΌμ΄ ν•„μ”ν• κ²½μ°, ν‚¤νμΌ κ²½λ΅λ¥Ό μ„¤μ •ν•©λ‹λ‹¤. μ΄μ „ λ‹¨κ³„μ— rsa ν‚¤νμ–΄ λ§λ“ κ±° κΈ°μ–µλ‚μ‹μ£ ?&lt;/li&gt;
  &lt;li&gt;Port: ssh μ ‘μ† ν¬νΈμ…λ‹λ‹¤. μƒλµ κ°€λ¥ν•λ©°, μƒλµν•  κ²½μ°μ— λ””ν΄νΈλ΅ 22λ² ν¬νΈλ΅ μ‹¤μƒλ©λ‹λ‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;λ¨λ“  μ„¤μ •μ΄ λλ‚¬μΌλ‹ google cloudμ— μ ‘μ†ν•΄λ³΄κ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# config μ—μ„ Hostμ— λ“±λ΅ν• μ ‘μ†ν•  μ •λ³΄λ§ μ μ–΄μ£Όλ©΄ μ ‘μ†μ΄λλ” λ§λ²•....&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh gcloud
Welcome to Ubuntu 18.04.5 LTS &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux 5.4.0-1043-gcp x86_64&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Documentation:  https://help.ubuntu.com
 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Management:     https://landscape.canonical.com
 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Support:        https://ubuntu.com/advantage

  System information as of Tue Jun  1 04:05:52 UTC 2021

  System load:  0.65               Users logged &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;:        0
  Usage of /:   14.2% of 28.90GB   IP address &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;ens4:    12.178.0.2
  Memory usage: 44%                IP address &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;docker0: 172.17.0.1
  Swap usage:   0%                 IP address &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;cni0:    12.244.0.1
  Processes:    144

 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Super-optimized &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;small spaces - &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;how we shrank the memory
   footprint of MicroK8s to make it the smallest full K8s around.

   https://ubuntu.com/blog/microk8s-memory-optimisation

11 updates can be applied immediately.
To see these additional updates run: apt list &lt;span class=&quot;nt&quot;&gt;--upgradable&lt;/span&gt;

New release &lt;span class=&quot;s1&quot;&gt;&apos;20.04.2 LTS&apos;&lt;/span&gt; available.
Run &lt;span class=&quot;s1&quot;&gt;&apos;do-release-upgrade&apos;&lt;/span&gt; to upgrade to it.


Last login: Tue Jun  1 03:44:23 2021 from 122.32.103.55
shjeong920522@master:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ΄λ ‡κ² ν•λ² μ„¤μ •ν•΄ λ†“μΌλ©΄ μ™Έλ¶€ ipν¬νΈ ν™•μΈν•λ¬ gcloud μ½μ†”μ— μ ‘μ†ν•μ§€ μ•μ•„λ„λκ³ , μ •λ§ κ°„νΈν•κ² ssh μ ‘μ†μ„ ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;</content><author><name>Sanghyuk Jeong</name><email>shjeong920522@gmail.com</email></author><category term="gcloud" /><category term="ssh" /><category term="key-gen" /><category term="rsa" /><category term="config" /><summary type="html">μµκ·Ό λ‡μΌκ°„ kubernetesλ¥Ό κ³µλ¶€ν•λ©΄μ„ κµ¬κΈ€ ν΄λΌμ°λ“μ— sshμ ‘μ†μ„ ν•λ”μΌμ΄ μ¦μ•λ”λ°μ”, μ ‘μ† ν•  λ•λ§λ‹¤ κµ¬κΈ€ ν΄λΌμ°λ“μ— μ ‘μ†ν•΄μ„ μΈμ¤ν„΄μ¤μ μ™Έλ¶€ IPλ¥Ό ν™•μΈ ν•μ—¬μ•Όν•κ³  κΈ΄ ssh μ ‘μ†λ¬Έμ„ μ“°λ”κ² κ·€μ°®μ•λ”λ° μ•κ³ λ³΄λ‹ μ΄λ¥Ό κ°„νΈν•κ² ν•΄μ£Όλ” μ„¤μ •μ΄ μλ”κµ°μ”. μ΄ κΈ€μ—μ„  λ§¥μ—μ„ GCPμ— μ ‘μ†ν•κΈ° μ„ν• RSA key pairλ¥Ό μƒμ„±ν•λ” λ¶€λ¶„λ¶€ν„° ssh config μ„¤μ •ν•λ”λ²•μ„ λ‹¤λ£¨κ² μµλ‹λ‹¤. key pair μƒμ„±ν•κΈ° #-t μ•”νΈν™”νƒ€μ… -f key pair μ €μ¥ν•  μ„μΉ -C μ£Όμ„(λ³΄ν†µ μ‚¬μ©μ λ΅κ·ΈμΈIDλ¥Ό μ μ) $ssh-keygen -t rsa -f ~/.ssh/&amp;lt;KEY_FILE_NAME&amp;gt; -C &quot;account@gmail.com&quot; μ„μ™€κ°™μ΄ μ…λ ¥ν•λ©΄ RSA key pairκ°€ μƒμ„±λ©λ‹λ‹¤. ssh-keygen -t rsa -f ~/.ssh/test -C &quot;test@gmail.com&quot; Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /Users/sanghyukjeong/.ssh/test. Your public key has been saved in /Users/sanghyukjeong/.ssh/test.pub. The key fingerprint is: SHA256:6TjvkM1IFHeI5ywCVgt8DFJpqiK+K4SZO4eTuBcEHkQ test@gmail.com The key&apos;s randomart image is: +---[RSA 3072]----+ |+E+=. ..... | |.o*.o..oo. | |.=.o. .+ | |... ... o. | |o+ ...S | |B.. . B | |*+ . * + | |O.o + | |oOo .o | +----[SHA256]-----+ μ΄ν›„ catλ…λ Ήμ–΄λ΅ rsa κ³µκ°ν‚¤λ¥Ό ν™•μΈν•  μ μλ”λ° κµ¬κΈ€ ν΄λΌμ°λ“ μΈμ¤ν„΄μ¤μ— μ΄ ν‚¤λ¥Ό λ“±λ΅ν•κΈ°μ„ν•΄ λ³µμ‚¬ ν•΄λ†“μµλ‹λ‹¤. $ cat ~/.ssh/test.pub ssh-rsa AAAB3NzaC1yc2EAAAADAQABAAABgQDIlHiLTIM6oCQtjILfmIaTZv6j37J0kZNNjIgK0dFOxSYnMgXirh8gbRqFQY7kMWXZwAo82akxyTAP65GcjsqR+L1RarkKlYA7/lj7rvAf2VMJXy0X6yCbGo3yHcPGEoWLlsOgeYZDAk3Wld/hGdBWKXX4404iUQygjWbIircQ6BNZBb14nbhJK+pLWXMB7TmaRvtDsumBAko0shkA5g6y1oNGdpGBsUTQHk+rqQhqZElP9hgXp71qGhTO0V11kH41n0beReBoi9YngrpJtu6b4h1Ttm4N7CpCU5rUW38i5s71aInLuPolCDXlA8b6qVtBqg6dQ6/IgNQgQFRpwIkcf4v0EHKygcdm+QM25x3VAx1XC51gqHxhdU71/24EiUw0EW3cIvER6150aZF3PiAe5odstk9vx4L/1Vtu1GySQ2Qz8LcK1J3lawh3i8yaobVPUOIOxGDhme+tRMuyy16PhumtxSI5SeSwoIhYEIZtHKHFHKztNGV6m5aNSLZwzbk= test@gmail.com key λ“±λ΅ν•κΈ° computeμ—”μ§„ -&amp;gt; λ©”νƒ€λ°μ΄ν„° -&amp;gt; SSH ν‚¤λ΅ μ΄λ™ν›„μ— ν•­λ©μ¶”κ°€λ¥Ό ν΄λ¦­ν•μ—¬ κ³µκ°ν‚¤λ¥Ό μ¶”κ°€ν•©λ‹λ‹¤. ν‚¤λ“±λ΅μ΄ λλ‚¬μΌλ‹ ssh μ ‘μ†μ„ ν•΄λ΄…μ‹λ‹¤ $ ssh -i ~/.ssh/test yourID@your.gcloudExternal.ip Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 5.4.0-1043-gcp x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue Jun 1 03:44:22 UTC 2021 System load: 0.27 Users logged in: 0 Usage of /: 14.2% of 28.90GB IP address for ens4: 10.178.0.2 Memory usage: 44% IP address for docker0: 172.17.0.1 Swap usage: 0% IP address for cni0: 10.244.0.1 Processes: 143 * Super-optimized for small spaces - read how we shrank the memory footprint of MicroK8s to make it the smallest full K8s around. https://ubuntu.com/blog/microk8s-memory-optimisation μ μ ‘μ† λλ”κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤. κ·Έλ¬λ‚ μ ‘μ†ν• λ•λ§λ‹¤ μ € μ»¤λ§¨λ“λ¥Ό λ‹¤ μ…λ ¥ν•λ”κ²ƒμ€ μ°Έ κ·€μ°®μ€μΌμ…λ‹λ‹¤. ipμ •λ„λ” ν•λ²λ³΄λ©΄ μ™Έμ°μ‹λ”λ¶„μ΄ μ•„λ‹λΌλ©΄μ” γ…γ… μ΄μ  ssh configνμΌ μ„¤μ •μ—λ€ν•΄ μ•μ•„λ΄…μ‹λ‹¤ ssh config μ„¤μ •ν•μ—¬ ssh μ ‘μ† κ°„νΈν•κ² ν•κΈ° Linux/Unixμ„λ²„ μ ‘μ† κ³„μ •λ“¤μ„ μ—¬λ¬ κ°€μ§€ κ΄€λ¦¬ν•λ” κ²½μ°, λ³„λ„λ΅ λ©”λ¨λ‚ νμΌμ— μ ‘μ† κ³„μ • / λΉ„λ°€λ²νΈ λ“±μ„ κ΄€λ¦¬ν•κ±°λ‚ aliasμ— μ ‘μ† λ…λ Ήμ–΄λ¥Ό μ„¤μ •ν•λ” λ²κ±°λ΅μ›€μ΄ μμµλ‹λ‹¤. ν•μ§€λ§ .ssh κ²½λ΅ λ°‘ config νμΌμ— κ³„μ • μ •λ³΄λ“¤μ„ μ €μ¥ν•μ—¬ κ΄€λ¦¬ν•λ©΄ μ •λ§ νΈλ¦¬ν•κ² μ ‘μ†λ“¤μ„ κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤. μ°μ„  μ‚¬μ©μ ν™ λ””λ ‰ν† λ¦¬μ—μ„ .ssh ν΄λ”λ΅ μ ‘κ·Όν•©λ‹λ‹¤. .ssh ν΄λ”λ” ssh μ ‘μ†μ„ ν• λ²μ΄λΌλ„ ν–λ‹¤λ©΄, rsa νμΌμ΄λ‚ known_hosts λ“±μ΄ μƒμ„±λκΈ° λ•λ¬Έμ— μλ™μΌλ΅ μƒμ„±λλ” λ””λ ‰ν† λ¦¬μ…λ‹λ‹¤. ν™λ””λ ‰ν† λ¦¬μ— μλ” .sshν΄λ”μ— λ“¤μ–΄κ°€μ„ config νμΌμ„ μƒμ„±ν•΄μ¤λ‹λ‹¤. $ cd ~/.ssh $ vim config Host gcloud HostName 10.178.0.3 User shjeong920522 IdentityFile: ~/.ssh/test Port 22 Host: μ ‘μ†ν•  μ •λ³΄μ μ΄λ¦„μ…λ‹λ‹¤. HostName: μ ‘μ†ν•  μ„λ²„μ μ™Έλ¶€ IP μ£Όμ†λ¥Ό μ…λ ¥ν•μ„Έμ” User: μ ‘μ†ν•  μ„λ²„μ user μ •λ³΄μ…λ‹λ‹¤. IdentityFile: μΈμ¦ ν‚¤νμΌμ΄ ν•„μ”ν• κ²½μ°, ν‚¤νμΌ κ²½λ΅λ¥Ό μ„¤μ •ν•©λ‹λ‹¤. μ΄μ „ λ‹¨κ³„μ— rsa ν‚¤νμ–΄ λ§λ“ κ±° κΈ°μ–µλ‚μ‹μ£ ? Port: ssh μ ‘μ† ν¬νΈμ…λ‹λ‹¤. μƒλµ κ°€λ¥ν•λ©°, μƒλµν•  κ²½μ°μ— λ””ν΄νΈλ΅ 22λ² ν¬νΈλ΅ μ‹¤μƒλ©λ‹λ‹¤. λ¨λ“  μ„¤μ •μ΄ λλ‚¬μΌλ‹ google cloudμ— μ ‘μ†ν•΄λ³΄κ² μµλ‹λ‹¤. # config μ—μ„ Hostμ— λ“±λ΅ν• μ ‘μ†ν•  μ •λ³΄λ§ μ μ–΄μ£Όλ©΄ μ ‘μ†μ΄λλ” λ§λ²•.... $ ssh gcloud Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 5.4.0-1043-gcp x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue Jun 1 04:05:52 UTC 2021 System load: 0.65 Users logged in: 0 Usage of /: 14.2% of 28.90GB IP address for ens4: 12.178.0.2 Memory usage: 44% IP address for docker0: 172.17.0.1 Swap usage: 0% IP address for cni0: 12.244.0.1 Processes: 144 * Super-optimized for small spaces - read how we shrank the memory footprint of MicroK8s to make it the smallest full K8s around. https://ubuntu.com/blog/microk8s-memory-optimisation 11 updates can be applied immediately. To see these additional updates run: apt list --upgradable New release &apos;20.04.2 LTS&apos; available. Run &apos;do-release-upgrade&apos; to upgrade to it. Last login: Tue Jun 1 03:44:23 2021 from 122.32.103.55 shjeong920522@master:~$ μ΄λ ‡κ² ν•λ² μ„¤μ •ν•΄ λ†“μΌλ©΄ μ™Έλ¶€ ipν¬νΈ ν™•μΈν•λ¬ gcloud μ½μ†”μ— μ ‘μ†ν•μ§€ μ•μ•„λ„λκ³ , μ •λ§ κ°„νΈν•κ² ssh μ ‘μ†μ„ ν•  μ μμµλ‹λ‹¤.</summary></entry><entry><title type="html">[ #6 ] static pod</title><link href="https://shjeong92.github.io/2021/05/31/Learning-Kubernetes-06.html" rel="alternate" type="text/html" title="[ #6 ] static pod" /><published>2021-05-31T00:00:00+09:00</published><updated>2021-05-31T00:00:00+09:00</updated><id>https://shjeong92.github.io/2021/05/31/Learning-Kubernetes-06</id><content type="html" xml:base="https://shjeong92.github.io/2021/05/31/Learning-Kubernetes-06.html">&lt;h2 id=&quot;static-podsμ΄λ€&quot;&gt;Static podsμ΄λ€&lt;/h2&gt;

&lt;p&gt;μ μΌ μ²μμ— kubernetesμ κµ¬μ΅°μ—μ„ κ³µλ¶€ν–μ„λ• λ§μ¤ν„°λ…Έλ“μ— &lt;code&gt;kube-apiserver&lt;/code&gt;κ°€ μκ³ , κ° μ›μ»¤λ…Έλ“μ—λ” &lt;code&gt;kubelet&lt;/code&gt; μ΄ μ΅΄μ¬ν•λ©° λ§μ¤ν„°λ…Έλ“μ kube-apiserverμ λ…λ Ήμ—λ”°λΌ podμ„ μ§€μ°κ±°λ‚ μ‚­μ ν•κ±°λ‚ ν–μ—μ£ . &lt;br /&gt;
μ΄λ² μ‹κ°„μ—λ” λ§μ¤ν„° λ…Έλ“μ kube-schedulerμ μν–¥μ„ λ°›μ§€ μ•λ” Static pod μ— λ€ν•΄μ„ μ•μ•„λ³΄κ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;κ° μ›μ»¤λ…Έλ“μ— μ΅΄μ¬ν•λ” kubelet λν• podμ΄ μ£½κ±°λ‚ μ—λ¬κ°€ λ°μƒν–μ„λ–„ μ•„λμ λ°©λ²•μΌλ΅ λ‹¤μ‹ μ‚΄λ¦΄ μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;μ°μ„  static podμ„ μƒμ„±ν•  λ…Έλ“λ¥Ό μ„ νƒν•μ—¬ ssh μ ‘μ†ν•΄μ¤λ‹λ‹¤. μ €λ” worker-1μ— μ ‘μ†ν•λ„λ΅ ν•κ² μµλ‹λ‹¤&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl get nodes &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; wide
NAME         STATUS   ROLES                  AGE    VERSION
instance-1   Ready    &amp;lt;none&amp;gt;                 3d3h   v1.21.1
master       Ready    control-plane,master   3d3h   v1.21.1
worker-1     Ready    &amp;lt;none&amp;gt;                 3d3h   v1.21.1
worker-2     Ready    &amp;lt;none&amp;gt;                 3d3h   v1.21.1

&lt;span class=&quot;c&quot;&gt;#worker μ— μ ‘μ†ν•κΈ°&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; ~/.ssh/rsa-gcp-worker-1 shjeong920522@10.178.0.5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;νΉμ§•-1&quot;&gt;νΉμ§• 1&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;kubelet&lt;/strong&gt; μ€ κΈ°λ³Έμ μΌλ΅ /etc/kubernetes/manifests νμΌμ•μ pod.yaml μ„ λ°”λΌλ³΄λ”λ°, μ΄λ” kubelet.service μ config.yamlνμΌμ•μ— staticPodPathμ— μ •μλμ–΄μμµλ‹λ‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;μ§μ ‘ ν™•μΈν•΄λ΄…μ‹λ‹¤&lt;/p&gt;

&lt;p&gt;μ°μ„  μ•„λ μ»¤λ§¨λ“λ¥Ό μ…λ ¥ν•μ—¬ config.yamlνμΌμ μ„μΉλ¥Ό μ•μ•„λƒ…λ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# λ¨λ“ μ„λΉ„μ¤ ν™•μ¥ | kubelet μ •λ³΄μ¤‘μ—μ„ | --config ν¬ν•¨ν•λ”μ¤„ κ°€μ Έμ¤κΈ°&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps &lt;span class=&quot;nt&quot;&gt;-ef&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;kubelet | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-config&quot;&lt;/span&gt;
root     18270     1  1 May28 ?        01:31:14 /usr/bin/kubelet &lt;span class=&quot;nt&quot;&gt;--bootstrap-kubeconfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/bootstrap-kubelet.conf &lt;span class=&quot;nt&quot;&gt;--kubeconfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/kubernetes/kubelet.conf &lt;span class=&quot;nt&quot;&gt;--config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/kubelet/config.yaml &lt;span class=&quot;nt&quot;&gt;--network-plugin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cni &lt;span class=&quot;nt&quot;&gt;--pod-infra-container-image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;k8s.gcr.io/pause:3.4.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ν•΄λ‹Ή νμΌμ„ ν™•μΈν•΄ λ΄…μ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s&quot;&gt;$ sudo vi config=/var/lib/kubelet/config.yaml&lt;/span&gt;

&lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;kubelet.config.k8s.io/v1beta1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;authentication&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;anonymous&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;enabled&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;false&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;webhook&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;cacheTTL&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;enabled&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;x509&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;clientCAFile&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/etc/kubernetes/pki/ca.crt&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;authorization&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Webhook&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;webhook&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;cacheAuthorizedTTL&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;cacheUnauthorizedTTL&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;cgroupDriver&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;systemd&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;clusterDNS&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;10.96.0.10&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;clusterDomain&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cluster.local&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;cpuManagerReconcilePeriod&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;evictionPressureTransitionPeriod&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;fileCheckFrequency&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;healthzBindAddress&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;127.0.0.1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;healthzPort&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10248&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;httpCheckFrequency&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;imageMinimumGCAge&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;KubeletConfiguration&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;logging&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;{}&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;nodeStatusReportFrequency&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;nodeStatusUpdateFrequency&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;resolvConf&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/run/systemd/resolve/resolv.conf&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;rotateCertificates&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;runtimeRequestTimeout&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;shutdownGracePeriod&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;shutdownGracePeriodCriticalPods&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;staticPodPath&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/etc/kubernetes/manifests        &amp;lt;------------------------------ staticPodPath κ°€ μ„¤μ •λμ–΄ μλ”κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;streamingConnectionIdleTimeout&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;syncFrequency&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;volumeStatsAggPeriod&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0s&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;μ„μ™€ κ°™μ΄ νμΌμ„ ν†µμΌλ΅ ν™•μΈν•΄λ³΄μ•„λ„ λμ§€λ§ grepλ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•λ©΄ λ”μ± νΈν μ°Ύμ„ μλ„ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo grep &lt;/span&gt;static /var/lib/kubelet/config.yaml
staticPodPath: /etc/kubernetes/manifests
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;νΉμ§•-2&quot;&gt;νΉμ§• 2&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;λ§μ•½ ν•΄λ™ ν΄λ”λ‚΄μ— kind: PodμΈ yaml νμΌμ΄μλ‹¤λ©΄ kubeletμ΄ μλ™μΌλ΅ μ΄λ¥Ό μƒμ„±ν•λ©° static podμ μ΄λ¦„μ—λ” μλ™μΌλ΅ ν•΄λ‹Ή λ…Έλ“μ μ΄λ¦„μ΄ suffixλ΅ λ¶™μµλ‹λ‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;μ μƒμ„±λλ‚ ν™•μΈν•΄ λ΄…μ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /etc/kubernetes/manifests
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;vi static.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;κ°„λ‹¨ν• podμ„ ν•΄λ‹Ή λ³Όλ”μ— μƒμ„±ν•΄μ¤λ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#static.yaml&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;v1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Pod&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp-pod&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;front-end&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx-container&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;λ§μ¤ν„°&lt;/strong&gt; λ…Έλ“λ΅ μ΄λ™ν•μ—¬ ν™•μΈν•΄λ΄…μ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl get pods
NAME                 READY   STATUS    RESTARTS   AGE
myapp-pod-worker-1   1/1     Running   0          42m
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;static podλ¥Ό μƒμ„±ν• λ…Έλ“μ μ΄λ¦„μΈ worker-1 κ°€ Podμ΄λ¦„μ suffixλ΅ λ¶™μ–΄μλ”κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;h3 id=&quot;νΉμ§•-3&quot;&gt;νΉμ§• 3&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;λ§μ¤ν„°λ…Έλ“μ—μ„ kubectl delete λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•λ”λΌλ„ μ›μ»¤λ…Έλ“μ kubeletμ΄ λ‹¤μ‹ μ‚΄λ ¤λƒ…λ‹λ‹¤. static podλ” ν•΄λ‹Ή μ›μ»¤λ…Έλ“μ kubeletμ΄ κ΄€λ¦¬ν•κΈ° λ–„λ¬Έμ…λ‹λ‹¤.
λ”°λΌμ„ ν•΄λ‹Ή podμ imageλ¥Ό λ³€κ²½ν•κ³ μ‹¶λ‹¤λ©΄ manifest ν΄λ”μ•μ ν•΄λ‹Ή yamlνμΌμ μ΄λ―Έμ§€λ¥Ό μμ •ν•΄μ•Όν•κ³ , μ§€μ°λ ¤λ©΄ ν•΄λ‹Ή yamlνμΌμ„ μ‚­μ ν•λ©΄ λ©λ‹λ‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;κ·ΈλΌ μ •λ§λ΅ λ‹¤μ‹ μ‹μ‘λλ”μ§€ λ§μ¤ν„°λ…Έλ“μ—μ„ &lt;strong&gt;myapp-pod-worker-1&lt;/strong&gt;μ„ μ‚­μ ν•΄ λ΄…μ‹λ‹¤&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl delete pod myapp-pod-worker-1
pod &lt;span class=&quot;s2&quot;&gt;&quot;myapp-pod-worker-1&quot;&lt;/span&gt; deleted
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;μ§€μ΄λ‹¤μμ— λ°”λ΅ ν™•μΈν•΄λ³΄λ©΄&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl get pods
NAME                 READY   STATUS    RESTARTS   AGE
myapp-pod-worker-1   0/1     Pending   0          1s

kubectl get pods
NAME                 READY   STATUS    RESTARTS   AGE
myapp-pod-worker-1   1/1     Running   0   
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;pendingμƒνƒμ— μλ‹¤κ°€ runningμΌλ΅ λ°”λ€λ” κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.
λ”°λΌμ„ static podμ„ μ§€μ°κ³ μ‹¶μΌλ©΄ ν•΄λ‹Ή λ…Έλ“λ΅ κ°€μ„ ν•΄λ‹Ή yamlνμΌμ„ μ‚­μ ν•λ” λ°©λ²•λΏμ…λ‹λ‹¤.&lt;/p&gt;</content><author><name>Sanghyuk Jeong</name><email>shjeong920522@gmail.com</email></author><category term="Docker" /><category term="Kubernetes" /><category term="Replicasets" /><category term="Deployment" /><category term="static" /><category term="pod" /><summary type="html">Static podsμ΄λ€ μ μΌ μ²μμ— kubernetesμ κµ¬μ΅°μ—μ„ κ³µλ¶€ν–μ„λ• λ§μ¤ν„°λ…Έλ“μ— kube-apiserverκ°€ μκ³ , κ° μ›μ»¤λ…Έλ“μ—λ” kubelet μ΄ μ΅΄μ¬ν•λ©° λ§μ¤ν„°λ…Έλ“μ kube-apiserverμ λ…λ Ήμ—λ”°λΌ podμ„ μ§€μ°κ±°λ‚ μ‚­μ ν•κ±°λ‚ ν–μ—μ£ . μ΄λ² μ‹κ°„μ—λ” λ§μ¤ν„° λ…Έλ“μ kube-schedulerμ μν–¥μ„ λ°›μ§€ μ•λ” Static pod μ— λ€ν•΄μ„ μ•μ•„λ³΄κ² μµλ‹λ‹¤. κ° μ›μ»¤λ…Έλ“μ— μ΅΄μ¬ν•λ” kubelet λν• podμ΄ μ£½κ±°λ‚ μ—λ¬κ°€ λ°μƒν–μ„λ–„ μ•„λμ λ°©λ²•μΌλ΅ λ‹¤μ‹ μ‚΄λ¦΄ μ μμµλ‹λ‹¤. μ°μ„  static podμ„ μƒμ„±ν•  λ…Έλ“λ¥Ό μ„ νƒν•μ—¬ ssh μ ‘μ†ν•΄μ¤λ‹λ‹¤. μ €λ” worker-1μ— μ ‘μ†ν•λ„λ΅ ν•κ² μµλ‹λ‹¤ $ kubectl get nodes -o wide NAME STATUS ROLES AGE VERSION instance-1 Ready &amp;lt;none&amp;gt; 3d3h v1.21.1 master Ready control-plane,master 3d3h v1.21.1 worker-1 Ready &amp;lt;none&amp;gt; 3d3h v1.21.1 worker-2 Ready &amp;lt;none&amp;gt; 3d3h v1.21.1 #worker μ— μ ‘μ†ν•κΈ° $ ssh -i ~/.ssh/rsa-gcp-worker-1 shjeong920522@10.178.0.5 νΉμ§• 1 kubelet μ€ κΈ°λ³Έμ μΌλ΅ /etc/kubernetes/manifests νμΌμ•μ pod.yaml μ„ λ°”λΌλ³΄λ”λ°, μ΄λ” kubelet.service μ config.yamlνμΌμ•μ— staticPodPathμ— μ •μλμ–΄μμµλ‹λ‹¤. μ§μ ‘ ν™•μΈν•΄λ΄…μ‹λ‹¤ μ°μ„  μ•„λ μ»¤λ§¨λ“λ¥Ό μ…λ ¥ν•μ—¬ config.yamlνμΌμ μ„μΉλ¥Ό μ•μ•„λƒ…λ‹λ‹¤ # λ¨λ“ μ„λΉ„μ¤ ν™•μ¥ | kubelet μ •λ³΄μ¤‘μ—μ„ | --config ν¬ν•¨ν•λ”μ¤„ κ°€μ Έμ¤κΈ° $ ps -ef | grep kubelet | grep &quot;\--config&quot; root 18270 1 1 May28 ? 01:31:14 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --network-plugin=cni --pod-infra-container-image=k8s.gcr.io/pause:3.4.1 ν•΄λ‹Ή νμΌμ„ ν™•μΈν•΄ λ΄…μ‹λ‹¤ $ sudo vi config=/var/lib/kubelet/config.yaml apiVersion: kubelet.config.k8s.io/v1beta1 authentication: anonymous: enabled: false webhook: cacheTTL: 0s enabled: true x509: clientCAFile: /etc/kubernetes/pki/ca.crt authorization: mode: Webhook webhook: cacheAuthorizedTTL: 0s cacheUnauthorizedTTL: 0s cgroupDriver: systemd clusterDNS: - 10.96.0.10 clusterDomain: cluster.local cpuManagerReconcilePeriod: 0s evictionPressureTransitionPeriod: 0s fileCheckFrequency: 0s healthzBindAddress: 127.0.0.1 healthzPort: 10248 httpCheckFrequency: 0s imageMinimumGCAge: 0s kind: KubeletConfiguration logging: {} nodeStatusReportFrequency: 0s nodeStatusUpdateFrequency: 0s resolvConf: /run/systemd/resolve/resolv.conf rotateCertificates: true runtimeRequestTimeout: 0s shutdownGracePeriod: 0s shutdownGracePeriodCriticalPods: 0s staticPodPath: /etc/kubernetes/manifests &amp;lt;------------------------------ staticPodPath κ°€ μ„¤μ •λμ–΄ μλ”κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤. streamingConnectionIdleTimeout: 0s syncFrequency: 0s volumeStatsAggPeriod: 0s μ„μ™€ κ°™μ΄ νμΌμ„ ν†µμΌλ΅ ν™•μΈν•΄λ³΄μ•„λ„ λμ§€λ§ grepλ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•λ©΄ λ”μ± νΈν μ°Ύμ„ μλ„ μμµλ‹λ‹¤. $ sudo grep static /var/lib/kubelet/config.yaml staticPodPath: /etc/kubernetes/manifests νΉμ§• 2 λ§μ•½ ν•΄λ™ ν΄λ”λ‚΄μ— kind: PodμΈ yaml νμΌμ΄μλ‹¤λ©΄ kubeletμ΄ μλ™μΌλ΅ μ΄λ¥Ό μƒμ„±ν•λ©° static podμ μ΄λ¦„μ—λ” μλ™μΌλ΅ ν•΄λ‹Ή λ…Έλ“μ μ΄λ¦„μ΄ suffixλ΅ λ¶™μµλ‹λ‹¤. μ μƒμ„±λλ‚ ν™•μΈν•΄ λ΄…μ‹λ‹¤. $ cd /etc/kubernetes/manifests $ sudo vi static.yaml κ°„λ‹¨ν• podμ„ ν•΄λ‹Ή λ³Όλ”μ— μƒμ„±ν•΄μ¤λ‹λ‹¤. #static.yaml apiVersion: v1 kind: Pod metadata: name: myapp-pod labels: app: myapp type: front-end spec: containers: - name: nginx-container image: nginx λ§μ¤ν„° λ…Έλ“λ΅ μ΄λ™ν•μ—¬ ν™•μΈν•΄λ΄…μ‹λ‹¤. $ kubectl get pods NAME READY STATUS RESTARTS AGE myapp-pod-worker-1 1/1 Running 0 42m static podλ¥Ό μƒμ„±ν• λ…Έλ“μ μ΄λ¦„μΈ worker-1 κ°€ Podμ΄λ¦„μ suffixλ΅ λ¶™μ–΄μλ”κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤. νΉμ§• 3 λ§μ¤ν„°λ…Έλ“μ—μ„ kubectl delete λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•λ”λΌλ„ μ›μ»¤λ…Έλ“μ kubeletμ΄ λ‹¤μ‹ μ‚΄λ ¤λƒ…λ‹λ‹¤. static podλ” ν•΄λ‹Ή μ›μ»¤λ…Έλ“μ kubeletμ΄ κ΄€λ¦¬ν•κΈ° λ–„λ¬Έμ…λ‹λ‹¤. λ”°λΌμ„ ν•΄λ‹Ή podμ imageλ¥Ό λ³€κ²½ν•κ³ μ‹¶λ‹¤λ©΄ manifest ν΄λ”μ•μ ν•΄λ‹Ή yamlνμΌμ μ΄λ―Έμ§€λ¥Ό μμ •ν•΄μ•Όν•κ³ , μ§€μ°λ ¤λ©΄ ν•΄λ‹Ή yamlνμΌμ„ μ‚­μ ν•λ©΄ λ©λ‹λ‹¤. κ·ΈλΌ μ •λ§λ΅ λ‹¤μ‹ μ‹μ‘λλ”μ§€ λ§μ¤ν„°λ…Έλ“μ—μ„ myapp-pod-worker-1μ„ μ‚­μ ν•΄ λ΄…μ‹λ‹¤ $ kubectl delete pod myapp-pod-worker-1 pod &quot;myapp-pod-worker-1&quot; deleted μ§€μ΄λ‹¤μμ— λ°”λ΅ ν™•μΈν•΄λ³΄λ©΄ $ kubectl get pods NAME READY STATUS RESTARTS AGE myapp-pod-worker-1 0/1 Pending 0 1s kubectl get pods NAME READY STATUS RESTARTS AGE myapp-pod-worker-1 1/1 Running 0 pendingμƒνƒμ— μλ‹¤κ°€ runningμΌλ΅ λ°”λ€λ” κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤. λ”°λΌμ„ static podμ„ μ§€μ°κ³ μ‹¶μΌλ©΄ ν•΄λ‹Ή λ…Έλ“λ΅ κ°€μ„ ν•΄λ‹Ή yamlνμΌμ„ μ‚­μ ν•λ” λ°©λ²•λΏμ…λ‹λ‹¤.</summary></entry><entry><title type="html">[ #5 ] pod μ¤μΌ€μ¥΄λ§-2</title><link href="https://shjeong92.github.io/2021/05/31/Learning-Kubernetes-05.html" rel="alternate" type="text/html" title="[ #5 ] pod μ¤μΌ€μ¥΄λ§-2" /><published>2021-05-31T00:00:00+09:00</published><updated>2021-05-31T00:00:00+09:00</updated><id>https://shjeong92.github.io/2021/05/31/Learning-Kubernetes-05</id><content type="html" xml:base="https://shjeong92.github.io/2021/05/31/Learning-Kubernetes-05.html">&lt;h2 id=&quot;nodeselector&quot;&gt;nodeSelector&lt;/h2&gt;
&lt;p&gt;nodeSelector λ” νλ“λ¥Ό νΉμ • λ μ΄λΈ”μ΄ μλ” λ…Έλ“λ΅ μ ν•ν•λ” λ§¤μ° κ°„λ‹¨ν• λ°©λ²•μ„ μ κ³µν•©λ‹λ‹¤.&lt;/p&gt;
&lt;h3 id=&quot;1-λ…Έλ“μ—-λ μ΄λΈ”-λ¶™μ΄κΈ°&quot;&gt;1. λ…Έλ“μ— λ μ΄λΈ” λ¶™μ΄κΈ°&lt;/h3&gt;

&lt;p&gt;λ…Έλ“μ— λ μ΄λΈ”μ„ λ¶™μ—¬μ„ μ¶”ν›„ podμ„ μ›ν•λ” λ…Έλ“μ— ν• λ‹Ήν• λ• μ‚¬μ©ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kubectl label nodes &amp;lt;λ…Έλ“ μ΄λ¦„&amp;gt; &amp;lt;λ μ΄λΈ” ν‚¤&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;λ μ΄λΈ” κ°’&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-podμ„¤μ •μ—-nodeselector-ν•„λ“-μ¶”κ°€ν•κΈ°&quot;&gt;2. podμ„¤μ •μ— nodeSelector ν•„λ“ μ¶”κ°€ν•κΈ°&lt;/h3&gt;
&lt;p&gt;μ‹¤ν–‰ν•κ³ μ ν•λ” νλ“μ μ„¤μ • νμΌμ„ κ°€μ Έμ¤κ³ , μ΄μ²λΌ nodeSelector μ„Ήμ…μ„ μ¶”κ°€ν•©λ‹λ‹¤. μ•„λμ μλ¥Ό λ“¤μ–΄λ³΄λ©΄&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;v1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Pod&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;specμ•„λμ— nodeSelectorμ„ μ¶”κ°€ν•΄μ¤λ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;v1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Pod&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;imagePullPolicy&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;IfNotPresent&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;nodeSelector&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#&amp;lt;λ μ΄λΈ” ν‚¤&amp;gt;: &amp;lt;λ μ΄λΈ” κ°’&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;disktype&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ssd&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;node-affinity&quot;&gt;node affinity&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;nodeSelector&lt;/strong&gt; μ„ μ‚¬μ©ν–μ„λ•λ” λ§¤μΉ­ μ΅°κ±΄μ΄ λ μ΄λΈ”μ— key=value, keyμ™€ valueκ°€ μΌμΉν–μ„λ• podμ„ λ…Έλ“μ— μμ—μµλ‹λ‹¤.&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;nodeAffinity&lt;/strong&gt; λ” operatorλ΅ Equal, In, NotIn, Exists, DoseNotExist λ¥Ό μ‚¬μ©ν•  μ μμ–΄, λ” μ—¬λ¬κ°€μ§€ μ μ•½μ„ μ •μ ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λν• &lt;strong&gt;nodeAffinity&lt;/strong&gt; μ—λ” μ•„λμ™€ κ°™μ΄ λ‘κ°€μ§€ νƒ€μ…μ΄ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;requiredDuringSchedulingIgnoredDuringExecution&lt;/li&gt;
  &lt;li&gt;preferredDuringSchedulingIgnoredDuringExecution&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;μ²«λ²μ§Έ νƒ€μ…μ€ νλ“κ°€ λ…Έλ“μ— μ¤μΌ€μ¤„λλ ¤λ©΄ κ·μΉ™μ„ λ§μ΅±ν•΄μ•Όλ§ ν•λ”κ²ƒμ΄κ³ , μ—†λ‹¤λ©΄ podλ” pending μƒνƒκ°€ λ©λ‹λ‹¤
λ‘λ²μ§Έ νƒ€μ…μ€ μ„ νΈν•λ” μ„ νΈν•λ” λλ‹¤λ¥Έ ν‚¤μ™€ λ²¨λ¥, μ—°μ‚°μλ¥Ό μ¶”κ°€ν•  μ μλ”λ°μ”, μ²«λ²μ§Έ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—¬λ¬κ° μμ„κ²½μ°μ—, λ‘λ²μ§Έ μ΅°κ±΄μ weight(μ„ νΈλ„) μ μμ—λ”°λΌ
podμ΄ μ¤μΌ€μ¥΄λλ” ν•νƒμ…λ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;λ―Έλμ—λ” requiredDuringSchedulingRequiredDuringExecution λΌλ” μƒλ΅μ΄ νƒ€μ…μ΄ λ‚μ¬κ²ƒμ΄λΌκ³  ν•©λ‹λ‹¤, μ•μ„ μ†κ°λ“λ¦° λ‘ νƒ€μ…μ€ μ΄λ―Έ podμ΄ μ¤μΌ€μ¤„ λμ—μ„λ• nodeμ labelμ΄ λ°”λ€κ±°λ‚ μ—†μ–΄μ§€λ©΄μ„
affinityμ μ΅°κ±΄κ³Ό λ§μ§€ μ•λ”λΌλ„ μ΄λ―Έ λ°°μ •λμ—μμΌλ΅ λ¬΄μ‹ν•©λ‹λ‹¤. ν•μ§€λ§ λ―Έλμ— λ‚μ¬ μƒλ΅μ΄ νƒ€μ…μ€ μ΄λ―Έ λ°°μ •λ°›μ€ podμ΄λΌλ„ λ…Έλ“μ labelμ΄ μ‚­μ ,λ³€κ²½λλ©΄ μ΅°κ±΄μ— λ§μ§€ μ•λ” podμ„ μ¤‘μ§€ μ‹ν‚¤λ” νƒ€μ… μ΄λΌκ³ ν•©λ‹λ‹¤.&lt;/p&gt;

&lt;h3 id=&quot;μμ &quot;&gt;μμ &lt;/h3&gt;
&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;v1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Pod&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;with-node-affinity&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;affinity&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;nodeAffinity&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;requiredDuringSchedulingIgnoredDuringExecution&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;nodeSelectorTerms&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;matchExpressions&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;kubernetes.io/e2e-az-name&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;In&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;e2e-az1&lt;/span&gt;
            &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;e2e-az2&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;preferredDuringSchedulingIgnoredDuringExecution&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;preference&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;matchExpressions&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;another-node-label-key&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;In&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;another-node-label-value&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;with-node-affinity&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;k8s.gcr.io/pause:2.0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Node affinityλ” μ—¬λ¬ affinityλ¥Ό λ™μ‹μ— μ μ©ν•  μ μλ”λ°μ” μ €λ” μ•„λμ™€ κ°™μ€ κ²½μ°μ— λ€ν•΄ μ‹¤ν—ν•΄ λ³΄μ•μµλ‹λ‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;requiredDuringSchedulingIgnoredDuringExecution λ§ μ μ©ν–μ„ κ²½μ°&lt;/strong&gt;:
    &lt;ul&gt;
      &lt;li&gt;μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—†μ„κ²½μ° podλ” μ¤μΌ€μ¥΄λμ§€μ•κ³  pendingμƒνƒκ°€ λ©λ‹λ‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;requiredDuringSchedulingIgnoredDuringExecution κ³Ό preferredDuringSchedulingIgnoredDuringExecution λ¥Ό λ™μ‹μ— μ μ©ν• κ²½μ°&lt;/strong&gt;:
    &lt;ul&gt;
      &lt;li&gt;μ²«λ²μ§Έ μ΅°κ±΄μ„ μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—¬λ¬κ° μμ„λ• λ‘λ²μ§Έ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μλ‹¤λ©΄ λ‘λ²μ§Έ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“μ— podκ°€ λ°°μΉλ©λ‹λ‹¤.&lt;/li&gt;
      &lt;li&gt;λ‘λ²μ§Έ μ΅°κ±΄λ§μ„ λ§μ΅±ν•λ” κ²½μ°μ—λ” podλ” μ¤μΌ€μ¥΄λ§λμ§€ μ•κ³  pending μƒνƒκ°€ λ©λ‹λ‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;preferredDuringSchedulingIgnoredDuringExecution λ§ μ μ©ν•  κ²½μ°&lt;/strong&gt;:
    &lt;ul&gt;
      &lt;li&gt;μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μμ„κ²½μ° ν•΄λ‹Ή λ…Έλ“μ— μ¤μΌ€μ¥΄λ§λκ³ , μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—†λ‹¤λ©΄ λλ¤μΌλ΅ μ¤μΌ€μ¥΄ λμ—μµλ‹λ‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;μ„μ μμ μ—μ„λ” λ‘ κ°μ Affinityκ°€ μ •μλμ–΄ μλ”λ°μ” λ§μ•½ λ…Έλ“λ“¤μ¤‘ &lt;strong&gt;requiredDuringSchedulingIgnoredDuringExecution&lt;/strong&gt; μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—†λ‹¤λ©΄ ν•΄λ‹Ή podμ€ pending μƒνƒκ°€
λ κ²ƒμ΄λ©°, ν•΄λ‹Ή μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—¬λ¬κ°μΌ κ²½μ° &lt;strong&gt;preferredDuringSchedulingIgnoredDuringExecution&lt;/strong&gt; μ΅°κ±΄μ΄ λ§λ” λ…Έλ“λ΅ λ°°μ • λ  κ²ƒμ…λ‹λ‹¤. &lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;weight&lt;/code&gt; λ” μ„ νΈλ„μ…λ‹λ‹¤ λ§μ•½ μ—¬λ¬κ°μ &lt;strong&gt;preferredDuringSchedulingIgnoredDuringExecution&lt;/strong&gt; μ„ μ μ©ν•μ€μ„λ•μ—λ” weightμ΄ λ†’μ€ λ…Έλ“μ— μ¤μΌ€μ¥΄λ©λ‹λ‹¤.&lt;/p&gt;</content><author><name>Sanghyuk Jeong</name><email>shjeong920522@gmail.com</email></author><category term="Docker" /><category term="Kubernetes" /><category term="Replicasets" /><category term="Deployment" /><category term="Google" /><category term="cloud" /><summary type="html">nodeSelector nodeSelector λ” νλ“λ¥Ό νΉμ • λ μ΄λΈ”μ΄ μλ” λ…Έλ“λ΅ μ ν•ν•λ” λ§¤μ° κ°„λ‹¨ν• λ°©λ²•μ„ μ κ³µν•©λ‹λ‹¤. 1. λ…Έλ“μ— λ μ΄λΈ” λ¶™μ΄κΈ° λ…Έλ“μ— λ μ΄λΈ”μ„ λ¶™μ—¬μ„ μ¶”ν›„ podμ„ μ›ν•λ” λ…Έλ“μ— ν• λ‹Ήν• λ• μ‚¬μ©ν•  μ μμµλ‹λ‹¤. kubectl label nodes &amp;lt;λ…Έλ“ μ΄λ¦„&amp;gt; &amp;lt;λ μ΄λΈ” ν‚¤&amp;gt;=&amp;lt;λ μ΄λΈ” κ°’&amp;gt; 2. podμ„¤μ •μ— nodeSelector ν•„λ“ μ¶”κ°€ν•κΈ° μ‹¤ν–‰ν•κ³ μ ν•λ” νλ“μ μ„¤μ • νμΌμ„ κ°€μ Έμ¤κ³ , μ΄μ²λΌ nodeSelector μ„Ήμ…μ„ μ¶”κ°€ν•©λ‹λ‹¤. μ•„λμ μλ¥Ό λ“¤μ–΄λ³΄λ©΄ apiVersion: v1 kind: Pod metadata: name: nginx labels: env: test spec: containers: - name: nginx image: nginx specμ•„λμ— nodeSelectorμ„ μ¶”κ°€ν•΄μ¤λ‹λ‹¤. apiVersion: v1 kind: Pod metadata: name: nginx labels: env: test spec: containers: - name: nginx image: nginx imagePullPolicy: IfNotPresent nodeSelector: #&amp;lt;λ μ΄λΈ” ν‚¤&amp;gt;: &amp;lt;λ μ΄λΈ” κ°’&amp;gt; disktype: ssd node affinity nodeSelector μ„ μ‚¬μ©ν–μ„λ•λ” λ§¤μΉ­ μ΅°κ±΄μ΄ λ μ΄λΈ”μ— key=value, keyμ™€ valueκ°€ μΌμΉν–μ„λ• podμ„ λ…Έλ“μ— μμ—μµλ‹λ‹¤. nodeAffinity λ” operatorλ΅ Equal, In, NotIn, Exists, DoseNotExist λ¥Ό μ‚¬μ©ν•  μ μμ–΄, λ” μ—¬λ¬κ°€μ§€ μ μ•½μ„ μ •μ ν•  μ μμµλ‹λ‹¤. λν• nodeAffinity μ—λ” μ•„λμ™€ κ°™μ΄ λ‘κ°€μ§€ νƒ€μ…μ΄ μμµλ‹λ‹¤. requiredDuringSchedulingIgnoredDuringExecution preferredDuringSchedulingIgnoredDuringExecution μ²«λ²μ§Έ νƒ€μ…μ€ νλ“κ°€ λ…Έλ“μ— μ¤μΌ€μ¤„λλ ¤λ©΄ κ·μΉ™μ„ λ§μ΅±ν•΄μ•Όλ§ ν•λ”κ²ƒμ΄κ³ , μ—†λ‹¤λ©΄ podλ” pending μƒνƒκ°€ λ©λ‹λ‹¤ λ‘λ²μ§Έ νƒ€μ…μ€ μ„ νΈν•λ” μ„ νΈν•λ” λλ‹¤λ¥Έ ν‚¤μ™€ λ²¨λ¥, μ—°μ‚°μλ¥Ό μ¶”κ°€ν•  μ μλ”λ°μ”, μ²«λ²μ§Έ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—¬λ¬κ° μμ„κ²½μ°μ—, λ‘λ²μ§Έ μ΅°κ±΄μ weight(μ„ νΈλ„) μ μμ—λ”°λΌ podμ΄ μ¤μΌ€μ¥΄λλ” ν•νƒμ…λ‹λ‹¤. λ―Έλμ—λ” requiredDuringSchedulingRequiredDuringExecution λΌλ” μƒλ΅μ΄ νƒ€μ…μ΄ λ‚μ¬κ²ƒμ΄λΌκ³  ν•©λ‹λ‹¤, μ•μ„ μ†κ°λ“λ¦° λ‘ νƒ€μ…μ€ μ΄λ―Έ podμ΄ μ¤μΌ€μ¤„ λμ—μ„λ• nodeμ labelμ΄ λ°”λ€κ±°λ‚ μ—†μ–΄μ§€λ©΄μ„ affinityμ μ΅°κ±΄κ³Ό λ§μ§€ μ•λ”λΌλ„ μ΄λ―Έ λ°°μ •λμ—μμΌλ΅ λ¬΄μ‹ν•©λ‹λ‹¤. ν•μ§€λ§ λ―Έλμ— λ‚μ¬ μƒλ΅μ΄ νƒ€μ…μ€ μ΄λ―Έ λ°°μ •λ°›μ€ podμ΄λΌλ„ λ…Έλ“μ labelμ΄ μ‚­μ ,λ³€κ²½λλ©΄ μ΅°κ±΄μ— λ§μ§€ μ•λ” podμ„ μ¤‘μ§€ μ‹ν‚¤λ” νƒ€μ… μ΄λΌκ³ ν•©λ‹λ‹¤. μμ  apiVersion: v1 kind: Pod metadata: name: with-node-affinity spec: affinity: nodeAffinity: requiredDuringSchedulingIgnoredDuringExecution: nodeSelectorTerms: - matchExpressions: - key: kubernetes.io/e2e-az-name operator: In values: - e2e-az1 - e2e-az2 preferredDuringSchedulingIgnoredDuringExecution: - weight: 1 preference: matchExpressions: - key: another-node-label-key operator: In values: - another-node-label-value containers: - name: with-node-affinity image: k8s.gcr.io/pause:2.0 Node affinityλ” μ—¬λ¬ affinityλ¥Ό λ™μ‹μ— μ μ©ν•  μ μλ”λ°μ” μ €λ” μ•„λμ™€ κ°™μ€ κ²½μ°μ— λ€ν•΄ μ‹¤ν—ν•΄ λ³΄μ•μµλ‹λ‹¤. requiredDuringSchedulingIgnoredDuringExecution λ§ μ μ©ν–μ„ κ²½μ°: μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—†μ„κ²½μ° podλ” μ¤μΌ€μ¥΄λμ§€μ•κ³  pendingμƒνƒκ°€ λ©λ‹λ‹¤. requiredDuringSchedulingIgnoredDuringExecution κ³Ό preferredDuringSchedulingIgnoredDuringExecution λ¥Ό λ™μ‹μ— μ μ©ν• κ²½μ°: μ²«λ²μ§Έ μ΅°κ±΄μ„ μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—¬λ¬κ° μμ„λ• λ‘λ²μ§Έ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μλ‹¤λ©΄ λ‘λ²μ§Έ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“μ— podκ°€ λ°°μΉλ©λ‹λ‹¤. λ‘λ²μ§Έ μ΅°κ±΄λ§μ„ λ§μ΅±ν•λ” κ²½μ°μ—λ” podλ” μ¤μΌ€μ¥΄λ§λμ§€ μ•κ³  pending μƒνƒκ°€ λ©λ‹λ‹¤. preferredDuringSchedulingIgnoredDuringExecution λ§ μ μ©ν•  κ²½μ°: μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μμ„κ²½μ° ν•΄λ‹Ή λ…Έλ“μ— μ¤μΌ€μ¥΄λ§λκ³ , μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—†λ‹¤λ©΄ λλ¤μΌλ΅ μ¤μΌ€μ¥΄ λμ—μµλ‹λ‹¤. μ„μ μμ μ—μ„λ” λ‘ κ°μ Affinityκ°€ μ •μλμ–΄ μλ”λ°μ” λ§μ•½ λ…Έλ“λ“¤μ¤‘ requiredDuringSchedulingIgnoredDuringExecution μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—†λ‹¤λ©΄ ν•΄λ‹Ή podμ€ pending μƒνƒκ°€ λ κ²ƒμ΄λ©°, ν•΄λ‹Ή μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ…Έλ“κ°€ μ—¬λ¬κ°μΌ κ²½μ° preferredDuringSchedulingIgnoredDuringExecution μ΅°κ±΄μ΄ λ§λ” λ…Έλ“λ΅ λ°°μ • λ  κ²ƒμ…λ‹λ‹¤. weight λ” μ„ νΈλ„μ…λ‹λ‹¤ λ§μ•½ μ—¬λ¬κ°μ preferredDuringSchedulingIgnoredDuringExecution μ„ μ μ©ν•μ€μ„λ•μ—λ” weightμ΄ λ†’μ€ λ…Έλ“μ— μ¤μΌ€μ¥΄λ©λ‹λ‹¤.</summary></entry><entry><title type="html">[ #4 ] pod μ¤μΌ€μ¥΄λ§-1</title><link href="https://shjeong92.github.io/2021/05/30/Learning-Kubernetes-04.html" rel="alternate" type="text/html" title="[ #4 ] pod μ¤μΌ€μ¥΄λ§-1" /><published>2021-05-30T00:00:00+09:00</published><updated>2021-05-30T00:00:00+09:00</updated><id>https://shjeong92.github.io/2021/05/30/Learning-Kubernetes-04</id><content type="html" xml:base="https://shjeong92.github.io/2021/05/30/Learning-Kubernetes-04.html">&lt;h2 id=&quot;taint--toleration&quot;&gt;Taint &amp;amp; Toleration&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;taint: λ…Έλ“λ§λ‹¤ μ„¤μ •κ°€λ¥&lt;/li&gt;
  &lt;li&gt;toleration: taintλ¥Ό λ¬΄μ‹ν•  μ μμ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;μ£Όλ΅ λ…Έλ“λ¥Ό μ§€μ •λ μ—­ν• λ§ ν•κ²ν• λ• μ‚¬μ©ν•©λ‹λ‹¤.
μλ¥Όλ“¤μ–΄ gpuμ‡λ” λ…Έλ“μ—λ” λ‹¤λ¥Έ podλ“¤μ€ μ¬λΌκ°€μ§€μ•κ³  gpuμ“°λ” podλ“¤λ§ μ¬λΌκ°€κ² ν•λ”λ“±μ μƒν™©μ— μ‚¬μ©ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
taintμ—λ” μ‚¬μ©ν•  μ μλ” 3κ°€μ§€ μµμ…μ΄ μμµλ‹λ‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;NoSchedule : tolerationμ΄ μ—†μΌλ©΄ podμ΄ μ¤μΌ€μ¥΄λμ§€ μ•μ, κΈ°μ΅΄ μ‹¤ν–‰λλ podμ—λ” μ μ© μ•λ¨&lt;/li&gt;
  &lt;li&gt;PreferNoSchedule : tolerationμ΄ μ—†μΌλ©΄ podμ„ μ¤μΌ€μ¤„λ§μ•ν•λ ¤κ³  ν•μ§€λ§ ν•„μλ” μ•„λ‹, ν΄λ¬μ¤ν„°λ‚΄μ— μμ›μ΄ λ¶€μ΅±ν•κ±°λ‚ ν•λ©΄ taintκ°€ κ±Έλ ¤μλ” λ…Έλ“μ—μ„λ„ podμ΄ μ¤μΌ€μ¤„λ§λ  μ μμ&lt;/li&gt;
  &lt;li&gt;NoExecute : tolerationμ΄ μ—†μΌλ©΄ podμ΄ μ¤μΌ€μ¤„λμ§€ μ•μΌλ©° κΈ°μ΅΄μ— μ‹¤ν–‰λλ podλ„ tolerationμ΄ μ—†μΌλ©΄ μΆ…λ£μ‹ν‚΄.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;taint ν•μ‹μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl taint node &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;nodename&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;key&lt;span class=&quot;o&quot;&gt;}={&lt;/span&gt;value&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;:&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;option&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ν•λ‚μ λ…Έλ“μ— taint μ μ©ν•κΈ°&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl taint node worker-1 &lt;span class=&quot;nv&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;value:NoSchedule
node/worker-1 tainted
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;describeλ΅ μ μ μ© λμ—λ”μ§€ ν™•μΈν•΄ λ΄…μ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl describe node worker-1 | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; taint
Taints:             &lt;span class=&quot;nv&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;value:NoSchedule
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;μ μ μ©μ΄ λμ—κµ°μ”.&lt;/p&gt;

&lt;p&gt;taintμ μµμ…μ΄ &lt;code&gt;NoSchedule&lt;/code&gt; μ΄λ―€λ΅ podμ— toleration ν•„λ“μ— κ°™μ€ key, valueκ°€ μ—†λ‹¤λ©΄ μƒμ„±λμ§€ μ•κ² μ£ ?
ν™•μΈν•΄λ΄…μ‹λ‹¤.&lt;/p&gt;

&lt;h3 id=&quot;rocketν…μ¤νΈν•΄λ³΄κΈ°&quot;&gt;:rocket:ν…μ¤νΈν•΄λ³΄κΈ°&lt;/h3&gt;
&lt;p&gt;Deploymentλ΅ podμ„ λ„μ–΄λ³΄κ² μµλ‹λ‹¤.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ν™κ²½&lt;/strong&gt;:&lt;br /&gt;
μ‹¤μµμ— μ‚¬μ©ν• ν΄λ¬μ¤ν„°λ” λ§μ¤ν„°λ…Έλ“1κ° μ›μ»¤λ…Έλ“3κ°λ΅ κµ¬μ„±λμ—μΌλ©°,
&lt;br /&gt;
μ΄λ¦„μ€ λ‹¤μκ³Ό κ°™κ³ , μ›μ»¤λ…Έλ“λ“¤μ cpuμ™€ ramμ¤ν©μ€ λ¨λ‘ κ°™κ² μ„¤μ •ν•μ€μµλ‹λ‹¤. &lt;br /&gt;
taintλ” worker-1 λ…Έλ“μ— μ„¤μ •ν•μ€μµλ‹λ‹¤.
master&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;worker-1&lt;/li&gt;
  &lt;li&gt;worker-2&lt;/li&gt;
  &lt;li&gt;instance-1&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;μ°μ„  podμ„ μ„Έκ° μƒμ„±ν•λ” test-taint.yamlμ΄λΌλ” deploymentλ¥Ό λ§λ“¤μ–΄μ¤λ‹λ‹¤&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl create deployment test-taint &lt;span class=&quot;nt&quot;&gt;--image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;nginx &lt;span class=&quot;nt&quot;&gt;--replicas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3 &lt;span class=&quot;nt&quot;&gt;--dry-run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;client &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; yaml &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; test-taint.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;yamlνμΌμ„ μ—΄μ–΄λ³΄λ©΄ μ΄λ ‡μµλ‹λ‹¤.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Deployment&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;creationTimestamp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;null&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test-taint&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test-taint&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;replicas&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;selector&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;matchLabels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test-taint&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;strategy&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;{}&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;creationTimestamp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test-taint&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;resources&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;{}&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;{}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;λ§λ“¤μ–΄μ§„ yamlνμΌμ„ apply ν•΄λ΄…μ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl apply &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; test-taint.yaml
deployment.apps/test-taint created
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;podμ„ ν™•μΈν•΄λ³΄λ©΄ taintλ¥Ό μ„¤μ •ν• nodeμ—λ” podμ΄ λ°°μ •λμ§€ μ•μ€κ²ƒμ„ ν™•μΈ ν•  μ μμµλ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl get pods &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; wide
NAME                          READY   STATUS    RESTARTS   AGE    IP           NODE         NOMINATED NODE   READINESS GATES
test-taint-6bd4977499-2thmv   1/1     Running   0          106s   10.244.3.7   instance-1   &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
test-taint-6bd4977499-4sccs   1/1     Running   0          106s   10.244.1.6   worker-2     &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
test-taint-6bd4977499-h4rt8   1/1     Running   0          106s   10.244.3.8   instance-1   &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μ΄μ  μ΄ deploymentλ¥Ό μ‚­μ ν•κ³  tolerationμ„ μ μ©μ‹ν‚¨ν›„ λ‹¤μ‹ deploymentλ¥Ό apply ν•΄λ³΄κ² μµλ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl delete deployment test-taint
deployment.apps &lt;span class=&quot;s2&quot;&gt;&quot;test-taint&quot;&lt;/span&gt; deleted

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vim test-taint.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;spec.template.spec λ°‘μ— tolerationμµμ…μ„ μ¶”κ°€ν•΄μ¤λ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;apps/v1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Deployment&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;creationTimestamp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;null&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test-taint&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test-taint&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;replicas&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;selector&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;matchLabels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test-taint&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;strategy&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;{}&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;creationTimestamp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;null&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test-taint&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;tolerations&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;key&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Equal&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;value&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;effect&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;NoSchedule&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;resources&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;{}&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;{}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;μμ •λ yamlνμΌ λ‹¤μ‹ λ°°ν¬ν•κΈ°:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;kubectl apply &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; test-taint.yaml
deployment.apps/test-taint created
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;pod λ¦¬μ¤νΈλ¥Ό λ‹¤μ‹ ν™•μΈν•΄λ³΄λ©΄ κ° 1κ°μλ…Έλ“μ— 1κ°μ podμ΄ μƒμ„±λκ±Έ ν™•μΈν•  μ μμµλ‹λ‹¤.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ kubectl get pods -o wide
NAME                          READY   STATUS    RESTARTS   AGE   IP           NODE         NOMINATED NODE   READINESS GATES
test-taint-77b85b88c6-8hq5l   1/1     Running   0          43s   10.244.3.9   instance-1   &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
test-taint-77b85b88c6-957bv   1/1     Running   0          43s   10.244.1.7   worker-2     &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
test-taint-77b85b88c6-f6xn2   1/1     Running   0          43s   10.244.2.8   worker-1     &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>Sanghyuk Jeong</name><email>shjeong920522@gmail.com</email></author><category term="Docker" /><category term="Kubernetes" /><category term="Replicasets" /><category term="Deployment" /><category term="Google" /><category term="cloud" /><summary type="html">Taint &amp;amp; Toleration taint: λ…Έλ“λ§λ‹¤ μ„¤μ •κ°€λ¥ toleration: taintλ¥Ό λ¬΄μ‹ν•  μ μμ μ£Όλ΅ λ…Έλ“λ¥Ό μ§€μ •λ μ—­ν• λ§ ν•κ²ν• λ• μ‚¬μ©ν•©λ‹λ‹¤. μλ¥Όλ“¤μ–΄ gpuμ‡λ” λ…Έλ“μ—λ” λ‹¤λ¥Έ podλ“¤μ€ μ¬λΌκ°€μ§€μ•κ³  gpuμ“°λ” podλ“¤λ§ μ¬λΌκ°€κ² ν•λ”λ“±μ μƒν™©μ— μ‚¬μ©ν•  μ μμµλ‹λ‹¤. taintμ—λ” μ‚¬μ©ν•  μ μλ” 3κ°€μ§€ μµμ…μ΄ μμµλ‹λ‹¤. NoSchedule : tolerationμ΄ μ—†μΌλ©΄ podμ΄ μ¤μΌ€μ¥΄λμ§€ μ•μ, κΈ°μ΅΄ μ‹¤ν–‰λλ podμ—λ” μ μ© μ•λ¨ PreferNoSchedule : tolerationμ΄ μ—†μΌλ©΄ podμ„ μ¤μΌ€μ¤„λ§μ•ν•λ ¤κ³  ν•μ§€λ§ ν•„μλ” μ•„λ‹, ν΄λ¬μ¤ν„°λ‚΄μ— μμ›μ΄ λ¶€μ΅±ν•κ±°λ‚ ν•λ©΄ taintκ°€ κ±Έλ ¤μλ” λ…Έλ“μ—μ„λ„ podμ΄ μ¤μΌ€μ¤„λ§λ  μ μμ NoExecute : tolerationμ΄ μ—†μΌλ©΄ podμ΄ μ¤μΌ€μ¤„λμ§€ μ•μΌλ©° κΈ°μ΅΄μ— μ‹¤ν–‰λλ podλ„ tolerationμ΄ μ—†μΌλ©΄ μΆ…λ£μ‹ν‚΄. taint ν•μ‹μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤. $ kubectl taint node {nodename} {key}={value}:{option} ν•λ‚μ λ…Έλ“μ— taint μ μ©ν•κΈ° $ kubectl taint node worker-1 key=value:NoSchedule node/worker-1 tainted describeλ΅ μ μ μ© λμ—λ”μ§€ ν™•μΈν•΄ λ΄…μ‹λ‹¤. $ kubectl describe node worker-1 | grep -i taint Taints: key=value:NoSchedule μ μ μ©μ΄ λμ—κµ°μ”. taintμ μµμ…μ΄ NoSchedule μ΄λ―€λ΅ podμ— toleration ν•„λ“μ— κ°™μ€ key, valueκ°€ μ—†λ‹¤λ©΄ μƒμ„±λμ§€ μ•κ² μ£ ? ν™•μΈν•΄λ΄…μ‹λ‹¤. :rocket:ν…μ¤νΈν•΄λ³΄κΈ° Deploymentλ΅ podμ„ λ„μ–΄λ³΄κ² μµλ‹λ‹¤. ν™κ²½: μ‹¤μµμ— μ‚¬μ©ν• ν΄λ¬μ¤ν„°λ” λ§μ¤ν„°λ…Έλ“1κ° μ›μ»¤λ…Έλ“3κ°λ΅ κµ¬μ„±λμ—μΌλ©°, μ΄λ¦„μ€ λ‹¤μκ³Ό κ°™κ³ , μ›μ»¤λ…Έλ“λ“¤μ cpuμ™€ ramμ¤ν©μ€ λ¨λ‘ κ°™κ² μ„¤μ •ν•μ€μµλ‹λ‹¤. taintλ” worker-1 λ…Έλ“μ— μ„¤μ •ν•μ€μµλ‹λ‹¤. master worker-1 worker-2 instance-1 μ°μ„  podμ„ μ„Έκ° μƒμ„±ν•λ” test-taint.yamlμ΄λΌλ” deploymentλ¥Ό λ§λ“¤μ–΄μ¤λ‹λ‹¤ $ kubectl create deployment test-taint --image=nginx --replicas=3 --dry-run=client -o yaml &amp;gt; test-taint.yaml yamlνμΌμ„ μ—΄μ–΄λ³΄λ©΄ μ΄λ ‡μµλ‹λ‹¤. kind: Deployment metadata: creationTimestamp: null labels: app: test-taint name: test-taint spec: replicas: 3 selector: matchLabels: app: test-taint strategy: {} template: metadata: creationTimestamp: null labels: app: test-taint spec: containers: - image: nginx name: nginx resources: {} status: {} λ§λ“¤μ–΄μ§„ yamlνμΌμ„ apply ν•΄λ΄…μ‹λ‹¤. $ kubectl apply -f test-taint.yaml deployment.apps/test-taint created podμ„ ν™•μΈν•΄λ³΄λ©΄ taintλ¥Ό μ„¤μ •ν• nodeμ—λ” podμ΄ λ°°μ •λμ§€ μ•μ€κ²ƒμ„ ν™•μΈ ν•  μ μμµλ‹λ‹¤. $ kubectl get pods -o wide NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES test-taint-6bd4977499-2thmv 1/1 Running 0 106s 10.244.3.7 instance-1 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt; test-taint-6bd4977499-4sccs 1/1 Running 0 106s 10.244.1.6 worker-2 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt; test-taint-6bd4977499-h4rt8 1/1 Running 0 106s 10.244.3.8 instance-1 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt; μ΄μ  μ΄ deploymentλ¥Ό μ‚­μ ν•κ³  tolerationμ„ μ μ©μ‹ν‚¨ν›„ λ‹¤μ‹ deploymentλ¥Ό apply ν•΄λ³΄κ² μµλ‹λ‹¤. $ kubectl delete deployment test-taint deployment.apps &quot;test-taint&quot; deleted $ vim test-taint.yaml spec.template.spec λ°‘μ— tolerationμµμ…μ„ μ¶”κ°€ν•΄μ¤λ‹λ‹¤. apiVersion: apps/v1 kind: Deployment metadata: creationTimestamp: null labels: app: test-taint name: test-taint spec: replicas: 3 selector: matchLabels: app: test-taint strategy: {} template: metadata: creationTimestamp: null labels: app: test-taint spec: tolerations: - key: key operator: Equal value: value effect: NoSchedule containers: - image: nginx name: nginx resources: {} status: {} μμ •λ yamlνμΌ λ‹¤μ‹ λ°°ν¬ν•κΈ°: $ kubectl apply -f test-taint.yaml deployment.apps/test-taint created pod λ¦¬μ¤νΈλ¥Ό λ‹¤μ‹ ν™•μΈν•΄λ³΄λ©΄ κ° 1κ°μλ…Έλ“μ— 1κ°μ podμ΄ μƒμ„±λκ±Έ ν™•μΈν•  μ μμµλ‹λ‹¤. $ kubectl get pods -o wide NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES test-taint-77b85b88c6-8hq5l 1/1 Running 0 43s 10.244.3.9 instance-1 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt; test-taint-77b85b88c6-957bv 1/1 Running 0 43s 10.244.1.7 worker-2 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt; test-taint-77b85b88c6-f6xn2 1/1 Running 0 43s 10.244.2.8 worker-1 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;</summary></entry></feed>